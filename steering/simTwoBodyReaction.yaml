---
Anchor:

 - &input /data/si26a/user/okawa/output/single/si26/high_si26.root
 - &output output/sim/test.root
 - &histout output/sim/test.hist.root

 - &loopnum 1000000
 - &beam_name beam
 - &track_name track
 - &beam_A 26
 - &beam_Z 14
 - &beam_E 55.5 # MeV (just before target)
 - &beam_Esigma 3.3 # MeV

Processor:
  - name: timer
    type: art::TTimerProcessor

# =====================================
# using random number
#  - name: random_eventstore
#    type: art::TRandomNumberEventStore
#    parameter:
#      OutputTransparency: 1
#      MaxLoop: *loopnum
#
#  - name: beam_generator
#    type: art::TRandomBeamGenerator
#    parameter:
#      OutputCollection: *beam_name
#      OutputTrackCollection: *track_name
#      # beam particle information
#      MassNum: *beam_A
#      AtomicNum: *beam_Z
#      ChargeNum: *beam_Z
#      IniEnergy: *beam_E
#      # beam tracking information
#      Xsigma: 1.0 # mm
#      Ysigma: 1.0 # mm
#      Asigma: 1.0 # deg
#      Bsigma: 1.0 # deg
#      Esigma: *beam_Esigma

#=====================================
# using TTree events
  - name: periodic_tree
    type: art::TTreePeriodicEventStore
    parameter:
      OutputTransparency: 1
      FileName: *input
      TreeName: tree
      MaxEventNum: *loopnum

  - name: proc_copy_processor
    type: art::TBranchCopyProcessor
    parameter:
      InputCollection: f3ppac # need to inherit from TTrack
      OutputCollection: *track_name

  - name: beam_generator
    type: art::TTreeBeamGenerator
    parameter:
      InputCollection: *track_name
      OutputCollection: *beam_name
      # beam particle information
      MassNum: *beam_A
      AtomicNum: *beam_Z
      ChargeNum: *beam_Z
      IniEnergy: *beam_E
      Esigma: *beam_Esigma

#=====================================
  - name: reaction_proc
    type: art::TNBodyReactionProcessor
    parameter:
      InputCollection: *beam_name
      OutputCollection: products # size is DecayParticleNum
      OutputReactionCollection: reaction
      # beam information (for initialize TSrim)
      BeamNucleus: [*beam_Z, *beam_A] # (Z, A)
      BeamEnergy: *beam_E
      # target information
      TargetIsGas: true # false: solid, true: gas target
      TargetName: he # from TSrim energy loss
      TargetMassNum: 4 # hit ion
      TargetAtomicNum: 2 # hit ion
      TargetThickness: 1000 # mm (for gas target, allow up to this value)
      TargetPressure: 250 # Torr (used for gas target)
      # reaction particles information
      DecayParticleNum: 2
      ReactionMassNum: [29, 1] # will be [id=0, id=1]
      ReactionAtomicNum: [15, 1]
      ExciteLevel: [0.0, 0.0] # MeV
      # cross section file, if not, it use constant cross section for energy
      # require: "energy cross-section" format, deliminator should be a space ' '
      CrossSectionPath: model/ap.L00
      CrossSectionType: 0 # 0: LAB, kinematics is different, 1: LAB, kinematics is same, 2: CM

#  - name: detector_initialize
#    type: art::TUserGeoInitializer
#    parameter:
#      Name: prm_detectors
#      FileName: prm/geo/si26a.yaml
#      OutputTransparency: 1
#
#  - name: detector_proc
#    type: art::TDetectParticleProcessor
#    parameter:
#      ReactionParticleName: [26Si14, p]
#      TargetisGas: 0 # 1->Gas
#      TargetName: # gas target case
#      DetectorParameter: prm_detectors
#      InputCollection: products
#      OutputCollection: telescope

  - name: progress
    type: art::TEvtNumProcessor
    parameter:
      OutputTransparency: 0
      PrintEvent: 1
      PrintEventNum: 10000

  - name: outputtree
    type: art::TOutputTreeProcessor
    parameter:
      FileName:
        - *output
