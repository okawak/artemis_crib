<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.122.0">
    <meta name="generator" content="Relearn 5.22.0">
    <meta name="robots" content="noindex, nofollow, noarchive, noimageindex">
    <meta name="description" content="Documentation for CRIB artemis">
    <meta name="author" content="map[name:Kodai Okawa]">
    <title></title><link rel="icon" href="/artemis_crib/images/crib_overlay.png" type="image/png">

    <!-- https://github.com/filamentgroup/loadCSS/blob/master/README.md#how-to-use -->
    <link href="/artemis_crib/css/fontawesome-all.min.css?1707539174" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/artemis_crib/css/fontawesome-all.min.css?1707539174" rel="stylesheet"></noscript>
    <link href="/artemis_crib/css/nucleus.css?1707539174" rel="stylesheet">
    <link href="/artemis_crib/css/auto-complete.css?1707539174" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/artemis_crib/css/auto-complete.css?1707539174" rel="stylesheet"></noscript>
    <link href="/artemis_crib/css/perfect-scrollbar.min.css?1707539174" rel="stylesheet">
    <link href="/artemis_crib/css/fonts.css?1707539174" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/artemis_crib/css/fonts.css?1707539174" rel="stylesheet"></noscript>
    <link href="/artemis_crib/css/theme.css?1707539174" rel="stylesheet">
    <link href="/artemis_crib/css/theme-CRIB-theme.css?1707539174" rel="stylesheet" id="R-variant-style">
    <link href="/artemis_crib/css/variant.css?1707539174" rel="stylesheet">
    <link href="/artemis_crib/css/print.css?1707539174" rel="stylesheet" media="print">
    <link href="/artemis_crib/css/format-print.css?1707539174" rel="stylesheet">
    <link href="/artemis_crib/css/ie.css?1707539174" rel="stylesheet">
    <script src="/artemis_crib/js/url.js?1707539174"></script>
    <script src="/artemis_crib/js/variant.js?1707539174"></script>
    <script>
      // hack to let hugo tell us how to get to the root when using relativeURLs, it needs to be called *url= for it to do its magic:
      // https://github.com/gohugoio/hugo/blob/145b3fcce35fbac25c7033c91c1b7ae6d1179da8/transform/urlreplacers/absurlreplacer.go#L72
      window.index_js_url="/artemis_crib/index.search.js";
      var root_url="/";
      var baseUri=root_url.replace(/\/$/, '');
      // translations
      window.T_Copy_to_clipboard = 'Copy to clipboard';
      window.T_Copied_to_clipboard = 'Copied to clipboard!';
      window.T_Copy_link_to_clipboard = 'Copy link to clipboard';
      window.T_Link_copied_to_clipboard = 'Copied link to clipboard!';
      window.T_Reset_view = 'Reset view';
      window.T_No_results_found = 'No results found for \u0022{0}\u0022';
      window.T_N_results_found = '{1} results found for \u0022{0}\u0022';
      // some further base stuff
      var baseUriFull='https:\/\/okawak.github.io\/artemis_crib/';
      window.variants && variants.init( [ 'CRIB-theme', 'relearn-auto', 'relearn-dark', 'zen-dark', 'learn' ] );
    </script>

  
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-MZF67K577Y"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'G-MZF67K577Y');
  </script>
  


  </head>
  <body class="mobile-support print" data-url="/artemis_crib/index.html">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide">
              <button class="topbar-control" onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)">
                <i class="fa-fw fas fa-bars"></i>
              </button>
            </div>
          </div>
          <ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype="http://schema.org/BreadcrumbList">
          </ol>
          <div class="topbar-area topbar-area-end" data-area="end">
          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable home" tabindex="-1">
        <div class="flex-block-wrapper">
          <section>
            <h1 class="a11y-only">Subsections of </h1>
          <article class="chapter">
            <header class="headline">
            </header>
<div class="article-subheading">Chapter 1</div>
<h1 id="installation">Installation</h1>

<p>This chapter describes how to set up the artemis environment for the CRIB experiment.</p>

<ul class="children children-li children-sort-">
	
<li><a href="/artemis_crib/installation/requirements/index.html">Requirements</a></li>
<li><a href="/artemis_crib/installation/cmake/index.html">cmake</a></li>
<li><a href="/artemis_crib/installation/root/index.html">ROOT</a></li>
<li><a href="/artemis_crib/installation/yaml-cpp/index.html">yaml-cpp</a></li>
<li><a href="/artemis_crib/installation/artemis/index.html">artemis</a></li>
<li><a href="/artemis_crib/installation/mount/index.html">mount setting</a></li>
<li><a href="/artemis_crib/installation/energyloss_calculator/index.html">energyloss calculator</a></li>
<li><a href="/artemis_crib/installation/art_analysis/index.html">art_analysis</a></li>
</ul>

            <footer class="footline">

            </footer>
          </article>

          <section>
            <h1 class="a11y-only">Subsections of Installation</h1>
          <article class="default">
            <header class="headline">
            </header>
<h1 id="requirements">Requirements</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-11-02 by Kodai Okawa</span></span>
<p>The following machines have been tested for operation.</p>
<h3 id="1-writers-okawas-machine">1. Writer&rsquo;s (Okawa&rsquo;s) machine</h3>
<ul>
<li>Almalinux 9.2</li>
<li>zsh 5.8</li>
<li>gcc 11.3.1</li>
<li>cmake 3.20.2</li>
<li>ROOT 6.28/04</li>
<li>yaml-cpp 0.7.0</li>
</ul>
<h3 id="2-cribs-analysis-machine">2. CRIB&rsquo;s analysis machine</h3>
<ul>
<li>CentOS Linux release 7.9.2009 (Core)</li>
<li>zsh 5.5.1</li>
<li>gcc 9.3.1 (using devtoolset-9)</li>
<li>cmake 3.28 (install manually)</li>
<li>ROOT 6.28/06</li>
<li>yaml-cpp 0.8.0</li>
</ul>
<hr>
<p>NOTE:</p>
<ul>
<li>From 2023/10, Ubuntu system is also avaliable. (<a href="https://github.com/artemis-dev/artemis/pull/48" target="_blank">issue48</a>)</li>
<li>Scripts for some automate operation are written in <code>zsh</code> format.</li>
<li>Installation seems to be difficult on <code>macOS</code> (because of <code>clang</code> not <code>gcc</code>) in the current version.</li>
</ul>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="cmake">cmake</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-11-02 by Kodai Okawa</span></span>
<p>Generally, <code>dnf install cmake</code> or <code>brew install cmake</code> support latest version of the cmake, but for some older machine like CentOS7, it is too old to install ROOT.</p>
<p>The latest ROOT require CMake 3.16 or higher, and if your system doesn&rsquo;t support this version, you need to install manually.</p>
<p>You can get more information from <a href="https://github.com/Kitware/Cmake" target="_blank">here</a>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">cd</span> hoge
</span></span><span class="line"><span class="cl">git clone https://github.com/Kitware/Cmake.git
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> Cmake
</span></span><span class="line"><span class="cl">./bootstrap
</span></span><span class="line"><span class="cl">make -j8
</span></span><span class="line"><span class="cl">sudo make install</span></span></code></pre></div><p>If you want to set the version, you can change the branch (tag).
The default branch is <code>master</code>.</p>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="root">ROOT</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-11-02 by Kodai Okawa</span></span>
<p>Artemis uses <a href="https://root.cern/" target="_blank">ROOT library</a>.</p>
<p>We confirmed that version 6.28 of the ROOT will work well, but if the ROOT updates, we are not sure that the ARTEMIS will work well,
so we recommend to build from the sources.</p>
<p>For detailded information, please refer <a href="https://root.cern/install/" target="_blank">Installing ROOT</a>
Recommendations are described below.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># The latest stable branch gets updated automatically on each release.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># You may update your local copy by issuing a `git pull` command from within `root_src/`.</span>
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> hoge
</span></span><span class="line"><span class="cl">git clone --branch latest-stable --depth<span class="o">=</span><span class="m">1</span> https://github.com/root-project/root.git root_src
</span></span><span class="line"><span class="cl">mkdir root_build root_install <span class="o">&amp;&amp;</span> <span class="nb">cd</span> root_build
</span></span><span class="line"><span class="cl">cmake -DCMAKE_INSTALL_PREFIX<span class="o">=</span>../root_install ../root_src <span class="c1"># &amp;&amp; check cmake configuration output for warnings or errors</span>
</span></span><span class="line"><span class="cl">cmake --build . -- install -j4 <span class="c1"># if you have 4 cores available for compilation</span>
</span></span><span class="line"><span class="cl"><span class="nb">source</span> ../root_install/bin/thisroot.sh <span class="c1"># or thisroot.{fish,csh}</span></span></span></code></pre></div><p>If there are any problems at the compile, additional packages may need to be installed.
See also <a href="https://root.cern/install/dependencies/" target="_blank">dependencies</a>.</p>

<div class="box notices cstyle info">
  <div class="box-label"><i class="fa-fw fas fa-info-circle"></i> Info</div>
  <div class="box-content">

<p>If errors related to xrootd, TBB and clad occur, the cmake options <code>-Dxrootd=OFF</code>, <code>-Dimt=OFF</code> and <code>-Dclad=OFF</code> may work respectively.</p>
</div>
</div>
<p>I recommend to write <code>source thisroot.sh</code> part in the .bashrc/.zshrc to load this library.</p>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="yaml-cpp">yaml-cpp</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-11-02 by Kodai Okawa</span></span>

<div class="box notices cstyle info">
  <div class="box-label"><i class="fa-fw fas fa-info-circle"></i> Info</div>
  <div class="box-content">

<p>The yaml-cpp can be installed by some package manager like <code>apt</code> or <code>dnf</code>, but I&rsquo;m not sure it will work or not in the installation of the artemis.</p>
</div>
</div>
<p>Current version of the artemis use yaml-cpp-0.7 or higher.
In order to use this library, please install from the repository.</p>
<p>See also <a href="https://github.com/jbeder/yaml-cpp" target="_blank">Github repo</a> and <a href="https://github.com/artemis-dev/artemis/blob/develop/README.md" target="_blank">README of the artemis</a>
Please install it as a shared object like below commands.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">cd</span> hoge
</span></span><span class="line"><span class="cl">git clone https://github.com/jbeder/yaml-cpp.git
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> yaml-cpp
</span></span><span class="line"><span class="cl">mkdir build <span class="o">&amp;&amp;</span> <span class="nb">cd</span> build
</span></span><span class="line"><span class="cl">cmake -DYAML_BUILD_SHARED_LIBS<span class="o">=</span>ON -DBUILD_TESTING<span class="o">=</span>OFF ..
</span></span><span class="line"><span class="cl">make
</span></span><span class="line"><span class="cl">sudo make install</span></span></code></pre></div><p>Default install path is <code>/usr/local/lib</code> or <code>/usr/local/lib64</code>.
If you do not want to pollute the general environment, specify <code>CMAKE_INSTALL_PREFIX</code> and set <strong>PATH</strong> environment variable.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">cmake -DCMAKE_INSTALL_PREFIX<span class="o">=</span>/foo/bar -DYAML_BUILD_SHARED_LIBS<span class="o">=</span>ON -DBUILD_TESTING<span class="o">=</span>OFF ..</span></span></code></pre></div>
            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
<div class="tags">
  <a class="tag-link" href="/artemis_crib/tags/crib/index.html">CRIB</a>
</div>
            </header>
<h1 id="artemis">artemis</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-11-02 by Kodai Okawa</span></span>
<p>From the current situation, CRIB experiment doesn&rsquo;t use GET system,
so we describe how to install it without linking it to GET decoder.</p>
<p>Also, it can link to <code>openMPI</code>, but the below commands assume not using openMPI.
See <a href="https://github.com/artemis-dev/artemis/blob/develop/README.md" target="_blank">artemis repo</a> for more information.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">cd</span> hoge
</span></span><span class="line"><span class="cl">git clone https://github.com/artemis-dev/artemis.git -b develop
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> artemis
</span></span><span class="line"><span class="cl">mkdir build
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> build
</span></span><span class="line"><span class="cl">cmake -DCMAKE_INSTALL_PREFIX<span class="o">=</span>../install ..
</span></span><span class="line"><span class="cl">make -j8
</span></span><span class="line"><span class="cl">make install
</span></span><span class="line"><span class="cl"><span class="nb">source</span> ../install/bin/thisartemis.sh</span></span></code></pre></div><p>Then, <code>&lt;CMAKE_INSTALL_PREFIX&gt;/bin/thisartemis.sh</code> will be created
and this shell script can configure the environment (ROOT, yaml-cpp, artemis libraries) to use artemis.</p>
<p>Also, I recommend to write <code>source thisartemis.sh</code> part in the .bashrc/.zshrc to load this library.</p>
<p>Another option is to use <code>module</code> command to manage the environment.
It is also written in <a href="https://github.com/artemis-dev/artemis/blob/develop/README.md" target="_blank">artemis repo</a>.</p>
<hr>

<div class="box notices cstyle note">
  <div class="box-label"><i class="fa-fw fas fa-exclamation-circle"></i> Note</div>
  <div class="box-content">

<p>This is 2023/10/29 current information</p>
</div>
</div>
<p>Okawa think there is a grammatical error in the <strong>sources/main/thisartemis.sh.in</strong>, so I changed like:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-diff" data-lang="diff"><span class="line"><span class="cl"><span class="gd">-if [ &#34;@BUILD_GET@&#34; == &#34;ON&#34; ]; then
</span></span></span><span class="line"><span class="cl"><span class="gd"></span><span class="gi">+if [[ &#34;@BUILD_GET@&#34; == &#34;ON&#34; ]]; then
</span></span></span><span class="line"><span class="cl"><span class="gi"></span>     export LD_LIBRARY_PATH=@GET_LIB_DIR@:$LD_LIBRARY_PATH
</span></span><span class="line"><span class="cl"> fi
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gd">-if [ &#34;@MPI_CXX_FOUND@&#34; == &#34;TRUE&#34; ]; then
</span></span></span><span class="line"><span class="cl"><span class="gd"></span><span class="gi">+if [[ &#34;@MPI_CXX_FOUND@&#34; == &#34;TRUE&#34; ]]; then
</span></span></span><span class="line"><span class="cl"><span class="gi"></span>     dir=@MPI_CXX_LIBRARIES@
</span></span><span class="line"><span class="cl">     libdir=&#34;$(dirname $dir)&#34;
</span></span></code></pre></div>
            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
<div class="tags">
  <a class="tag-link" href="/artemis_crib/tags/crib/index.html">CRIB</a>
</div>
            </header>
<h1 id="mount-setting">mount setting</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-11-02 by Kodai Okawa</span></span>
<p>For the convinience, we use one directory to store raw data (ridf files) and make symbolic link to each user work directory.
So first, we need to make raw data directory.</p>
<p>There are three option to do so.</p>
<ol>
<li>use the default SSD/HDD of analysis PC</li>
<li>use the external SSD/HDD of analysis PC (need to mount it)</li>
<li>use network file system (NFS) and mount it</li>
</ol>
<p>1 and 2 options are mainly used for offline analysis, while 3 option is used for online analysis.</p>
<h3 id="1-use-the-default-ssdhdd-of-analysis-pc">1. use the default SSD/HDD of analysis PC</h3>
<p>If you have large size of main storage, the one option is easiest way.
Just like:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">cd</span> ~
</span></span><span class="line"><span class="cl">mkdir data <span class="o">(</span>or where you want to put<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> data
</span></span><span class="line"><span class="cl">rsync hoge <span class="o">(</span>cp or scp to put the raw data<span class="o">)</span></span></span></code></pre></div><p>The symbolic link process will be done in the next process.</p>
<h3 id="2-use-the-external-ssdhdd-of-analysis-pc-need-to-mount-it">2. use the external SSD/HDD of analysis PC (need to mount it)</h3>
<p>When your main storage is not so large, you may think to use external storage.
For example, main storage is used for OS installation and external storage is used for experimental data.
(I think this case is for personal analysis using your own PC.)</p>
<p>In that case, you need to do:</p>
<ol>
<li>mount the external storage</li>
<li>check and set the file permission to be able to read or write it.</li>
</ol>
<p>The format and mount process is very depend on the situation, so please check the way in other place.
One important point is that we have output root file when we start to analysis, so it may need to make the directory for outputed root files in the external storage.</p>
<h3 id="3-use-network-file-system-nfs-and-mount-it">3. use network file system (NFS) and mount it</h3>
<p>For online analysis, the best option is to get the data via a file server, as there is no time to transfer the raw data files each time.</p>
<p>This is example of CRIB system.</p>

<div class="mermaid align-center">
---
title: Network system of CRIB
---
graph LR;
    A(MPV E7) --&gt; D{&lt;strong&gt;DAQ main PC&lt;/strong&gt;&lt;br&gt;&lt;/br&gt;file server}
    B(MPV1 J1) --&gt; D
    C(MPV2 J1) --&gt; D
    D --&gt; E[Analysis PC]
</div>
<p>As this figure, we use file server in the DAQ main PC.</p>
<h5 id="31-server-setting">3.1 server setting</h5>
<p>The OS of the DAQ PC is CentOS7, but I think it can be applied for current OS. (like <code>yum</code> -&gt; <code>dnf</code>)
First, please install required package.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo yum install -y rpcbind nfs-utils</span></span></code></pre></div><p>Then prepare the raw data file directory for sharing.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">mkdir /data <span class="o">(</span>any location<span class="o">)</span> </span></span></code></pre></div><p>And setting file for nfs is <code>/etc/exports</code>, and here is the example.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">/data 192.168.1.5
</span></span><span class="line"><span class="cl">/data 192.168.2.0/24(rw)</span></span></code></pre></div><p>The first one means the host of 192.168.1.5 can access the shared directory &ldquo;/data&rdquo;.
In the default setting, users cannot write to this directory.</p>
<p>The host of the second line means the range that can access.
If we add <code>rw</code> option, users can write to this directory.
For the other options, please check <a href="https://access.redhat.com/documentation/ja-jp/red_hat_enterprise_linux/7/html/storage_administration_guide/nfs-serverconfig" target="_blank">the official site</a>.</p>
<p>Finally, the following command is used to reflect the settings.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">firewall-cmd --permanent --zone<span class="o">=</span>public --add-service<span class="o">=</span>nfs
</span></span><span class="line"><span class="cl">firewall-cmd --reload
</span></span><span class="line"><span class="cl">systemctl start rpcbind
</span></span><span class="line"><span class="cl">systemctl <span class="nb">enable</span> rpcbind
</span></span><span class="line"><span class="cl">systemctl start nfs
</span></span><span class="line"><span class="cl">systemctl <span class="nb">enable</span> nfs</span></span></code></pre></div><p>If you do not have a firewall set up, you do not need the relevant commands.</p>
<h5 id="32-client-setting">3.2 client setting</h5>
<p>The package is also needed for client PC.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo yum install -y nfs-utils</span></span></code></pre></div><p>Prepare the mounted directory and mount it.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">mkdir /mnt/data
</span></span><span class="line"><span class="cl">sudo mount -t nfs host_IP_address:/data /mnt/data
</span></span><span class="line"><span class="cl">df -h</span></span></code></pre></div><p>If you see the mounted configuration, your nfs configuration is complete.</p>
<p>To reflect the mount settings when the system is rebooted, add a setting to <code>/etc/fstab</code>.</p>

  
<div class="tab-panel" data-tab-group="b998484f5eb614beece337484598ec4c">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="etcfstab"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('b998484f5eb614beece337484598ec4c','etcfstab')"
    >
      <span>
        <span class="tab-nav-hidden">/etc/fstab</span>
        <span class="tab-nav-text">/etc/fstab</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="etcfstab"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-diff" data-lang="diff"><span class="line"><span class="cl"><span class="gi">+ host_IP_address:/data   /mnt/data   nfs   defaults   0 0
</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo mount -a</span></span></code></pre></div>
            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
<div class="tags">
  <a class="tag-link" href="/artemis_crib/tags/crib/index.html">CRIB</a>
</div>
            </header>
<h1 id="energyloss-calculator">energyloss calculator</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-11-05 by Kodai Okawa</span></span>
<p>Some CRIB-specific files use energy loss libraries.
In particular, a library called <a href="https://github.com/okawak/SRIMlib" target="_blank">SRIMlib</a> has been developed by Okawa and some processors need to load this library.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">git clone https://github.com/okawak/SRIMlib.git
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> SRIMlib
</span></span><span class="line"><span class="cl">mkdir build
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> build
</span></span><span class="line"><span class="cl">cmake ..
</span></span><span class="line"><span class="cl">make
</span></span><span class="line"><span class="cl">make install</span></span></code></pre></div><p>Before using this library, you need to make database file (just .root file)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">cd</span> ..
</span></span><span class="line"><span class="cl"><span class="nb">source</span> thisSRIMlib.sh
</span></span><span class="line"><span class="cl">update</span></span></code></pre></div><p>If you want to make energy loss figures, &ldquo;f&rdquo; option will work.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">update -f</span></span></code></pre></div><p>Also, I recommend to write <code>source thisSRIMlib.sh</code> part in the .bashrc/.zshrc to load this library.</p>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
<div class="tags">
  <a class="tag-link" href="/artemis_crib/tags/crib/index.html">CRIB</a>
  <a class="tag-link" href="/artemis_crib/tags/unsettled/index.html">unsettled</a>
</div>
            </header>
<h1 id="art_analysis">art_analysis</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-11-14 by Kodai Okawa</span></span>
<p>With this command, all initial settings of &ldquo;art_analysis&rdquo; are made.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">curl --proto <span class="s1">&#39;=https&#39;</span> --tlsv1.2 -sSf https://okawak.github.io/artemis_crib/bin/init.sh <span class="p">|</span> sh</span></span></code></pre></div><p>After that, please add the following lines to the .bashrc/.zshrc.</p>

  
<div class="tab-panel" data-tab-group="bf5dff45bfa9a5b8b5410987b3aed32a">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="bashrczshrc"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('bf5dff45bfa9a5b8b5410987b3aed32a','bashrczshrc')"
    >
      <span>
        <span class="tab-nav-hidden">.bashrc/.zshrc</span>
        <span class="tab-nav-text">.bashrc/.zshrc</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="bashrczshrc"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># this is option</span>
</span></span><span class="line"><span class="cl"><span class="nb">source</span> <span class="si">${</span><span class="nv">HOME</span><span class="si">}</span>/Cern/root/root_install/bin/thisroot.sh <span class="p">&amp;</span>&gt; /dev/null
</span></span><span class="line"><span class="cl"><span class="nb">source</span> <span class="si">${</span><span class="nv">HOME</span><span class="si">}</span>/repos/artemis/install/bin/thisartemis.sh <span class="p">&amp;</span>&gt; /dev/null
</span></span><span class="line"><span class="cl"><span class="nb">source</span> <span class="si">${</span><span class="nv">HOME</span><span class="si">}</span>/repos/SRIMlib/thisSRIMlib.sh <span class="p">&amp;</span>&gt; /dev/null
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># need from this line!</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">EXP_NAME</span><span class="o">=</span><span class="s2">&#34;expname&#34;</span> <span class="c1"># your experiment</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">EXP_NAME_OLD</span><span class="o">=</span><span class="s2">&#34;expname&#34;</span> <span class="c1"># this is option</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span><span class="s2">/art_analysis/bin:</span><span class="si">${</span><span class="nv">PATH</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">source</span> <span class="si">${</span><span class="nv">HOME</span><span class="si">}</span>/art_analysis/bin/art_setting -q</span></span></code></pre></div></div>
    </div>
  </div>
</div><p>The setting is all!</p>
<p>Then, the following commands (shellscript) will be downloaded.</p>
<hr>
<h3 id="artloginsh">artlogin.sh</h3>
<p>This is loaded when you command <code>artlogin</code>. This command is described in the next chapter.</p>
<h3 id="artnew">artnew</h3>
<p>With this command, new artemis environment will be created interactively.</p>
<h3 id="art_setting">art_setting</h3>
<p>This is like a library. The shellscript function <code>artlogin</code>, <code>a</code> etc. are written.</p>
<h3 id="art_check">art_check</h3>
<p>Checking these shellscript is updatable or not.</p>

            <footer class="footline">

            </footer>
          </article>

          </section>
          <article class="chapter">
            <header class="headline">
            </header>
<div class="article-subheading">Chapter 2</div>
<h1 id="setting">Setting</h1>

<p>This chapter describes how to prepare the configuration file for the experiment.
If you have already some CRIB artemis environment, please see from here for initial settings.</p>

<ul class="children children-li children-sort-">
	
<li><a href="/artemis_crib/setting/new_experiment/index.html">New experiment</a></li>
<li><a href="/artemis_crib/setting/new_user/index.html">New user</a></li>
<li><a href="/artemis_crib/setting/build/index.html">Build</a></li>
<li><a href="/artemis_crib/setting/artemis_commands/index.html">artemis commands</a></li>
<li><a href="/artemis_crib/setting/map_config/index.html">Map configuration</a></li>
<li><a href="/artemis_crib/setting/steering/index.html">Steering</a></li>
<li><a href="/artemis_crib/setting/histograms/index.html">Histograms</a></li>
<li><a href="/artemis_crib/setting/vncserver/index.html">VNC server</a></li>
</ul>

            <footer class="footline">

            </footer>
          </article>

          <section>
            <h1 class="a11y-only">Subsections of Setting</h1>
          <article class="default">
            <header class="headline">
<div class="tags">
  <a class="tag-link" href="/artemis_crib/tags/crib/index.html">CRIB</a>
</div>
            </header>
<h1 id="new-experiment">New experiment</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-11-05 by Kodai Okawa</span></span>
<p>If you installed with &ldquo;curl&rdquo; command explained previous chapter, you should have <code>artnew</code> command.
This command will make new experiment directory interactively.</p>
<p>Before using this command, please check and make the <strong>directory structure</strong>!</p>
<ul>
<li>rawdata directory (like /mnt/data or /data? Create it to suit your situation.)</li>
<li>output rootfile directory (like /data/art_output?)</li>
<li>git repository
<ul>
<li>local repository: suit for online analysis</li>
<li>remote repository: suit for offline analysis</li>
</ul>
</li>
</ul>
<hr>
<h3 id="lets-start-artnew-command">Let&rsquo;s start &ldquo;artnew&rdquo; command!</h3>
<p>The word after &ldquo;:&rdquo; is your input.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; artnew</span></span></code></pre></div><ol>
<li>Input the experiment name</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">create new artemis work directory? (y/n): y
</span></span><span class="line"><span class="cl">Input experimental name: test
</span></span><span class="line"><span class="cl">Is it OK? (y/n): y
</span></span><span class="line"><span class="cl">Input value: test</span></span></code></pre></div><ol start="2">
<li>Check the base directory (default value is fine!)
<strong>If there are no input, the default value will be used</strong>.</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">artnew: If no input is provided, the default value is used.
</span></span><span class="line"><span class="cl">Input repository path or URL (default: https://github.com/okawak/artemis_crib.git):
</span></span><span class="line"><span class="cl">Is it OK? (y/n): y
</span></span><span class="line"><span class="cl">Input value: https://github.com/okawak/artemis_crib.git</span></span></code></pre></div><ol start="3">
<li>Input the rawdata directory</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">Input rawdata directory path (default: /data/test/ridf):
</span></span><span class="line"><span class="cl">Is it OK? (y/n): y
</span></span><span class="line"><span class="cl">Input value: /data/test/ridf</span></span></code></pre></div><ol start="4">
<li>Input the output directory</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">Input output data directory path (default: /data/test/user):
</span></span><span class="line"><span class="cl">Is it OK? (y/n): y
</span></span><span class="line"><span class="cl">Input value: /data/test/user</span></span></code></pre></div><ol start="5">
<li>Input the git setting (PLEASE MAKE your own repository. Local repository will be fine)</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">Based on the repository, do you make your own repository? (y/n): y
</span></span><span class="line"><span class="cl">is it local repository (y/n): y
</span></span><span class="line"><span class="cl">artnew: making LOCAL repository of test
</span></span><span class="line"><span class="cl">Input the local repository path (default: $HOME/repos/exp):
</span></span><span class="line"><span class="cl">Is it OK? (y/n): y
</span></span><span class="line"><span class="cl">Input value: /home/crib/repos/exp
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">-- snip --
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">art_analysis setting for test is finished!</span></span></code></pre></div><p>The initial setting is completed!!</p>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
<div class="tags">
  <a class="tag-link" href="/artemis_crib/tags/crib/index.html">CRIB</a>
</div>
            </header>
<h1 id="new-user">New user</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-11-05 by Kodai Okawa</span></span>
<p>After <code>artnew</code> command, you can see new directory of config files.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-diff" data-lang="diff"><span class="line"><span class="cl"> &gt; tree -a art_analysis
</span></span><span class="line"><span class="cl"> art_analysis
</span></span><span class="line"><span class="cl"> ├── .conf
</span></span><span class="line"><span class="cl"> │   ├── artlogin.sh
</span></span><span class="line"><span class="cl"><span class="gi">+│   └── test.sh
</span></span></span><span class="line"><span class="cl"><span class="gi"></span> ├── bin
</span></span><span class="line"><span class="cl"> │   ├── art_check
</span></span><span class="line"><span class="cl"> │   ├── art_setting
</span></span><span class="line"><span class="cl"> │   └── artnew
</span></span><span class="line"><span class="cl"><span class="gi">+└── test
</span></span></span></code></pre></div><p>This is experiment name &ldquo;test&rdquo; example.
In order to load this script <code>test.sh</code>, please modify &ldquo;EXP_NAME&rdquo; environment valiable in .zshrc.</p>

  
<div class="tab-panel" data-tab-group="84492ed2951cc6aabadca51f9b844d62">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="bashrczshrc"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('84492ed2951cc6aabadca51f9b844d62','bashrczshrc')"
    >
      <span>
        <span class="tab-nav-hidden">.bashrc/.zshrc</span>
        <span class="tab-nav-text">.bashrc/.zshrc</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="bashrczshrc"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">EXP_NAME</span><span class="o">=</span><span class="s2">&#34;test&#34;</span> <span class="c1"># your experiment</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>And load the config file.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; <span class="nb">source</span> ~/.zshrc</span></span></code></pre></div><p>Then you can make your own work directory by using <code>artlogin</code> command!</p>
<h3 id="lets-start-artlogin-command">Let&rsquo;s start &ldquo;artlogin&rdquo; command!</h3>
<p>For example, let&rsquo;s make default user (user name is the same with experiment name)!</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; artlogin</span></span></code></pre></div><p>If you want to make your own directory, the following will work.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; artlogin yourname</span></span></code></pre></div><ol>
<li>Check if you really want to make your work directory</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">artlogin: user &#39;test&#39; not found.
</span></span><span class="line"><span class="cl">create new user? (y/n): y
</span></span><span class="line"><span class="cl">Cloning into &#39;/Users/okawa/art_analysis/test/test&#39;...
</span></span><span class="line"><span class="cl">done.</span></span></code></pre></div><ol start="2">
<li>Git setting</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">artlogin: making local git config
</span></span><span class="line"><span class="cl">Input fullname: KodaiOkawa
</span></span><span class="line"><span class="cl">Is it Okay? (y/n): y
</span></span><span class="line"><span class="cl">Input email address: okawa@cns.s.u-tokyo.ac.jp
</span></span><span class="line"><span class="cl">Is it Okay? (y/n): y</span></span></code></pre></div><ol start="3">
<li>Symbolic link setting. If there are no problem, the current directory move to your artemis work directory</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; <span class="nb">pwd</span>
</span></span><span class="line"><span class="cl">/home/crib/art_analysis/test/test
</span></span><span class="line"><span class="cl">&gt; ls -l</span></span></code></pre></div><p>If your synbolic link seems okay, the setting is all!</p>
<hr>
<p>If <code>artnew</code> setting have problem, the error message will appear.
Typical examples are as follows.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">mkdir: /data: Read-only file system</span></span></code></pre></div><p>This is a case of the directory permissions not being set correctly.
Use the <code>chmod</code> command or similar to set them correctly and try again.</p>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
<div class="tags">
  <a class="tag-link" href="/artemis_crib/tags/crib/index.html">CRIB</a>
</div>
            </header>
<h1 id="build">Build</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-11-14 by Kodai Okawa</span></span>
<p>Before starting analysis, you need to build.
The current version of the artemis use &ldquo;cmake&rdquo; so the following steps must be taken.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; artlogin <span class="o">(</span>username<span class="o">)</span>
</span></span><span class="line"><span class="cl">&gt; mkdir build <span class="o">&amp;&amp;</span> <span class="nb">cd</span> build
</span></span><span class="line"><span class="cl">&gt; cmake ..
</span></span><span class="line"><span class="cl">&gt; make -j4
</span></span><span class="line"><span class="cl">&gt; make install
</span></span><span class="line"><span class="cl">&gt; acd</span></span></code></pre></div><p><code>acd</code> is the alias command that is definded after artlogin command. (acd = cd your_work_directory)
Also if you changed some processor, you need to do these process.</p>
<p>Then some important configuration files are automatically created.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-diff" data-lang="diff"><span class="line"><span class="cl"> &gt; tree -L 1
</span></span><span class="line"><span class="cl"> .
</span></span><span class="line"><span class="cl"><span class="gi">+├── artemislogon.C
</span></span></span><span class="line"><span class="cl"><span class="gi">+├── thisartemis-crib.sh
</span></span></span><span class="line"><span class="cl"><span class="gi"></span>
</span></span><span class="line"><span class="cl"> -- snip --
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> └── run_artemis.cpp
</span></span></code></pre></div><p>Before starting artemis, you need to load the <code>thisartemis-crib.sh</code>.
The <code>artlogin</code> command is also used to read this script, so run this command again after the build.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; artlogin <span class="o">(</span>usename<span class="o">)</span>
</span></span><span class="line"><span class="cl">&gt; a</span></span></code></pre></div><p>Then you can start artemis by using <code>a</code> command!</p>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="artemis-commands">artemis commands</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-11-14 by Kodai Okawa</span></span>
<p>Before configuring the settings according to your experiment, let&rsquo;s check that artemis is working!</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; artlogin <span class="o">(</span>username<span class="o">)</span>
</span></span><span class="line"><span class="cl">&gt; a <span class="c1"># start the artemis!</span></span></span></code></pre></div><p>Then the prompt change to the <code>artemis [0]</code>.
This means you are in artemis console!</p>
<p>Analysis using artemis use event loop.
It is therefore necessary to load a file that specifies what kind of analysis is to be performed.
This file is called the <code>steering file</code>.
As an example, let&rsquo;s check the operation using a steering file that only generates random numbers!</p>
<p>The command to load the steering file is <code>add</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>0<span class="o">]</span> add steering/example/example.tmpl.yaml <span class="nv">NUM</span><span class="o">=</span><span class="m">0001</span> <span class="nv">MAX</span><span class="o">=</span><span class="m">10</span></span></span></code></pre></div><p>This means that 10000 random numbers from 0 to MAX=10 are generated (10000 event loops).
NUM=0001 is the ID, so any number is okay (related to outputed file name).</p>
<p>And the command to start the event loop is <code>resume</code>.
(Often abbreviated as &ldquo;resume&rdquo; or &ldquo;re&rdquo;.
The abbreviated form will also run without problems if there are no conflicts with other commands.)</p>
<div class="wrap-code highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>1<span class="o">]</span> res
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>2<span class="o">]</span> Info in &lt;art::TTimerProcessor::PostLoop&gt;: <span class="nv">real</span> <span class="o">=</span> 0.02, <span class="nv">cpu</span> <span class="o">=</span> 0.02 sec, total <span class="m">10000</span> events, rate 500000.00 evts/sec</span></span></code></pre></div><p>When the time taken for such an analysis is displayed, it means that all event loops have been completed.
If you are doing a time-consuming analysis and want to suspend the event loop in the middle, <code>suspend</code> command is used. (Often &ldquo;sus&rdquo; or &ldquo;su&rdquo; is used.)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>2<span class="o">]</span> sus</span></span></code></pre></div><p>This event loop creates histogram objects (inherit from TH1 or TH2) and a TTree object.
Let&rsquo;s look at how to access each of these.</p>
<h2 id="histogram">Histogram</h2>
<p>Details are given in the <a href="https://okawak.github.io/artemis_crib/setting/histograms/index.html" target="_blank">Histograms section</a>, but histograms are created in an internal directory.
To access it, you need to use the same commands as for the linux command, such as &ldquo;ls&rdquo; or &ldquo;cd&rdquo;, to get to that directory.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>2<span class="o">]</span> ls
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> artemis
</span></span><span class="line"><span class="cl">&gt;   <span class="m">0</span> art::TTreeProjGroup test2           <span class="nb">test</span> <span class="o">(</span>2<span class="o">)</span> <span class="c1"># the first &#34;&gt;&#34; means your current position</span>
</span></span><span class="line"><span class="cl">    <span class="m">1</span> art::TTreeProjGroup <span class="nb">test</span>            <span class="nb">test</span>
</span></span><span class="line"><span class="cl">    <span class="m">2</span> art::TAnalysisInfo analysisInfo
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># then let&#39;s move to the &#34;test&#34; directory!</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>3<span class="o">]</span> <span class="nb">cd</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>4<span class="o">]</span> ls
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="nb">test</span>
</span></span><span class="line"><span class="cl">&gt;   <span class="m">0</span> art::TH1FTreeProj hRndm           random value</span></span></code></pre></div><p>You can use the command <code>ht [ID]</code> to display a histogram.
The ID can be omitted if it is already represented by &gt;.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>5<span class="o">]</span> zone <span class="c1"># make artemis canvas</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>6<span class="o">]</span> ht <span class="m">0</span></span></span></code></pre></div><figure><img src="/artemis_crib/setting/artemis_commands/example_test_hist.png" width="600"/>
</figure>

<p>Next, let&rsquo;s also check the histogram in &ldquo;test2&rdquo; directory and display two histograms vertically at the same time!</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>7<span class="o">]</span> zone <span class="m">2</span> <span class="m">1</span> <span class="c1"># row=2, column=1</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>8<span class="o">]</span> ht <span class="m">0</span> <span class="c1"># show the current hist </span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>9<span class="o">]</span> <span class="nb">cd</span> ..
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>10<span class="o">]</span> ls
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> artemis
</span></span><span class="line"><span class="cl">&gt;   <span class="m">0</span> art::TTreeProjGroup test2           <span class="nb">test</span> <span class="o">(</span>2<span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="m">1</span> art::TTreeProjGroup <span class="nb">test</span>            <span class="nb">test</span>
</span></span><span class="line"><span class="cl">    <span class="m">2</span> art::TAnalysisInfo analysisInfo
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>11<span class="o">]</span> <span class="nb">cd</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> test2
</span></span><span class="line"><span class="cl">&gt;   <span class="m">0</span> art::TH1FTreeProj hRndm2          random number
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>12<span class="o">]</span> ht <span class="m">0</span></span></span></code></pre></div><figure><img src="/artemis_crib/setting/artemis_commands/example_test_hist2.png" width="600"/>
</figure>

<h2 id="ttree">TTree</h2>
<p>Now consider displaying a diagram from a TTree object.
The file is created at here.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>13<span class="o">]</span> fls
</span></span><span class="line"><span class="cl"> files
</span></span><span class="line"><span class="cl">    <span class="m">0</span> TFile output/0001/example_0001.tree.root            <span class="o">(</span>CREATE<span class="o">)</span></span></span></code></pre></div><p>We use the <code>fcd</code> command to navigate to this root file.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>14<span class="o">]</span> fcd <span class="m">0</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>15<span class="o">]</span> ls
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> output/0001/example_0001.tree.root
</span></span><span class="line"><span class="cl">&gt;   <span class="m">0</span> art::TAnalysisInfo analysisInfo
</span></span><span class="line"><span class="cl">    <span class="m">1</span> art::TArtTree tree            tree</span></span></code></pre></div><p>The command <code>branchinfo</code> (&ldquo;br&rdquo;) displays a list of the branches stored in this tree.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>16<span class="o">]</span> br
</span></span><span class="line"><span class="cl">random               art::TSimpleData</span></span></code></pre></div><p>At the same time, the ROOT command can be used.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>17<span class="o">]</span> tree-&gt;Print<span class="o">()</span>
</span></span><span class="line"><span class="cl">******************************************************************************
</span></span><span class="line"><span class="cl">*Tree    :tree      : tree                                                   *
</span></span><span class="line"><span class="cl">*Entries :    <span class="m">10000</span> : <span class="nv">Total</span> <span class="o">=</span>          <span class="m">600989</span> bytes  File  <span class="nv">Size</span> <span class="o">=</span>      <span class="m">86144</span> *
</span></span><span class="line"><span class="cl">*        :          : Tree compression <span class="nv">factor</span> <span class="o">=</span>   7.00                       *
</span></span><span class="line"><span class="cl">******************************************************************************
</span></span><span class="line"><span class="cl">*Br    <span class="m">0</span> :random    : art::TSimpleData                                       *
</span></span><span class="line"><span class="cl">*Entries :    <span class="m">10000</span> : Total  <span class="nv">Size</span><span class="o">=</span>     <span class="m">600582</span> bytes  File <span class="nv">Size</span>  <span class="o">=</span>      <span class="m">85732</span> *
</span></span><span class="line"><span class="cl">*Baskets :        <span class="m">1</span> : Basket <span class="nv">Size</span><span class="o">=</span>    <span class="m">3200000</span> bytes  <span class="nv">Compression</span><span class="o">=</span>   7.00     *
</span></span><span class="line"><span class="cl">*............................................................................*</span></span></code></pre></div>
<div class="box notices cstyle info">
  <div class="box-label"><i class="fa-fw fas fa-info-circle"></i> Info</div>
  <div class="box-content">

<p>What is stored in the branch is not the usual type like &ldquo;double&rdquo; or &ldquo;int&rdquo;, but a class defined in artemis.
Therefore, the &ldquo;artemis&rdquo; root file cannot be opened by usual ROOT.</p>
</div>
</div>
<p>Accessing data in a branch&rsquo;s data class requires the use of public variables and methods, which can be examined by providing arguments to <code>branchinfo [branch name]</code> or <code>classinfo [class name]</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>18<span class="o">]</span> br random
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> art::TSimpleData
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> Data Members
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> Methods
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                   Bool_t   CheckTObjectHashConsistency
</span></span><span class="line"><span class="cl">             TSimpleData<span class="p">&amp;</span>   <span class="nv">operator</span><span class="o">=</span>
</span></span><span class="line"><span class="cl">             TSimpleData<span class="p">&amp;</span>   <span class="nv">operator</span><span class="o">=</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> See also
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">     art::TSimpleDataBase&lt;double&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>19<span class="o">]</span> cl art::TSimpleDataBase&lt;double&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> art::TSimpleDataBase&lt;double&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> Data Members
</span></span><span class="line"><span class="cl">
</span></span><span class="line hl"><span class="cl">                   double   fValue
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> Methods
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                     void   SetValue
</span></span><span class="line"><span class="cl">                   double   GetValue
</span></span><span class="line"><span class="cl">                   Bool_t   CheckTObjectHashConsistency
</span></span><span class="line"><span class="cl">     TSimpleDataBase&lt;double&gt;<span class="p">&amp;</span>   <span class="nv">operator</span><span class="o">=</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> See also
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">     art::TDataObject       base class <span class="k">for</span> data object</span></span></code></pre></div><p>Therefore, it can be seen that it can be accessed by the value <code>fValue</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>20<span class="o">]</span> zone
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>21<span class="o">]</span> tree-&gt;Draw<span class="o">(</span><span class="s2">&#34;random.fValue&gt;&gt;(100,0.,10.)&#34;</span><span class="o">)</span></span></span></code></pre></div><h2 id="other-useful-commands">Other useful commands</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> <span class="nb">help</span> <span class="c1"># show the commands we can use</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> save <span class="c1"># save the current canvas</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> print <span class="c1"># print the current canvas (send to the printer, need to configure)</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> unzoom
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> lgy, lgz, lny, lnz <span class="c1"># linear or log scale</span></span></span></code></pre></div>
            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
<div class="tags">
  <a class="tag-link" href="/artemis_crib/tags/crib/index.html">CRIB</a>
</div>
            </header>
<h1 id="map-configuration">Map configuration</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-11-14 by Kodai Okawa</span></span>
<p>From this section, we start to configure the settings according to the actual experimental setup.
The setting files are followings:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">&gt; tree
</span></span><span class="line"><span class="cl">.
</span></span><span class="line"><span class="cl">├── mapper.conf
</span></span><span class="line"><span class="cl">├── conf
</span></span><span class="line"><span class="cl">│   ├── map
</span></span><span class="line"><span class="cl">│   │   ├── ppac
</span></span><span class="line"><span class="cl">│   │   │   ├── dlppac.map
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">-- snip --
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">│   └── seg
</span></span><span class="line"><span class="cl">│       ├── modulelist.yaml
</span></span><span class="line"><span class="cl">│       └── seglist.yaml
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">-- snip --</span></span></code></pre></div><h3 id="1-what-is-the-map-file">1. What is the map file?</h3>
<p>The data obtained from an ADC/TDC is in the form of, for example,
&ldquo;The data coming into channel 10 of an ADC with an ID of 1 is 100&rdquo;.</p>

<div class="mermaid align-center">
---
title: Data flow example
---
graph LR;
    A{detector} --&gt;|signal| B(TDC/ADC&lt;br&gt;&lt;/br&gt;ID=1, ch=10)
    B --&gt;|value=100| C[&lt;strong&gt;Data build&lt;/strong&gt;\nridf file]
</div>
<p>The role of the map file is to map this value of &ldquo;100&rdquo; to an ID that is easy to analyse.
An ID that is easy to analyse means, for example,
that even if signals from the same detector are acquired with different ADCs/TDCs,
the same ID is easier to handle in the analysis.</p>

<div class="mermaid align-center">
---
title: Data flow example
---
graph LR;
    A(TDC/ADC&lt;br&gt;&lt;/br&gt;ID=1, ch=10) --&gt;|value=100| B[&lt;strong&gt;Data build&lt;/strong&gt;\nridf file]
    B --&gt;|value=100 mapping to| C(analysis&lt;br&gt;&lt;/br&gt;ID=2, ch=20)
</div>
<p>After mapping, we can check the data of this &ldquo;100&rdquo; from ID=2 and ch=20.
This ID and channel (2, 20) are provided for convenience, so you can freely set them.</p>
<p>So, in summary, the map file role is like this:</p>

<div class="mermaid align-center">
---
title: role of the map file
---
graph LR;
    A(DAQ ID&lt;br&gt;&lt;/br&gt;ID=1, ch=10) &lt;--&gt;|mapping| B(analysis ID&lt;br&gt;&lt;/br&gt;ID=2, ch=20)
</div>
<h3 id="2-map-files">2. map files</h3>
<p>CRIB is using <a href="https://ribf.riken.jp/RIBFDAQ/index.php?FrontPage" target="_blank">Babirl</a> for the DAQ system.
In this system, the DAQ ID represented in the example is determined by five parameters.</p>
<ul>
<li>device ID (dev)</li>
<li>focal plane (fp)</li>
<li>detector ID (det)</li>
<li>geometry ID (geo)</li>
<li>channel (ch)</li>
</ul>
<p>The dev, fp, det and geo parameters can be set from DAQ setting.
For the CRIB experiment, conventionally we set dev=12, fp=0&ndash;2 (for each MPV), det=6,7 (6=energy, 7=timing) and geo=from 0.
But you can change it freely.</p>
<p>And analysis ID represented in the example is determined by two parameters.</p>
<ul>
<li>Category ID (CatID, cid)</li>
<li>id (fID)</li>
</ul>
<p>Of cource you can also set the value freely.</p>
<p>The format of the map file is followings:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl"># [category] [id] [[device] [focus] [detector] [geo] [ch]] ....
</span></span><span class="line"><span class="cl">   1,   0,  12,   1,  6,   0,   0</span></span></code></pre></div>
<div class="box notices cstyle note">
  <div class="box-label"><i class="fa-fw fas fa-exclamation-circle"></i> Note</div>
  <div class="box-content">

<ul>
<li>The id should start from &ldquo;0&rdquo;.</li>
<li>The ADC/TDC channel start from &ldquo;0&rdquo;.</li>
<li>The leading &ldquo;#&rdquo; is treated as a comment statement.</li>
<li>you can set several &ldquo;DAQ ID&rdquo; to one &ldquo;analysis ID&rdquo; like this:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl"># map for SSD
</span></span><span class="line"><span class="cl"># [category] [id] [[device] [focus] [detector] [geo] [ch]] ....
</span></span><span class="line"><span class="cl">#
</span></span><span class="line"><span class="cl"># Map: energy, timing
</span></span><span class="line"><span class="cl">#
</span></span><span class="line"><span class="cl">#--------------------------------------------------------------------
</span></span><span class="line"><span class="cl">   1,   0,  12,   1,  6,   0,   0,  12,   2,  7,   0,   0</span></span></code></pre></div></div>
</div>
<p>Please create map files for all detectors like this!</p>
<h3 id="3-mapperconf">3. mapper.conf</h3>
<p>You can select the map file to be loaded with this file.
This is especially useful when separating map files for testing from map files for the experiment.</p>
<p>The format is followings: (<code>path/to/the/map/file number</code>)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl"># file path for configuration, relative to the working directory
</span></span><span class="line"><span class="cl"># (path to the map file) (Number of columns)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># cid = 1: rf
</span></span><span class="line"><span class="cl">conf/map/rf/rf.map 1</span></span></code></pre></div><p>In the note example above, the number is 2.</p>
<p>Please do not forget to add to the mapper.conf after you add some map files.</p>
<h3 id="4-option-segment-files">4. (option) segment files</h3>
<p>This conf files are used when you use &ldquo;chkseg.yaml&rdquo; steering file.
This steering file create raw data 2D histograms.
I will describe in the <a href="https://okawak.github.io/artemis_crib/example/online_analysis/check_rawdata/" target="_blank">Example: online_analysis/Check raw data</a> in detail.</p>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="steering">Steering</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-11-14 by Kodai Okawa</span></span>
<p>The <code>steering</code> file (yaml format) is a file that directs the process of how the obtained data is to be processed.
The <code>artemis</code> is an object-oriented program whose components are called <code>processors</code>, which are combined to process data.</p>
<p>The main role of the &ldquo;processor&rdquo; is to process data from an input data called <code>InputCollection</code> and create an output data called <code>OutputCollection</code>.
This &ldquo;OutputCollection&rdquo; will be stored into the root file as a &ldquo;tree&rdquo;.
Complex processing can be performed by using &ldquo;processor&rdquo; in multiple steps.</p>
<p>I will explain how to create this &ldquo;steering&rdquo; file using Si detector data as an example.</p>

<div class="mermaid align-center">
---
title: example of the data process structure
---
graph TD;
    subgraph event loop
    A--&gt;B(mapping processor&lt;br&gt;&lt;/br&gt;InputCollection: decoded data\nOutputCollection: Si raw data)
    B--&gt;C(calibration processor&lt;br&gt;&lt;/br&gt;InputCollection: Si raw data\nOutputCollection: Si calibrated data)
    C--&gt;X((event end))
    X--&gt;A
    end
    subgraph DAQ
    D(Raw binary data)--&gt;A(decode processor&lt;br&gt;&lt;/br&gt;InputCollection: raw data\nOutputCollection: decoded data)
    end
</div>
<h2 id="steering-file-silicon-data-case">Steering file: Silicon data case</h2>
<p>First, I describe what is the <code>Anchor</code> and how to use command line arguments.
See example here.</p>

  
<div class="tab-panel" data-tab-group="1068fded6f51b6a472ba491a7f642237">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="chkssdyaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('1068fded6f51b6a472ba491a7f642237','chkssdyaml')"
    >
      <span>
        <span class="tab-nav-hidden">chkssd.yaml</span>
        <span class="tab-nav-text">chkssd.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="chkssdyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">Anchor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span>- <span class="cp">&amp;input</span><span class="w"> </span><span class="l">ridf/@NAME@@NUM@.ridf</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span>- <span class="cp">&amp;output</span><span class="w"> </span><span class="l">output/@NAME@/@NUM@/chkssd@NAME@@NUM@.root</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span>- <span class="cp">&amp;histout</span><span class="w"> </span><span class="l">output/@NAME@/@NUM@/chkssd@NAME@@NUM@.hist.root</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>You can use variables from elsewhere in the steering file by declaring them as such.
For example if you write:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">something</span><span class="p">:</span><span class="w"> </span><span class="cp">*input</span></span></span></code></pre></div><p>This unfolds as follows:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">something</span><span class="p">:</span><span class="w"> </span><span class="l">ridf/@NAME@@NUM@.ridf</span></span></span></code></pre></div><p>Variables enclosed in <code>@</code> can also be specified by command line arguments.
For example, If you command like the following in the artemis console,</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>1<span class="o">]</span> add steering/chkssd.yaml <span class="nv">NAME</span><span class="o">=</span>run <span class="nv">NUM</span><span class="o">=</span><span class="m">0000</span></span></span></code></pre></div><p>it is considered as</p>

  
<div class="tab-panel" data-tab-group="fd6d378c1b0dbf804f3a3f6c80f1b4a3">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="chkssdyaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('fd6d378c1b0dbf804f3a3f6c80f1b4a3','chkssdyaml')"
    >
      <span>
        <span class="tab-nav-hidden">chkssd.yaml</span>
        <span class="tab-nav-text">chkssd.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="chkssdyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">Anchor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span>- <span class="cp">&amp;input</span><span class="w"> </span><span class="l">ridf/run0000.ridf</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span>- <span class="cp">&amp;output</span><span class="w"> </span><span class="l">output/run/0000/chkssdrun0000.root</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span>- <span class="cp">&amp;histout</span><span class="w"> </span><span class="l">output/run/0000/chkssdrun0000.hist.root</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><h3 id="1-general-processor">1. General processor</h3>
<p>When using the &ldquo;Babirl&rdquo;, the data file will be in the form of &ldquo;ridf&rdquo;.
In this case, the beginning and end of the steering file is usually as follows.</p>

  
<div class="tab-panel" data-tab-group="cb3ade82ba15f05783e62846c561dc74">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="chkssdyaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('cb3ade82ba15f05783e62846c561dc74','chkssdyaml')"
    >
      <span>
        <span class="tab-nav-hidden">chkssd.yaml</span>
        <span class="tab-nav-text">chkssd.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="chkssdyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">Processor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">timer</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TTimerProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">ridf</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TRIDFEventStore</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputTransparency</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">InputFiles</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="cp">*input</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">SHMID</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">mapper</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TMappingProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputTransparency</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># -- snip --</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">outputtree</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TOutputTreeProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">FileName</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="cp">*output</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><ul>
<li>TTimerProcessor: measure the time taken to process data</li>
<li>TRIDFEventStore: decode the ridf file and store the value in <code>EventStore</code> (see below)</li>
<li>TMappingProcessor: read mapper.conf for mapping</li>
<li>TOutputTreeProcessor: writes data to the root file</li>
</ul>
<p><code>OutputTransparency</code> is set to 1, indicating that &ldquo;OutputCollection&rdquo; is not exported to the root file.</p>
<h3 id="2-mapping-processor">2. Mapping processor</h3>
<p>The &ldquo;mapping processor&rdquo; puts the data stored in the &ldquo;EventStore&rdquo; into a certain data class based on &ldquo;mapper.conf&rdquo;.
Assume the following map file is used.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl"># map for SSD
</span></span><span class="line"><span class="cl"># [category] [id] [[device] [focus] [detector] [geo] [ch]] ....
</span></span><span class="line"><span class="cl">#
</span></span><span class="line"><span class="cl"># Map: energy, timing
</span></span><span class="line"><span class="cl">#
</span></span><span class="line"><span class="cl">#--------------------------------------------------------------------
</span></span><span class="line"><span class="cl">   1,   0,  12,   1,  6,   0,   0,  12,   2,  7,   0,   0</span></span></code></pre></div><p>In this case, since we are assuming data from the Si detector, let&rsquo;s consider putting it in a data class that stores energy and timing data, &ldquo;TTimingChargeData&rdquo;!
The processor mapping to this data class is &ldquo;TTimingChargeMappingProcessor&rdquo;.</p>

  
<div class="tab-panel" data-tab-group="cc7e7329a3ca4767fbc1e740ec1d3e80">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="chkssdyaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('cc7e7329a3ca4767fbc1e740ec1d3e80','chkssdyaml')"
    >
      <span>
        <span class="tab-nav-hidden">chkssd.yaml</span>
        <span class="tab-nav-text">chkssd.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="chkssdyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">Processor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">proc_ssd_raw</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TTimingChargeMappingProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">CatID</span><span class="p">:</span><span class="w">         </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">ChargeType</span><span class="p">:</span><span class="w">    </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">ChargeTypeID</span><span class="p">:</span><span class="w">  </span><span class="m">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">TimingTypeID</span><span class="p">:</span><span class="w">  </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Sparse</span><span class="p">:</span><span class="w">        </span><span class="m">1</span><span class="w">
</span></span></span><span class="line hl"><span class="cl"><span class="w">      </span><span class="nt">OutputCollection</span><span class="p">:</span><span class="w"> </span><span class="l">ssd_raw</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><ol>
<li>CatID: enter here the same number as the cid (category ID) in the map file.</li>
<li>ChargeType: there are various ways to store energy (charge) and timing using this processor, but this time &ldquo;1&rdquo; is specified to use the processing method using ADC and TDC.</li>
<li>Charge/TimingTypeID: The map file has two sets of five parameters that specify the DAQ ID. Which of these parameters specifies which represents the energy (charge) and timing. (it start from &ldquo;0&rdquo;)</li>
<li>Sparse: parameter for the output data structure</li>
<li>OutputCollection: name of the data class to be output</li>
</ol>
<p>Then, you can access the ssd_raw data by using like <code>tree-&gt;Draw(&quot;ssd_raw.fCharge&quot;)</code></p>
<h3 id="3-calibration-processor">3. Calibration processor</h3>
<p>While the data in the &ldquo;ssd_raw&rdquo; are raw channel of the ADC and TDC, it is important to see the data calibrated to energy and time.
I will explain the details in <a href="">Example: preparation/macro</a>, but here I will discuss the calibration processors assuming that the following appropriate calibration files have been created.</p>
<ul>
<li>prm/ssd/ch2MeV.dat</li>
<li>prm/ssd/ch2ns.dat</li>
</ul>
<p>Now, let&rsquo;s load these files.</p>

  
<div class="tab-panel" data-tab-group="aa7dd8d5de4310e3faa465e0776a2599">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="chkssdyaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('aa7dd8d5de4310e3faa465e0776a2599','chkssdyaml')"
    >
      <span>
        <span class="tab-nav-hidden">chkssd.yaml</span>
        <span class="tab-nav-text">chkssd.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="chkssdyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">Processor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">proc_ssd_ch2MeV</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TParameterArrayLoader</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line hl"><span class="cl"><span class="w">      </span><span class="nt">Name</span><span class="p">:</span><span class="w"> </span><span class="l">prm_ssd_ch2MeV</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TAffineConverter</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">FileName</span><span class="p">:</span><span class="w"> </span><span class="l">prm/ssd/ch2MeV.dat</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputTransparency</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">proc_ssd_ch2ns</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TParameterArrayLoader</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line hl"><span class="cl"><span class="w">      </span><span class="nt">Name</span><span class="p">:</span><span class="w"> </span><span class="l">prm_ssd_ch2ns</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TAffineConverter</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">FileName</span><span class="p">:</span><span class="w"> </span><span class="l">prm/ssd/ch2ns.dat</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputTransparency</span><span class="p">:</span><span class="w"> </span><span class="m">1</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>To calibrate data contained in a <code>TTimingChargeData</code> class, a <code>TTimingChargeCalibrationProcessor</code> processor is used.</p>

  
<div class="tab-panel" data-tab-group="f6493167537be2714a11541d89a80e17">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="chkssdyaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('f6493167537be2714a11541d89a80e17','chkssdyaml')"
    >
      <span>
        <span class="tab-nav-hidden">chkssd.yaml</span>
        <span class="tab-nav-text">chkssd.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="chkssdyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">Processor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">proc_ssd</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TTimingChargeCalibrationProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line hl"><span class="cl"><span class="w">      </span><span class="nt">InputCollection</span><span class="p">:</span><span class="w">      </span><span class="l">ssd_raw</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputCollection</span><span class="p">:</span><span class="w">     </span><span class="l">ssd_cal</span><span class="w">
</span></span></span><span class="line hl"><span class="cl"><span class="w">      </span><span class="nt">ChargeConverterArray</span><span class="p">:</span><span class="w"> </span><span class="l">prm_ssd_ch2MeV</span><span class="w">
</span></span></span><span class="line hl"><span class="cl"><span class="w">      </span><span class="nt">TimingConverterArray</span><span class="p">:</span><span class="w"> </span><span class="l">prm_ssd_ch2ns</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>Note here that &ldquo;InputCollection&rdquo;, &ldquo;ChargeConverterArray&rdquo;, and &ldquo;TimingConverterArray&rdquo; use the same names as the highlighted lines in the code block above.</p>

<div class="box notices cstyle info">
  <div class="box-label"><i class="fa-fw fas fa-info-circle"></i> Info</div>
  <div class="box-content">

<p>The arguments to be used will vary depending on the processor used, so please check and write them according to the situation.
If you want to check from artemis console, you can use &ldquo;processordescription&rdquo; command like this</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; artlogin <span class="o">(</span>username<span class="o">)</span>
</span></span><span class="line"><span class="cl">&gt; a
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>0<span class="o">]</span> processordescription art::TTimingChargeCalibrationProcessor
</span></span><span class="line"><span class="cl">Processor:
</span></span><span class="line"><span class="cl">  - name: MyTTimingChargeCalibrationProcessor
</span></span><span class="line"><span class="cl">    type: art::TTimingChargeCalibrationProcessor
</span></span><span class="line"><span class="cl">    parameter:
</span></span><span class="line"><span class="cl">      ChargeConverterArray: no_conversion  <span class="c1"># [TString] normally output of TAffineConverterArrayGenerator</span>
</span></span><span class="line"><span class="cl">      InputCollection: plastic_raw  <span class="c1"># [TString] array of objects inheriting from art::ITiming and/or art::ICharge</span>
</span></span><span class="line"><span class="cl">      InputIsDigital: <span class="m">1</span>  <span class="c1"># [Bool_t] whether input is digital or not</span>
</span></span><span class="line"><span class="cl">      OutputCollection: plastic  <span class="c1"># [TString] output class will be the same as input</span>
</span></span><span class="line"><span class="cl">      OutputTransparency: <span class="m">0</span>  <span class="c1"># [Bool_t] Output is persistent if false (default)</span>
</span></span><span class="line"><span class="cl">      TimingConverterArray: no_conversion  <span class="c1"># [TString] normally output of TAffineConverterArrayGenerator</span>
</span></span><span class="line"><span class="cl">      Verbose: <span class="m">1</span>  <span class="c1"># [Int_t] verbose level (default 1 : non quiet)</span></span></span></code></pre></div></div>
</div>
<h3 id="4-split-files">4. Split files</h3>
<p>If you want to analyse a large number of detectors, not just Si detectors,
writing everything in one steering file will result in a large amount of content that is difficult to read.</p>
<p>In that case, we can use &ldquo;include&rdquo; node!</p>
<p>In the examples we have written so far, let&rsquo;s only use a separate file for the part related to the analysis of the Si detector.</p>

  
<div class="tab-panel" data-tab-group="481c06ceee558c48781b9a1dfe2accc6">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="chkssdyaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('481c06ceee558c48781b9a1dfe2accc6','chkssdyaml')"
    >
      <span>
        <span class="tab-nav-hidden">chkssd.yaml</span>
        <span class="tab-nav-text">chkssd.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="chkssdyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="c"># -- snip --</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">Processor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># -- snip --</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">include</span><span class="p">:</span><span class="w"> </span><span class="l">ssd/ssd_single.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># -- snip --</span></span></span></code></pre></div></div>
    </div>
  </div>
</div>
  
<div class="tab-panel" data-tab-group="e2cad65ba68a0f3b2fe5b69c64e467d6">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="ssdssd_singleyaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('e2cad65ba68a0f3b2fe5b69c64e467d6','ssdssd_singleyaml')"
    >
      <span>
        <span class="tab-nav-hidden">ssd/ssd_single.yaml</span>
        <span class="tab-nav-text">ssd/ssd_single.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="ssdssd_singleyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">Processor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># parameter files</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">proc_ssd_ch2MeV</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TParameterArrayLoader</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Name</span><span class="p">:</span><span class="w"> </span><span class="l">prm_ssd_ch2MeV</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TAffineConverter</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">FileName</span><span class="p">:</span><span class="w"> </span><span class="l">prm/ssd/ch2MeV.dat</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputTransparency</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">proc_ssd_ch2ns</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TParameterArrayLoader</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Name</span><span class="p">:</span><span class="w"> </span><span class="l">prm_ssd_ch2ns</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TAffineConverter</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">FileName</span><span class="p">:</span><span class="w"> </span><span class="l">prm/ssd/ch2ns.dat</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputTransparency</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># data process</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">proc_ssd_raw</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TTimingChargeMappingProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">CatID</span><span class="p">:</span><span class="w">         </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">ChargeType</span><span class="p">:</span><span class="w">    </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">ChargeTypeID</span><span class="p">:</span><span class="w">  </span><span class="m">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">TimingTypeID</span><span class="p">:</span><span class="w">  </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Sparse</span><span class="p">:</span><span class="w">        </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputCollection</span><span class="p">:</span><span class="w"> </span><span class="l">ssd_raw</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">proc_ssd</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TTimingChargeCalibrationProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">InputCollection</span><span class="p">:</span><span class="w">      </span><span class="l">ssd_raw</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputCollection</span><span class="p">:</span><span class="w">     </span><span class="l">ssd_cal</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">ChargeConverterArray</span><span class="p">:</span><span class="w"> </span><span class="l">prm_ssd_ch2MeV</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">TimingConverterArray</span><span class="p">:</span><span class="w"> </span><span class="l">prm_ssd_ch2ns</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>In this way, the contents of &ldquo;chkssd.yaml&rdquo; can be kept concise, while the same process is carried out.
Note that the file paths here are relative to the paths from the steering directory.
Parameter files, for example, are relative paths from the working directory (one level down).</p>
<p>Utilising file splitting also makes it easier to check the steering files that analyse a large number of detectors like this.</p>

  
<div class="tab-panel" data-tab-group="de3be80e0568d6d3eff963da0d2b34fa">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="chkallyaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('de3be80e0568d6d3eff963da0d2b34fa','chkallyaml')"
    >
      <span>
        <span class="tab-nav-hidden">chkall.yaml</span>
        <span class="tab-nav-text">chkall.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="chkallyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="c"># -- snip --</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">Processor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># -- snip --</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">include</span><span class="p">:</span><span class="w"> </span><span class="l">rf/rf.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">include</span><span class="p">:</span><span class="w"> </span><span class="l">ppac/f1ppac.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">include</span><span class="p">:</span><span class="w"> </span><span class="l">ppac/dlppac.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">include</span><span class="p">:</span><span class="w"> </span><span class="l">mwdc/mwdc.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">include</span><span class="p">:</span><span class="w"> </span><span class="l">ssd/ssd_all.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># -- snip --</span></span></span></code></pre></div></div>
    </div>
  </div>
</div>
<div class="box notices cstyle info">
  <div class="box-label"><i class="fa-fw fas fa-info-circle"></i> Info</div>
  <div class="box-content">

<p>When you include other files, you can set arguments. This can be used, for example, to share variables.
Details will be introduced in the example section.</p>
</div>
</div>
<hr>
<h3 id="summary">Summary</h3>
<p>The whole steering file is as follows:</p>

  
<div class="tab-panel" data-tab-group="cfc4ac4ebf99ea05689bd1cac1e4d231">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="chkssdyaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('cfc4ac4ebf99ea05689bd1cac1e4d231','chkssdyaml')"
    >
      <span>
        <span class="tab-nav-hidden">chkssd.yaml</span>
        <span class="tab-nav-text">chkssd.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="chkssdyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">Anchor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span>- <span class="cp">&amp;input</span><span class="w"> </span><span class="l">ridf/@NAME@@NUM@.ridf</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span>- <span class="cp">&amp;output</span><span class="w"> </span><span class="l">output/@NAME@/@NUM@/chkssd@NAME@@NUM@.root</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span>- <span class="cp">&amp;histout</span><span class="w"> </span><span class="l">output/@NAME@/@NUM@/chkssd@NAME@@NUM@.hist.root</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">Processor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">timer</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TTimerProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">ridf</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TRIDFEventStore</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputTransparency</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">InputFiles</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="cp">*input</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">SHMID</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">mapper</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TMappingProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputTransparency</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">include</span><span class="p">:</span><span class="w"> </span><span class="l">ssd/ssd_single.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># output root file</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">outputtree</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TOutputTreeProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">FileName</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="cp">*output</span></span></span></code></pre></div></div>
    </div>
  </div>
</div>
  
<div class="tab-panel" data-tab-group="ea78fe322fb6e41f22953a1c896ab966">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="ssdssd_singleyaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('ea78fe322fb6e41f22953a1c896ab966','ssdssd_singleyaml')"
    >
      <span>
        <span class="tab-nav-hidden">ssd/ssd_single.yaml</span>
        <span class="tab-nav-text">ssd/ssd_single.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="ssdssd_singleyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">Processor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># parameter files</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">proc_ssd_ch2MeV</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TParameterArrayLoader</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Name</span><span class="p">:</span><span class="w"> </span><span class="l">prm_ssd_ch2MeV</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TAffineConverter</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">FileName</span><span class="p">:</span><span class="w"> </span><span class="l">prm/ssd/ch2MeV.dat</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputTransparency</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">proc_ssd_ch2ns</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TParameterArrayLoader</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Name</span><span class="p">:</span><span class="w"> </span><span class="l">prm_ssd_ch2ns</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TAffineConverter</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">FileName</span><span class="p">:</span><span class="w"> </span><span class="l">prm/ssd/ch2ns.dat</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputTransparency</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># data process</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">proc_ssd_raw</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TTimingChargeMappingProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">CatID</span><span class="p">:</span><span class="w">         </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">ChargeType</span><span class="p">:</span><span class="w">    </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">ChargeTypeID</span><span class="p">:</span><span class="w">  </span><span class="m">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">TimingTypeID</span><span class="p">:</span><span class="w">  </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Sparse</span><span class="p">:</span><span class="w">        </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputCollection</span><span class="p">:</span><span class="w"> </span><span class="l">ssd_raw</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">proc_ssd</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TTimingChargeCalibrationProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">InputCollection</span><span class="p">:</span><span class="w">      </span><span class="l">ssd_raw</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputCollection</span><span class="p">:</span><span class="w">     </span><span class="l">ssd_cal</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">ChargeConverterArray</span><span class="p">:</span><span class="w"> </span><span class="l">prm_ssd_ch2MeV</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">TimingConverterArray</span><span class="p">:</span><span class="w"> </span><span class="l">prm_ssd_ch2ns</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; acd
</span></span><span class="line"><span class="cl">&gt; a
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>0<span class="o">]</span> add steering/chkssd.yaml <span class="nv">NAME</span><span class="o">=</span>run <span class="nv">NUM</span><span class="o">=</span><span class="m">0000</span></span></span></code></pre></div>
            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="histograms">Histograms</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-11-14 by Kodai Okawa</span></span>
<p>In the online analysis, it is important to have immediate access to data.
The artemis can produce <strong>TTree</strong> object but long commands are needed to access, for example,</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>1<span class="o">]</span> fcd <span class="m">0</span>  <span class="c1"># move to the created rootfile</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>2<span class="o">]</span> zone <span class="m">2</span> <span class="m">2</span>  <span class="c1"># make a &#34;artemis&#34; 2x2 canvas</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>3<span class="o">]</span> tree-&gt;Draw<span class="o">(</span><span class="s2">&#34;ssd_cal.fCharge:ssd_cal.fTiming&gt;(100,0.,100., 100,0.,100)&#34;</span>,<span class="s2">&#34;ssd_cal.fCharge &gt; 1.0&#34;</span>,<span class="s2">&#34;colz&#34;</span><span class="o">)</span></span></span></code></pre></div><p>This would take time if there are some histograms that you want to display immediately&hellip;</p>
<p>Therefore, if you know in advance the diagram you want to see, it is useful to predefine its histogram!
The processor used is <code>TTreeProjectionProcessor</code>.
I would like to explain how to use this one.</p>
<h2 id="1-steering-file">1. Steering file</h2>
<p>Let&rsquo;s look at how histograms are defined when looking at SSD data.
First, let&rsquo;s prepare the steering file as follows!
please see previous section for omissions.</p>

  
<div class="tab-panel" data-tab-group="2eb3f03491e008e11e32cb931e39a3eb">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="chkssdyaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('2eb3f03491e008e11e32cb931e39a3eb','chkssdyaml')"
    >
      <span>
        <span class="tab-nav-hidden">chkssd.yaml</span>
        <span class="tab-nav-text">chkssd.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="chkssdyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="c"># -- snip --</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">include</span><span class="p">:</span><span class="w"> </span><span class="l">ssd/ssd_single.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># Histogram</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">projection_ssd</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TTreeProjectionProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line hl"><span class="cl"><span class="w">      </span><span class="nt">FileName</span><span class="p">:</span><span class="w"> </span><span class="l">hist/ssd/ssd.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Type</span><span class="p">:</span><span class="w">     </span><span class="l">art::TTreeProjection</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputFilename</span><span class="p">:</span><span class="w"> </span><span class="cp">*histout</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># output root file</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">outputtree</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TOutputTreeProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">FileName</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="cp">*output</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>The histogram is created based on the <strong>TTree</strong> object,
so describe the processing of the histogram after the part that represents the data processing and before the part that outputs the TTree (<code>TOutputTreeProcessor</code>).</p>
<p>There are three points to note here.</p>
<ol>
<li>It is possible to create a root file containing only a histogram as well as a root file containing a TTree.
(Look at the node part of the OutputFilename.)</li>
<li>The histogram itself is defined in a separate file to this one, written on the highlighted line above.</li>
<li>The file paths are relative to the working directory.</li>
</ol>
<p>Therefore, I would now like to show the histogram definition file.</p>
<h2 id="2-histogram-file">2. Histogram file</h2>
<p>First please look at this example.</p>

  
<div class="tab-panel" data-tab-group="cc6453ce48bdcd89cf5b7bd3061fa4ad">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="histssdssdyaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('cc6453ce48bdcd89cf5b7bd3061fa4ad','histssdssdyaml')"
    >
      <span>
        <span class="tab-nav-hidden">hist/ssd/ssd.yaml</span>
        <span class="tab-nav-text">hist/ssd/ssd.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="histssdssdyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="nt">anchor</span><span class="p">:</span><span class="w"> 
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="w">  </span>- <span class="cp">&amp;energy</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;ssd_cal.fCharge&#34;</span><span class="p">,</span><span class="m">100</span><span class="p">,</span><span class="m">0</span><span class="l">.,100.]</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="w">  </span>- <span class="cp">&amp;timing</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;ssd_cal.fTiming&#34;</span><span class="p">,</span><span class="m">100</span><span class="p">,</span><span class="m">0</span><span class="l">.,100.]</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="w"></span><span class="nt">alias</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="w">  </span><span class="nt">energy_cut</span><span class="p">:</span><span class="w"> </span><span class="l">ssd_cal.fCharge&gt;1.0;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="w"></span><span class="nt">group</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">ssd_test</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="w">    </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l">ssd_test</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="w">    </span><span class="nt">contents</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">ssd_energy</span><span class="w">
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="w">        </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l">ssd_energy</span><span class="w">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="w">        </span><span class="nt">x</span><span class="p">:</span><span class="w"> </span><span class="cp">*energy</span><span class="w">
</span></span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">ssd_timing</span><span class="w">
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="w">        </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l">ssd_timing</span><span class="w">
</span></span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="w">        </span><span class="nt">x</span><span class="p">:</span><span class="w"> </span><span class="cp">*timing</span><span class="w">
</span></span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">ssd_energy and timing</span><span class="w">
</span></span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="w">        </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l">ssd_energy and timing</span><span class="w">
</span></span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="w">        </span><span class="nt">x</span><span class="p">:</span><span class="w"> </span><span class="cp">*timing</span><span class="w">
</span></span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="w">        </span><span class="nt">y</span><span class="p">:</span><span class="w"> </span><span class="cp">*energy</span><span class="w">
</span></span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="w">        </span><span class="nt">cut</span><span class="p">:</span><span class="w"> </span><span class="l">energy_cut</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>This definition file consists of three parts.</p>
<h3 id="21-anchor">2.1 anchor</h3>
<p>The actual core part is the &ldquo;<strong>2.3 group</strong>&rdquo;, but &ldquo;<strong>2.1 anchor</strong>&rdquo; and &ldquo;<strong>2.2 alias</strong>&rdquo; are often used to make this part easier to write.
The anchor defines the first argument of <code>tree-&gt;Draw(&quot;ssd_cal.fCharge&gt;(100,0.,100.)&quot;,&quot;ssd_cal.fCharge &gt; 1.0&quot;)</code></p>
<p>The array stored in the variable named &ldquo;energy&rdquo; in the second line looks like <code>[str, int, float, float]</code> and has the following meanings</p>
<ol>
<li>str: Name of the object (need double quote &ldquo;&rdquo;)</li>
<li>int: Number of bins of histogram</li>
<li>float: Minimum value of histogram range</li>
<li>float: Maximum value of histogram range</li>
</ol>
<p>As you might imagine, inside the first argument you can also add operations such as <code>TMath::Sqrt(ssd_cal.fCharge)</code> or <code>ssd_cal.fCharge-ssd_cal.fTiming</code>, because it is the same with &ldquo;tree-&gt;Draw&rdquo;.</p>
<p>Note, however, that the definition here is for one-dimensional histograms.
Two-dimensional histograms will be presented in Section 2.3. It is very simple to write!</p>
<h3 id="22-alias">2.2 alias</h3>
<p>This part is used when applying gates to events (often we call it as &ldquo;cut&rdquo; or &ldquo;selection&rdquo;).
For example, if you only want to see events with energies above 1.0 MeV, you would write something like <code>tree-&gt;Draw(&quot;energy&quot;,&quot;energy&gt;1.0&quot;)</code>.</p>
<p>The alias node is used to define the part of <code>energy&gt;1.0</code></p>

<div class="box notices cstyle note">
  <div class="box-label"><i class="fa-fw fas fa-exclamation-circle"></i> Note</div>
  <div class="box-content">

<p>A semicolon &ldquo;;&rdquo; at the end of the sentence may be needed&hellip;?
please check <a href="https://github.com/artemis-dev/artemis/blob/develop/sources/loop/hist/TTreeProjection.cc" target="_blank">the source</a>.</p>
</div>
</div>
<h3 id="23-group">2.3 group</h3>
<p>The histogram is defined here and the object is stored in a directory in artemis (ROOT, TDirectory).
In the example shown above, the directory structure would look like this:</p>
<p>(It is not actually displayed in this way).</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># in artemis</span>
</span></span><span class="line"><span class="cl">.
</span></span><span class="line"><span class="cl">└── ssd_test
</span></span><span class="line"><span class="cl">    ├── ssd_energy <span class="o">(</span>1D hist<span class="o">)</span>
</span></span><span class="line"><span class="cl">    ├── ssd_timing <span class="o">(</span>1D hist<span class="o">)</span>
</span></span><span class="line"><span class="cl">    └── ssd_energy and timing <span class="o">(</span>2D hist<span class="o">)</span></span></span></code></pre></div><p>The first &ldquo;name&rdquo; and &ldquo;title&rdquo; nodes are arguments of TDirectory instance.
Also the second &ldquo;name&rdquo; and &ldquo;title&rdquo; nodes are arguments of instance of TH1 or TH2 object.
The other &ldquo;x&rdquo;, &ldquo;y&rdquo; and &ldquo;cut&rdquo; is the important node!</p>
<ol>
<li>If there are only &ldquo;x&rdquo; nodes -&gt; 1D histogram</li>
<li>If there are both &ldquo;x&rdquo; and &ldquo;y&rdquo; nodes -&gt; 2D histogram</li>
<li>In any case, it can be gated by adding a &ldquo;cut&rdquo; node.</li>
</ol>
<h2 id="3-commands-for-histograms">3. Commands for histograms</h2>
<p>There are many useful command for checking the histogram objects.
These are similar to the <a href="https://ribf.riken.go.jp/RIBFDAQ/index.php?Tools/Analysis/ANAPAW" target="_blank">ANAPAW</a> commands.</p>
<ol>
<li>ls : check the artemis directory</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; artlogin <span class="o">(</span>username<span class="o">)</span>
</span></span><span class="line"><span class="cl">&gt; a
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>0<span class="o">]</span> add steering/chkssd.yaml <span class="nv">NAME</span><span class="o">=</span>hoge <span class="nv">NUM</span><span class="o">=</span><span class="m">0000</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>1<span class="o">]</span> res
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>2<span class="o">]</span> sus
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>3<span class="o">]</span> ls <span class="c1"># check the artemis directory</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> artemis
</span></span><span class="line"><span class="cl">&gt;   <span class="m">0</span> art::TTreeProjGroup ssd_test        ssd_test
</span></span><span class="line"><span class="cl">    <span class="m">1</span> art::TAnalysisInfo analysisInfo</span></span></code></pre></div><ol start="2">
<li>cd [ID] : move to the directory of the ID</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>4<span class="o">]</span> <span class="nb">cd</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>5<span class="o">]</span> ls
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> ssd_test
</span></span><span class="line"><span class="cl">&gt;   <span class="m">0</span> art::TH1FTreeProj ssd_energy      ssd_energy
</span></span><span class="line"><span class="cl">    <span class="m">1</span> art::TH1FTreeProj ssd_timing      ssd_timing
</span></span><span class="line"><span class="cl">    <span class="m">2</span> art::TH2FTreeProj ssd_energy and timing ssd_energy and timing</span></span></code></pre></div><ol start="3">
<li>ht [ID] [option] : draw the histogram of the ID</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>6<span class="o">]</span> ht <span class="m">0</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>7<span class="o">]</span> ht <span class="m">2</span> colz</span></span></code></pre></div><ol start="4">
<li>hn : draw the next ID histogram</li>
<li>hb : draw the prev ID histogram</li>
</ol>
<h2 id="4-template-hist-file">4. Template hist file</h2>
<p>When setting up several detectors of the same type and wanting to set up a histogram with the same content, it is tedious to create several files with only the names of the objects changed.
In such cases, it is useful to allow the histogram definition file to have arguments.</p>
<p>Please look here first.</p>

  
<div class="tab-panel" data-tab-group="42e5fe6c1f32a6d149b9ed4e9b0f274e">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="chkssdyaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('42e5fe6c1f32a6d149b9ed4e9b0f274e','chkssdyaml')"
    >
      <span>
        <span class="tab-nav-hidden">chkssd.yaml</span>
        <span class="tab-nav-text">chkssd.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="chkssdyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="c"># -- snip --</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">include</span><span class="p">:</span><span class="w"> </span><span class="l">ssd/ssd_single.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># Histogram</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">projection_ssd</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TTreeProjectionProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">FileName</span><span class="p">:</span><span class="w"> </span><span class="l">hist/ssd/ssd.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Type</span><span class="p">:</span><span class="w">     </span><span class="l">art::TTreeProjection</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputFilename</span><span class="p">:</span><span class="w"> </span><span class="cp">*histout</span><span class="w">
</span></span></span><span class="line hl"><span class="cl"><span class="w">      </span><span class="nt">Replace</span><span class="p">:</span><span class="w"> </span><span class="p">|</span><span class="sd">
</span></span></span><span class="line hl"><span class="cl"><span class="sd">        name: ssd_cal</span><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># -- snip --</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>We add the highlighted lines.
Then the &ldquo;name&rdquo; can be used at hist file by <code>@name@</code>!
The &ldquo;name&rdquo; can be freely set.</p>

  
<div class="tab-panel" data-tab-group="c281400111b068330db69eb930c10b03">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="histssdssdyaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('c281400111b068330db69eb930c10b03','histssdssdyaml')"
    >
      <span>
        <span class="tab-nav-hidden">hist/ssd/ssd.yaml</span>
        <span class="tab-nav-text">hist/ssd/ssd.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="histssdssdyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">anchor</span><span class="p">:</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="cp">&amp;energy</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;@name@.fCharge&#34;</span><span class="p">,</span><span class="m">100</span><span class="p">,</span><span class="m">0</span><span class="l">.,100.]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="cp">&amp;timing</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;@name@.fTiming&#34;</span><span class="p">,</span><span class="m">100</span><span class="p">,</span><span class="m">0</span><span class="l">.,100.]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">alias</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">energy_cut</span><span class="p">:</span><span class="w"> </span>@<span class="l">name@.fCharge&gt;1.0;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">group</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">ssd_test</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l">ssd_test</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">contents</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">ssd_energy</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l">ssd_energy</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">x</span><span class="p">:</span><span class="w"> </span><span class="cp">*energy</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">ssd_timing</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l">ssd_timing</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">x</span><span class="p">:</span><span class="w"> </span><span class="cp">*timing</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">ssd_energy and timing</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l">ssd_energy and timing</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">x</span><span class="p">:</span><span class="w"> </span><span class="cp">*timing</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">y</span><span class="p">:</span><span class="w"> </span><span class="cp">*energy</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">cut</span><span class="p">:</span><span class="w"> </span><span class="l">energy_cut</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>This is useful when there are more objects to check!</p>

  
<div class="tab-panel" data-tab-group="4637ef7949d757a32265b27f063c7f12">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="chkssdyaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('4637ef7949d757a32265b27f063c7f12','chkssdyaml')"
    >
      <span>
        <span class="tab-nav-hidden">chkssd.yaml</span>
        <span class="tab-nav-text">chkssd.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="chkssdyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="c"># -- snip --</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">include</span><span class="p">:</span><span class="w"> </span><span class="l">ssd/ssd_single.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># Histogram</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">projection_ssd</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TTreeProjectionProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">FileName</span><span class="p">:</span><span class="w"> </span><span class="l">hist/ssd/ssd.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Type</span><span class="p">:</span><span class="w">     </span><span class="l">art::TTreeProjection</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputFilename</span><span class="p">:</span><span class="w"> </span><span class="cp">*histout</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Replace</span><span class="p">:</span><span class="w"> </span><span class="p">|</span><span class="sd">
</span></span></span><span class="line"><span class="cl"><span class="sd">        name: ssd_cal</span><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">projection_ssd</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TTreeProjectionProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">FileName</span><span class="p">:</span><span class="w"> </span><span class="l">hist/ssd/ssd.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Type</span><span class="p">:</span><span class="w">     </span><span class="l">art::TTreeProjection</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Replace</span><span class="p">:</span><span class="w"> </span><span class="p">|</span><span class="sd">
</span></span></span><span class="line"><span class="cl"><span class="sd">        name: ssd_raw</span><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># and so on!</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># -- snip --</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>File splitting using &ldquo;include&rdquo; nodes, as described in the section on steeling, can also be used in the same way.</p>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="vnc-server">VNC server</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-11-15 by Kodai Okawa</span></span>
<p>When we start the analysis, there are many situations where the analysis server on which artemis is installed is not only operated directly, but also remotely using &ldquo;ssh&rdquo;.
In such cases, there are various settings that need to be made in order for the figure to be displayed on the local computer, and some of these methods are described in this section.
We recommended to use <code>VNC server</code> currently, but note that policies may change in the future.</p>
<p>This is a list of ways to display the figures.</p>
<ul>
<li>X11Forwarding</li>
<li>VNC server</li>
<li>Save figure and check by using VScode</li>
<li>Web browser (THttpServer)</li>
</ul>
<h2 id="x11forwarding">X11Forwarding</h2>
<p>This is the simplest method.
Simply transfer the remote X to the local.</p>

  
<div class="tab-panel" data-tab-group="c75e31d38c7c0d280f175180222f0c84">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="your-local-pc"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('c75e31d38c7c0d280f175180222f0c84','your-local-pc')"
    >
      <span>
        <span class="tab-nav-hidden">your local PC</span>
        <span class="tab-nav-text">your local PC</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="your-local-pc"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">ssh -X analysisPC</span></span></code></pre></div></div>
    </div>
  </div>
</div><p>This &ldquo;X&rdquo; option allow the X11Forwarding.</p>
<p>However, the problem with this method is that it takes a long time to process, and it takes longer from the time the command is typed until it is drawn.
It is also not recommended as the process can become slow if a large number of people use it at the same time.</p>
<p>However, it is simpler than other methods and should be used when necessary, e.g. for debugging.</p>
<h2 id="vnc-server">VNC server</h2>

<div class="box notices cstyle info">
  <div class="box-label"><i class="fa-fw fas fa-info-circle"></i> Info</div>
  <div class="box-content">

<p>This is old version of VNC server (TigerVNC). Latest version supports more secure method, so this method may no longer be avaliable in the future&hellip;</p>
</div>
</div>
<p>First please install VNC viewer to your PC.
Any viewer may work well, but we are using <a href="https://www.realvnc.com/en/connect/download/viewer/" target="_blank">this software</a>.</p>
<p>First, please check the ID number of the VNC server we are running.</p>

  
<div class="tab-panel" data-tab-group="b88d54767db52b284f5e2bc50428dc81">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="in-analysis-pc"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('b88d54767db52b284f5e2bc50428dc81','in-analysis-pc')"
    >
      <span>
        <span class="tab-nav-hidden">in analysis PC</span>
        <span class="tab-nav-text">in analysis PC</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="in-analysis-pc"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; vncserver -list
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">TigerVNC server sessions:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">X DISPLAY <span class="c1">#	PROCESS ID</span>
</span></span><span class="line"><span class="cl">:1		  <span class="m">3146</span>
</span></span><span class="line"><span class="cl">:5		  <span class="m">7561</span>
</span></span><span class="line"><span class="cl">:2022	  <span class="m">29499</span>
</span></span><span class="line"><span class="cl">:2		  <span class="m">23055</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>In this example, number 1, 5, 2022 and 2 VNC server is running.
And select an available number to start the VNC server you want to use.</p>

  
<div class="tab-panel" data-tab-group="5488de7765c14b3a7edeb103d3e03287">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="in-analysis-pc"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('5488de7765c14b3a7edeb103d3e03287','in-analysis-pc')"
    >
      <span>
        <span class="tab-nav-hidden">in analysis PC</span>
        <span class="tab-nav-text">in analysis PC</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="in-analysis-pc"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; vncserver :10 <span class="c1"># start the VNC server!</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>If you want to kill the VNC server, the below command will work.</p>

  
<div class="tab-panel" data-tab-group="e76c0935170c1617150dfa4203f37618">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="in-analysis-pc"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('e76c0935170c1617150dfa4203f37618','in-analysis-pc')"
    >
      <span>
        <span class="tab-nav-hidden">in analysis PC</span>
        <span class="tab-nav-text">in analysis PC</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="in-analysis-pc"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; vncserver -kill :10 <span class="c1"># kill the VNC server!</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>Next, configure the canvas created by artemis to be sent to a VNC server.
The <code>a</code> command can treat this process by using <code>.vncdisplay</code> file!</p>

  
<div class="tab-panel" data-tab-group="07f6210703c46131d16cf9b5f3602646">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="in-analysis-pc"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('07f6210703c46131d16cf9b5f3602646','in-analysis-pc')"
    >
      <span>
        <span class="tab-nav-hidden">in analysis PC</span>
        <span class="tab-nav-text">in analysis PC</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="in-analysis-pc"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; artlogin <span class="o">(</span>username<span class="o">)</span> <span class="c1"># move to your artemis work directory</span>
</span></span><span class="line"><span class="cl">&gt; <span class="nb">echo</span> <span class="s2">&#34;10&#34;</span> &gt; .vncdisplay <span class="c1"># write the ID of VNC server to the .vncdisplay file</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>Then, the setting in analysis PC is completed!
The next step is to set up your local PC to receive this.</p>

<div class="box notices cstyle info">
  <div class="box-label"><i class="fa-fw fas fa-info-circle"></i> Info</div>
  <div class="box-content">

<p>If you connect your PC in the same network with analysis PC, you can directory connect using the VNC viewer.
However, CRIB analysis PC are connected CNS local network.
In order to connect from outside network, we need to use &ldquo;CNS login server&rdquo;.
If you want to make the login server account, please contact the CRIB member!</p>
</div>
</div>
<p>In this section, we are assuming that you have a CNS login server account.</p>
<p>To access the analysis PC, use two-stage ssh. Prepare the following configuration file.</p>

  
<div class="tab-panel" data-tab-group="edecb33fc05cbcf035bf1e81a3424f1a">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="in-local-pc-sshconfig"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('edecb33fc05cbcf035bf1e81a3424f1a','in-local-pc-sshconfig')"
    >
      <span>
        <span class="tab-nav-hidden">in local PC, .ssh/config</span>
        <span class="tab-nav-text">in local PC, .ssh/config</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="in-local-pc-sshconfig"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-aconf" data-lang="aconf"><span class="line"><span class="cl"><span class="nb">Host</span> login
</span></span><span class="line"><span class="cl">    <span class="c"># need to change</span>
</span></span><span class="line"><span class="cl">    <span class="nb">HostName</span> CNS_loginserver_hostname
</span></span><span class="line"><span class="cl">    <span class="nb">User</span> username
</span></span><span class="line"><span class="cl">    <span class="nb">IdentityFile</span> ~/.ssh/id_rsa
</span></span><span class="line"><span class="cl">    <span class="c"># no need to change (if you want)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">ForWardX11Timeout</span> <span class="m">24</span>h
</span></span><span class="line"><span class="cl">    <span class="nb">ControlPersist</span> <span class="m">30</span>m
</span></span><span class="line"><span class="cl">    <span class="nb">ForwardAgent</span> yes
</span></span><span class="line"><span class="cl">    <span class="nb">ControlMaster</span> auto
</span></span><span class="line"><span class="cl">    <span class="nb">ControlPath</span> ~/.ssh/mux-%r@%h:%p
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># any name is okay</span>
</span></span><span class="line"><span class="cl"><span class="nb">Host</span> analysis
</span></span><span class="line"><span class="cl">    <span class="c"># need to change</span>
</span></span><span class="line"><span class="cl">    <span class="nb">HostName</span> analysisPC_hostname
</span></span><span class="line"><span class="cl">    <span class="nb">User</span> username
</span></span><span class="line"><span class="cl">    <span class="nb">IdentityFile</span> ~/.ssh/id_rsa
</span></span><span class="line"><span class="cl">    <span class="c"># no need to change (if you want)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">ProxyCommand</span> ssh login nc %h %p
</span></span><span class="line"><span class="cl">    <span class="nb">ForwardAgent</span> yes
</span></span><span class="line"><span class="cl">    <span class="nb">ControlMaster</span> auto
</span></span><span class="line"><span class="cl">    <span class="nb">ControlPath</span> ~/.ssh/mux-%r@%h:%p
</span></span><span class="line"><span class="cl">    <span class="nb">ControlPersist</span> <span class="m">30</span>m</span></span></code></pre></div></div>
    </div>
  </div>
</div><p>Then you can access to the analysis PC simply by:</p>

  
<div class="tab-panel" data-tab-group="b351ab058fc961e9ffc72ed379ec2ee0">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="in-local-pc"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('b351ab058fc961e9ffc72ed379ec2ee0','in-local-pc')"
    >
      <span>
        <span class="tab-nav-hidden">in local PC</span>
        <span class="tab-nav-text">in local PC</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="in-local-pc"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; ssh analysis</span></span></code></pre></div></div>
    </div>
  </div>
</div><p>Next, in order to receive from the VNC server, we use port-forwarding!
VNC servers with ID x use port number 5900+x.
For example if we use number &ldquo;10&rdquo;, the port will be 5910.</p>
<p>Forward this to a certain port on localhost. This number can be any number that is not in use.</p>

<div class="mermaid align-center">
---
title: An example of port-forwarding
---
graph LR;
    A(analysis PC&lt;br&gt;&lt;/br&gt;port 5910) --&gt; |send|B(local PC&lt;br&gt;&lt;/br&gt;port 55910)
</div>

  
<div class="tab-panel" data-tab-group="bac3471cdb60ff932a24831b06d8d3e9">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="in-local-pc-sshconfig"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('bac3471cdb60ff932a24831b06d8d3e9','in-local-pc-sshconfig')"
    >
      <span>
        <span class="tab-nav-hidden">in local PC, .ssh/config</span>
        <span class="tab-nav-text">in local PC, .ssh/config</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="in-local-pc-sshconfig"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-aconf" data-lang="aconf"><span class="line"><span class="cl"><span class="nb">Host</span> analysis
</span></span><span class="line"><span class="cl">    <span class="nb">HostName</span> analysisPC_hostname
</span></span><span class="line"><span class="cl">    <span class="nb">User</span> username
</span></span><span class="line"><span class="cl">    <span class="nb">IdentityFile</span> ~/.ssh/id_rsa
</span></span><span class="line hl"><span class="cl">    <span class="nb">LocalForward</span> <span class="m">55910</span> localhost:5910
</span></span><span class="line"><span class="cl">    <span class="nb">ProxyCommand</span> ssh login nc %h %p
</span></span><span class="line"><span class="cl">    <span class="nb">ForwardAgent</span> yes
</span></span><span class="line"><span class="cl">    <span class="nb">ControlMaster</span> auto
</span></span><span class="line"><span class="cl">    <span class="nb">ControlPath</span> ~/.ssh/mux-%r@%h:%p
</span></span><span class="line"><span class="cl">    <span class="nb">ControlPersist</span> <span class="m">30</span>m</span></span></code></pre></div></div>
    </div>
  </div>
</div><p>This allows you to display a VNC display by accessing port 55910 on your own PC (localhost), instead of having to access port 5910 on the analysis PC!</p>
<figure><img src="/artemis_crib/setting/vncserver/vncviewer.png" width="600"/>
</figure>

<p>If your PC is in the same network, changing &ldquo;localhost&rdquo; to the &ldquo;IP address of analysis PC&rdquo; is okay (ex. 192.168.1.10:5910).</p>
<h2 id="save-figure-and-check-by-using-vscode">Save figure and check by using VScode</h2>
<p><a href="https://code.visualstudio.com/" target="_blank">VScode</a> is very exciting editor!
The extension supports ssh and allows remote png files to be displayed on the editor.</p>
<p>However, it is a bit time-consuming as the diagram has to be saved each time to view it.
Please refer to this as one method.</p>
<figure><img src="/artemis_crib/setting/vncserver/vscode.png" width="600"/>
</figure>

<h2 id="web-browser-thttpserver">Web browser (THttpServer)</h2>
<p>This is option&hellip;</p>
<p>Now the histogram object cannot display by JSROOT, because the object is not actually &ldquo;TH1&rdquo; or &ldquo;TH2&rdquo; object but &ldquo;TH1FTreeProj&rdquo; or &ldquo;TH2FTreeProj&rdquo;.
(ref: <a href="https://github.com/artemis-dev/artemis/issues/40" target="_blank">issue#40</a>)</p>
<p>We can only display the &ldquo;TCanvas&rdquo; Object.</p>
<figure><img src="/artemis_crib/setting/vncserver/httpserver.png" width="600"/>
</figure>


            <footer class="footline">

            </footer>
          </article>

          </section>
          <article class="chapter">
            <header class="headline">
            </header>
<div class="article-subheading">Chapter 3</div>
<h1 id="crib-configuration">CRIB Configuration</h1>

<p>Artemis configuration varies from experiment to experiment.
We would like to explain in this chapter how they are configured and used in CRIB experiment.</p>

<ul class="children children-li children-sort-">
	
<li><a href="/artemis_crib/crib_parts/environment/index.html">Analysis environment</a></li>
<li><a href="/artemis_crib/crib_parts/onlinemode/index.html">Online-mode analysis</a></li>
<li><a href="/artemis_crib/crib_parts/userconfig/index.html">User config</a></li>
<li><a href="/artemis_crib/crib_parts/newcommand/index.html">New commands</a></li>
<li><a href="/artemis_crib/crib_parts/minor_change/index.html">Minor changes</a></li>
</ul>

            <footer class="footline">

            </footer>
          </article>

          <section>
            <h1 class="a11y-only">Subsections of CRIB Configuration</h1>
          <article class="default">
            <header class="headline">
            </header>
<h1 id="analysis-environment">Analysis environment</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-12-12 by Kodai Okawa</span></span>
<p>CRIB shares the analysis environment of all experiments under one user account (username crib).
Therefore, when you want to check data from an old experiment or when several people are analysing the data, you need to log in to the same user account.</p>
<p>Of course, the analysis environment varies according to the experiment (and even different environments for different users within the same experiment!) and these have to be managed well.
The &ldquo;.bashrc/.zshrc&rdquo; and &ldquo;artlogin (artlogin2)&rdquo; commands set them up.
Currently we are using &ldquo;zsh (.zshrc)&rdquo;.</p>
<h4 id="experimental-environment">Experimental environment</h4>

  
<div class="tab-panel" data-tab-group="6e1c20633d9b58b847940d5b3fdc7b6a">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="bashrczshrc"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('6e1c20633d9b58b847940d5b3fdc7b6a','bashrczshrc')"
    >
      <span>
        <span class="tab-nav-hidden">.bashrc/.zshrc</span>
        <span class="tab-nav-text">.bashrc/.zshrc</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="bashrczshrc"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">EXP_NAME</span><span class="o">=</span><span class="s2">&#34;current&#34;</span> <span class="c1"># your experiment</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">EXP_NAME_OLD</span><span class="o">=</span><span class="s2">&#34;previous&#34;</span> <span class="c1"># old experiment</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>The <code>EXP_NAME</code> is current experiment and you can enter the environment by using <code>artlogin</code> command.
At the same time, the <code>EXP_NAME_OLD</code> is the old experiment and you can use <code>artlogin2</code> command.</p>
<p>In the current version, we support two experimental environment and if you want to check other experimental data, please change <code>EXP_NAME_OLD</code>.</p>

<div class="box notices cstyle warning">
  <div class="box-label"><i class="fa-fw fas fa-exclamation-triangle"></i> Warning</div>
  <div class="box-content">

<p>When you modify &ldquo;.bashrc/.zshrc&rdquo;, all people&rsquo;s settings will change.
Therefore please do not change <code>EXP_NAME</code> as much as possible, because we want to set this environment variable as the active experiment.
If you change this, please report it so that CRIB members are aware of it.</p>
</div>
</div>

<div class="box notices cstyle info">
  <div class="box-label"><i class="fa-fw fas fa-info-circle"></i> Info</div>
  <div class="box-content">

<p>Commands may be created in the future to enter the environment of all experiments flexibly, not just two. (like artoldlogin {expname} {username}?)</p>
</div>
</div>
<p>Then you can enter the different analysis environment like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; artlogin <span class="o">(</span>username<span class="o">)</span>
</span></span><span class="line"><span class="cl">&gt; artlogin2 <span class="o">(</span>username<span class="o">)</span></span></span></code></pre></div><h4 id="user-environment">User environment</h4>
<p>CRIB uses a default user as well as individual analysis environments.
The username of the default user is the same with experiment name.</p>
<p>If you set the name of the experiment to &ldquo;si26a&rdquo; (<code>EXP_NAME</code>), then the username &ldquo;si26a&rdquo; will be the default user.
The user&rsquo;s environment can be entered with the &ldquo;artlogin&rdquo; command with no arguments.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; artlogin
</span></span><span class="line"><span class="cl">&gt; <span class="nb">pwd</span>
</span></span><span class="line"><span class="cl">/home/crib/art_analysis/si26a/si26a</span></span></code></pre></div><p>If you want to test something by changing files, or if you want to use your own VNC server, you can enter that environment by specifying its name as an argument.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; artlogin okawa <span class="c1"># if this is the first time to command, you will see setup comments.</span>
</span></span><span class="line"><span class="cl">&gt; <span class="nb">pwd</span>
</span></span><span class="line"><span class="cl">/home/crib/art_analysis/si26a/okawa</span></span></code></pre></div>
<div class="box notices cstyle warning">
  <div class="box-label"><i class="fa-fw fas fa-exclamation-triangle"></i> Warning</div>
  <div class="box-content">

<p>When using the default user, try to avoid using a VNC server (do not create .vncdisplay files).
The main reason for creating a default user is to analyse locally (for shifters) in the online analysis, and using a VNC server makes it impossible to view the figures locally.</p>
</div>
</div>
<h4 id="directory-structure">Directory structure</h4>
<p>The directory structure comprising artemis is as follows.
(The location of artemis itself is omitted).</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; tree -L <span class="m">2</span> ~/art_analysis
</span></span><span class="line"><span class="cl">/home/crib/art_analysis
</span></span><span class="line"><span class="cl">├── current <span class="c1"># accessed by &#34;artlogin&#34;</span>
</span></span><span class="line"><span class="cl">│   ├── current <span class="c1"># default user</span>
</span></span><span class="line"><span class="cl">│   └── okawa <span class="c1"># individual user</span>
</span></span><span class="line"><span class="cl">├── previous <span class="c1"># accessed by &#34;artlogin2&#34;</span>
</span></span><span class="line"><span class="cl">│   ├── previous
</span></span><span class="line"><span class="cl">│   └── okawa
</span></span><span class="line"><span class="cl">├── old1
</span></span><span class="line"><span class="cl">│   ├── old1
</span></span><span class="line"><span class="cl">│   └── okawa
</span></span><span class="line"><span class="cl">└── old2
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># -- snip --</span></span></span></code></pre></div>
            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
<div class="tags">
  <a class="tag-link" href="/artemis_crib/tags/crib/index.html">CRIB</a>
</div>
            </header>
<h1 id="online-mode-analysis">Online-mode analysis</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-12-12 by Kodai Okawa</span></span>
<p>We often use “nssta” (non-save mode start) analysis in the beam tuning.
It is not necessary to take data, but we need to check the beam condition by using artemis.
In this case, <code>TRIDFEventStore</code> can be used as online mode.</p>
<p>By default, if we don&rsquo;t add an input file name and set the SHMID (Shared Memory ID), artemis will use online mode.
However, it is necessary to use different types of steering files, one for use in online-mode and the other for use from a file, which can be complicated&hellip;</p>
<p>Therefore, the same steering file was changed to automatically go online mode when the ridf file was not present.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># from ridf files</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>0<span class="o">]</span> add steering/hoge.yaml <span class="nv">NAME</span><span class="o">=</span>hoge <span class="nv">NUM</span><span class="o">=</span><span class="m">0000</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># online-mode</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>0<span class="o">]</span> add steering/hoge.yaml <span class="c1"># no argument</span></span></span></code></pre></div><p>To achieve this, the original file was changed as follows.</p>

  
<div class="tab-panel" data-tab-group="857eeaa4b92ac80f83f2631ffce8c85e">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="artemissourcesloopridftridfeventstorecc"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('857eeaa4b92ac80f83f2631ffce8c85e','artemissourcesloopridftridfeventstorecc')"
    >
      <span>
        <span class="tab-nav-hidden">artemis/sources/loop/ridf/TRIDFEventStore.cc</span>
        <span class="tab-nav-text">artemis/sources/loop/ridf/TRIDFEventStore.cc</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="artemissourcesloopridftridfeventstorecc"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-diff" data-lang="diff"><span class="line"><span class="ln">129</span><span class="cl">    for (Int_t i=0; i!=n;i++) {
</span></span><span class="line"><span class="ln">130</span><span class="cl">       printf(&#34;file = %s\n&#34;,fFileName[i].Data());
</span></span><span class="line"><span class="ln">131</span><span class="cl"><span class="gi">+      if(!gSystem-&gt;FindFile(&#34;.&#34;, fFileName[i])) {
</span></span></span><span class="line"><span class="ln">132</span><span class="cl"><span class="gi">+         Info(&#34;Init&#34;, &#34;No input file -&gt; Online mode&#34;);
</span></span></span><span class="line"><span class="ln">133</span><span class="cl"><span class="gi">+         fIsOnline = kTRUE;
</span></span></span><span class="line"><span class="ln">134</span><span class="cl"><span class="gi">+      }
</span></span></span><span class="line"><span class="ln">135</span><span class="cl"><span class="gi"></span>    }
</span></span></code></pre></div></div>
    </div>
  </div>
</div><h4 id="steering-file">steering file</h4>
<p>We always use SHMID=0, so it works simply by adding the following sentence.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="w">   </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">ridf</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TRIDFEventStore</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="nt">OutputTransparency</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="nt">InputFiles</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span>- <span class="cp">*input</span><span class="w">
</span></span></span><span class="line hl"><span class="cl"><span class="w">       </span><span class="nt">SHMID</span><span class="p">:</span><span class="w"> </span><span class="m">0</span></span></span></code></pre></div>
            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
<div class="tags">
  <a class="tag-link" href="/artemis_crib/tags/crib/index.html">CRIB</a>
</div>
            </header>
<h1 id="user-config">User config</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2024-01-20 by Kodai Okawa</span></span>

<div class="box notices cstyle warning">
  <div class="box-label"><i class="fa-fw fas fa-exclamation-triangle"></i> Warning</div>
  <div class="box-content">

<p>still under consideration in this part!</p>
</div>
</div>
<p>CRIB often wants to customise artemis because it originally used ANAPAW and wants to perform analysis like ANAPAW.
However, we do not want to make too many changes to the source code of artemis itself, and we want to make it work in the user-defined part. (it means in the <strong>artemis work directory</strong>)</p>
<p>In particular, it is often the case that we want to create a new artemis command, but writing the command source on the work directory and registering it in <code>artemislogon.C</code> did not work somehow&hellip;</p>
<p>Also, artemislogon.C is automatically generated (from .artemislogon.C.in) by the cmake functionality, and even if this itself is changed, it will revert when cmake is redone.</p>
<p>Therefore, a file called <code>userlogon.C</code> was prepared, which only took out the user-defined part from artemislogon.C.
The following files have been modified to read this.</p>

  
<div class="tab-panel" data-tab-group="21a8b55a101b7b7ce0b87d56daadadf6">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="artemissourcesmaintartrintcc"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('21a8b55a101b7b7ce0b87d56daadadf6','artemissourcesmaintartrintcc')"
    >
      <span>
        <span class="tab-nav-hidden">artemis/sources/main/TArtRint.cc</span>
        <span class="tab-nav-text">artemis/sources/main/TArtRint.cc</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="artemissourcesmaintartrintcc"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-diff" data-lang="diff"><span class="line"><span class="ln">14</span><span class="cl"> #include &lt;TInterpreter.h&gt;
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="gi">+#include &lt;TSystem.h&gt;
</span></span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="gi"></span> #include &#34;TLoopManager.h&#34;
</span></span></code></pre></div></div>
    </div>
  </div>
</div>
  
<div class="tab-panel" data-tab-group="e0468ed62d73f99064d55b82dc2683c2">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="artemissourcesmaintartrintcc"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('e0468ed62d73f99064d55b82dc2683c2','artemissourcesmaintartrintcc')"
    >
      <span>
        <span class="tab-nav-hidden">artemis/sources/main/TArtRint.cc</span>
        <span class="tab-nav-text">artemis/sources/main/TArtRint.cc</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="artemissourcesmaintartrintcc"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-diff" data-lang="diff"><span class="line"><span class="ln">44</span><span class="cl">    TRint::ProcessLine(&#34;.x artemislogon.C&#34;);
</span></span><span class="line"><span class="ln">45</span><span class="cl"><span class="gi">+   FileStat_t info;
</span></span></span><span class="line"><span class="ln">46</span><span class="cl"><span class="gi">+   if (gSystem-&gt;GetPathInfo(&#34;userlogon.C&#34;, info)==0) {
</span></span></span><span class="line"><span class="ln">47</span><span class="cl"><span class="gi">+      TRint::ProcessLine(&#34;.x userlogon.C&#34;);
</span></span></span><span class="line"><span class="ln">48</span><span class="cl"><span class="gi">+   }
</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>If there is a <code>userlogon.C</code> file in the work directory, it is loaded, otherwise artemis can be used as usual.</p>
<h3 id="userlogonc">userlogon.C</h3>
<p>This file can be used freely!
What we wanted to do most is to register user-defined commands, which can be done as follows.</p>

  
<div class="tab-panel" data-tab-group="0fc690acba140b6aa37099c66ead9e10">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="userlogonc"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('0fc690acba140b6aa37099c66ead9e10','userlogonc')"
    >
      <span>
        <span class="tab-nav-hidden">userlogon.C</span>
        <span class="tab-nav-text">userlogon.C</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="userlogonc"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="c1">// load user function
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="n">gROOT</span><span class="o">-&gt;</span><span class="n">ProcessLine</span><span class="p">(</span><span class="s">&#34;.L macro/UserUtil.C&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="c1">// User commands register
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="c1">// cf definition: TCatCmdFactory *cf = TCatCmdFactory::Instance();
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="n">cf</span><span class="o">-&gt;</span><span class="n">Register</span><span class="p">(</span><span class="n">TCatCmdLoopStart</span><span class="o">::</span><span class="n">Instance</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">   <span class="n">cf</span><span class="o">-&gt;</span><span class="n">Register</span><span class="p">(</span><span class="n">TCatCmdLoopStop</span><span class="o">::</span><span class="n">Instance</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">   <span class="n">cf</span><span class="o">-&gt;</span><span class="n">Register</span><span class="p">(</span><span class="k">new</span> <span class="n">art</span><span class="o">::</span><span class="n">TCmdXfitg</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">   <span class="n">cf</span><span class="o">-&gt;</span><span class="n">Register</span><span class="p">(</span><span class="k">new</span> <span class="n">art</span><span class="o">::</span><span class="n">TCmdXstatus</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">   <span class="n">cf</span><span class="o">-&gt;</span><span class="n">Register</span><span class="p">(</span><span class="k">new</span> <span class="n">art</span><span class="o">::</span><span class="n">TCmdXYblow</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">   <span class="n">cf</span><span class="o">-&gt;</span><span class="n">Register</span><span class="p">(</span><span class="k">new</span> <span class="n">art</span><span class="o">::</span><span class="n">TCmdXblow</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">   <span class="n">cf</span><span class="o">-&gt;</span><span class="n">Register</span><span class="p">(</span><span class="n">TCatCmdTCutG</span><span class="o">::</span><span class="n">Instance</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">   <span class="n">cf</span><span class="o">-&gt;</span><span class="n">Register</span><span class="p">(</span><span class="k">new</span> <span class="n">art</span><span class="o">::</span><span class="n">TCmdErase</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">   <span class="n">cf</span><span class="o">-&gt;</span><span class="n">Register</span><span class="p">(</span><span class="k">new</span> <span class="n">art</span><span class="o">::</span><span class="n">TCmdDraw</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="c1">// TTree merge setting
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   <span class="n">TTree</span><span class="o">::</span><span class="n">SetMaxTreeSize</span><span class="p">(</span> <span class="mi">1000000000000LL</span> <span class="p">);</span> <span class="c1">// 1TB
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>The first line <code>gROOT-&gt;ProcessLine(&quot;.L macro/UserUtil.C&quot;)</code> load the user definition function.
You can add any function to the &ldquo;macro/UserUtil.C&rdquo; file, and the function to load TCutG object in &ldquo;/gate/*.root&rdquo; directory is written defaultly.
For more detail, please see <a href="/artemis_crib/crib_parts/userconfig/./newcommand">tcutg command</a> and <a href="/artemis_crib/crib_parts/userconfig/../../example/online_analysis/gate">gate</a> pages.</p>
<p>(For some reason, an error occurred when writing in artemislogon.C.)
You can also customise it in other ways to make it easier for you. For example, when creating a TTree, a setting to increase the file size limit is also included by default.</p>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
<div class="tags">
  <a class="tag-link" href="/artemis_crib/tags/crib/index.html">CRIB</a>
</div>
            </header>
<h1 id="new-commands">New commands</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2024-01-20 by Kodai Okawa</span></span>
<p>Various commands (mainly the same with ANAPAW commands) have been developed for CRIB experiment.
For more information, please click <a href="https://github.com/okawak/artemis_crib/tree/main/src-crib/commands" target="_blank">here (src-crib/commands)</a>.
These commands are registered in userlogon.C. (See previous section.)</p>
<p>This section explains how to use them.</p>
<ul>
<li>start</li>
<li>stop</li>
<li>xfitg</li>
<li>xblow</li>
<li>xyblow</li>
<li>xstatus</li>
<li>tcutg</li>
<li>erase</li>
<li>draw</li>
</ul>
<p>the default figures:
<figure><img src="/artemis_crib/crib_parts/newcommand/default.png" width="1000"/>
</figure>
</p>
<h3 id="start">start</h3>
<p>This is exactly the same as the <code>resume</code> command, because ANAPAW starts the event loop with <code>start</code> instead of resume.</p>
<h3 id="stop">stop</h3>
<p>This is exactly the same as the <code>suspend</code> command, because ANAPAW stops the event loop with <code>stop</code> instead of suspend.</p>
<h3 id="xfitg">xfitg</h3>
<p>For <code>1D</code> histograms, by selecting the two ends of two points, the peak between them is fitted with a Gaussian.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>7<span class="o">]</span> xf
</span></span><span class="line"><span class="cl">Info in &lt;art::TCmdXfitg::Cmd&gt;: click on the lowest edge:
</span></span><span class="line"><span class="cl">Info in &lt;art::TCmdXfitg::Cmd&gt;: click on the highest edge:
</span></span><span class="line"><span class="cl">Info in &lt;art::TCmdXfitg::Cmd&gt;: X1: -1437.56, X2: -1419.11
</span></span><span class="line"><span class="cl"> <span class="nv">FCN</span><span class="o">=</span>81.6642 FROM MIGRAD    <span class="nv">STATUS</span><span class="o">=</span>CONVERGED      <span class="m">71</span> CALLS          <span class="m">72</span> TOTAL
</span></span><span class="line"><span class="cl">                     <span class="nv">EDM</span><span class="o">=</span>3.35095e-09    <span class="nv">STRATEGY</span><span class="o">=</span> <span class="m">1</span>      ERROR MATRIX ACCURATE
</span></span><span class="line"><span class="cl">  EXT PARAMETER                                   STEP         FIRST
</span></span><span class="line"><span class="cl">  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE
</span></span><span class="line"><span class="cl">   <span class="m">1</span>  Constant     1.16439e+03   2.43862e+01   8.08454e-02   9.04256e-07
</span></span><span class="line"><span class="cl">   <span class="m">2</span>  Mean        -1.43081e+03   4.54001e-02   6.82262e-04  -1.74034e-03
</span></span><span class="line"><span class="cl">   <span class="m">3</span>  Sigma        2.81435e+00   4.07888e-02   1.55351e-05  -3.15946e-03
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>8<span class="o">]</span></span></span></code></pre></div><figure><img src="/artemis_crib/crib_parts/newcommand/xfitg.png" width="600"/>
</figure>

<h3 id="xblow">xblow</h3>
<p>For <code>1D</code> histograms, select both ends and crop the histogram between them.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>10<span class="o">]</span> xblo
</span></span><span class="line"><span class="cl">Info in &lt;art::TCmdXblow::Run&gt;: click on the lowest edge: 
</span></span><span class="line"><span class="cl">Info in &lt;art::TCmdXblow::Run&gt;: click on the highest edge: 
</span></span><span class="line"><span class="cl">Info in &lt;art::TCmdXblow::Run&gt;: X1: -1439.3, X2: -1417.37
</span></span><span class="line"><span class="cl">Info in &lt;art::TCmdXblow::Run&gt;: <span class="nv">id</span> <span class="o">=</span> <span class="m">2</span> hist is created
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>11<span class="o">]</span></span></span></code></pre></div><figure><img src="/artemis_crib/crib_parts/newcommand/xblow.png" width="600"/>
</figure>

<h3 id="xyblow">xyblow</h3>
<p>For <code>2D</code> histograms, select both corners and crop the histogram between them.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>60<span class="o">]</span> xyblo
</span></span><span class="line"><span class="cl">Info in &lt;art::TCmdXYblow::Run&gt;: click on one corner: 
</span></span><span class="line"><span class="cl">Info in &lt;art::TCmdXYblow::Run&gt;: X1: 9.2154, Y1: 46.6159
</span></span><span class="line"><span class="cl">Info in &lt;art::TCmdXYblow::Run&gt;: click on the other corner: 
</span></span><span class="line"><span class="cl">Info in &lt;art::TCmdXYblow::Run&gt;: X2: 21.7032, Y2: 23.952
</span></span><span class="line"><span class="cl">Info in &lt;art::TCmdXYblow::Run&gt;: <span class="nv">id</span> <span class="o">=</span> <span class="m">6</span> hist is created
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>61<span class="o">]</span></span></span></code></pre></div><figure><img src="/artemis_crib/crib_parts/newcommand/xyblow.png" width="600"/>
</figure>

<h3 id="xstatus">xstatus</h3>
<p>For <code>2D</code> histograms, select both corners and determine the ratio of the total number of events.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>8<span class="o">]</span> xs
</span></span><span class="line"><span class="cl">Info in &lt;art::TCmdXstatus::Cmd&gt;: click on one corner: 
</span></span><span class="line"><span class="cl">Info in &lt;art::TCmdXstatus::Cmd&gt;: X1: 14.1496, Y1: 41.4826
</span></span><span class="line"><span class="cl">Info in &lt;art::TCmdXstatus::Cmd&gt;: click on the other corner: 
</span></span><span class="line"><span class="cl">Info in &lt;art::TCmdXstatus::Cmd&gt;: X2: 21.0941, Y2: 31.9909
</span></span><span class="line"><span class="cl">------------------
</span></span><span class="line"><span class="cl"><span class="nv">selected</span> <span class="o">=</span> 976, <span class="nv">total</span> <span class="o">=</span> <span class="m">7526</span>
</span></span><span class="line"><span class="cl"><span class="nv">ratio</span>  <span class="o">=</span> 0.129684 <span class="o">(</span>12.9684%<span class="o">)</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>9<span class="o">]</span></span></span></code></pre></div><figure><img src="/artemis_crib/crib_parts/newcommand/xstatus.png" width="600"/>
</figure>

<h3 id="tcutg">tcutg</h3>
<p>For <code>2D</code> histograms, this command create TCutG object and store in a ROOT file.
If you select to save the object, the file will place to the <code>gate/*.root</code> directory.
There objects are automatically loaded. (please check <a href="/artemis_crib/crib_parts/newcommand/./userconfig">user config</a> page.)</p>
<p>This is the example how to use this command.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[]</span> ht something
</span></span><span class="line"><span class="cl">artemis <span class="o">[]</span> tc
</span></span><span class="line"><span class="cl">Info in &lt;TCatCmdTCutG::Cmd&gt;: Xaxis name : f2ppac.fX  Yaxis name : f2ppac.fY
</span></span><span class="line"><span class="cl">Info in &lt;TCatCmdTCutG::Cmd&gt;: When you have finished specifying the area <span class="o">(</span>last point<span class="o">)</span>, double-click on it.
</span></span><span class="line"><span class="cl">Info in &lt;TCatCmdTCutG::Cmd&gt;: <span class="o">(</span>x, y<span class="o">)</span> <span class="o">=</span> <span class="o">(</span>9.050404, 10.301410<span class="o">)</span>
</span></span><span class="line"><span class="cl">Info in &lt;TCatCmdTCutG::Cmd&gt;: <span class="o">(</span>x, y<span class="o">)</span> <span class="o">=</span> <span class="o">(</span>5.047341, -8.294592<span class="o">)</span>
</span></span><span class="line"><span class="cl">Info in &lt;TCatCmdTCutG::Cmd&gt;: <span class="o">(</span>x, y<span class="o">)</span> <span class="o">=</span> <span class="o">(</span>-12.183236, -3.839300<span class="o">)</span>
</span></span><span class="line"><span class="cl">Info in &lt;TCatCmdTCutG::Cmd&gt;: <span class="o">(</span>x, y<span class="o">)</span> <span class="o">=</span> <span class="o">(</span>3.306878, -15.074384<span class="o">)</span>
</span></span><span class="line"><span class="cl">Info in &lt;TCatCmdTCutG::Cmd&gt;: <span class="o">(</span>x, y<span class="o">)</span> <span class="o">=</span> <span class="o">(</span>-3.306878, -32.120720<span class="o">)</span>
</span></span><span class="line"><span class="cl">Info in &lt;TCatCmdTCutG::Cmd&gt;: <span class="o">(</span>x, y<span class="o">)</span> <span class="o">=</span> <span class="o">(</span>9.920635, -15.461801<span class="o">)</span>
</span></span><span class="line"><span class="cl">Info in &lt;TCatCmdTCutG::Cmd&gt;: <span class="o">(</span>x, y<span class="o">)</span> <span class="o">=</span> <span class="o">(</span>18.274854, -29.989928<span class="o">)</span>
</span></span><span class="line"><span class="cl">Info in &lt;TCatCmdTCutG::Cmd&gt;: <span class="o">(</span>x, y<span class="o">)</span> <span class="o">=</span> <span class="o">(</span>16.186299, -11.200217<span class="o">)</span>
</span></span><span class="line"><span class="cl">Info in &lt;TCatCmdTCutG::Cmd&gt;: <span class="o">(</span>x, y<span class="o">)</span> <span class="o">=</span> <span class="o">(</span>35.157338, -4.420425<span class="o">)</span>
</span></span><span class="line"><span class="cl">Info in &lt;TCatCmdTCutG::Cmd&gt;: <span class="o">(</span>x, y<span class="o">)</span> <span class="o">=</span> <span class="o">(</span>14.271791, -4.807841<span class="o">)</span>
</span></span><span class="line"><span class="cl">Info in &lt;TCatCmdTCutG::Cmd&gt;: <span class="o">(</span>x, y<span class="o">)</span> <span class="o">=</span> <span class="o">(</span>10.964912, 9.332869<span class="o">)</span>
</span></span><span class="line"><span class="cl">Info in &lt;TCatCmdTCutG::Cmd&gt;: <span class="o">(</span>x, y<span class="o">)</span> <span class="o">=</span> <span class="o">(</span>10.964912, 9.332869<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> you want to save it, input the TCutG name <span class="o">[</span>name/exit<span class="o">]</span> f2star
</span></span><span class="line"><span class="cl">Info in &lt;TCatCmdTCutG::Cmd&gt;: Created gate/f2star.root</span></span></code></pre></div><figure><img src="/artemis_crib/crib_parts/newcommand/tcutg_raw.png" width="600"/>
</figure>

<p>To select an area, click on the vertices of the area you want to select, then double-click at the last vertex.
If you want to save this object, enter the &ldquo;cut&rdquo; name.
In this example, I input the <code>f2star</code> as the object name.
If you don&rsquo;t want to save, enter &ldquo;exit&rdquo;.</p>
<p>Then the <code>gate/f2star.root</code> will be created.
And after reload the artemis, the gate will be loaded automatically and we can use histogram definition and &ldquo;tree-&gt;Draw&rdquo; selection part.
For the detail please check <a href="/artemis_crib/crib_parts/newcommand/../../example/online_analysis/gate">gate</a> page.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[]</span> tree-&gt;Draw<span class="o">(</span><span class="s2">&#34;f2ppac.fY:f2ppac.fX&gt;&gt;(200,-50.,50., 200,-50.,50.)&#34;</span>,<span class="s2">&#34;f2star&#34;</span>,<span class="s2">&#34;colz&#34;</span><span class="o">)</span></span></span></code></pre></div><figure><img src="/artemis_crib/crib_parts/newcommand/tcutg.png" width="600"/>
</figure>

<hr>
<h2 id="---under-development---">&mdash;under development&mdash;</h2>
<h3 id="erase">erase</h3>
<h3 id="draw">draw</h3>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
<div class="tags">
  <a class="tag-link" href="/artemis_crib/tags/crib/index.html">CRIB</a>
</div>
            </header>
<h1 id="minor-changes">Minor changes</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2024-01-11 by Kodai Okawa</span></span>
<h3 id="thisartemisshin">thisartemis.sh.in</h3>
<p>Grammar issue I think.</p>

  
<div class="tab-panel" data-tab-group="371f2fb8a5021ba92479a5b5e5b2fe7a">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="artemissourcesmainthisartemisshin"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('371f2fb8a5021ba92479a5b5e5b2fe7a','artemissourcesmainthisartemisshin')"
    >
      <span>
        <span class="tab-nav-hidden">artemis/sources/main/thisartemis.sh.in</span>
        <span class="tab-nav-text">artemis/sources/main/thisartemis.sh.in</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="artemissourcesmainthisartemisshin"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-diff" data-lang="diff"><span class="line"><span class="cl"> export LD_LIBRARY_PATH=$TARTSYS/lib:$LD_LIBRARY_PATH
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gd">-if [ &#34;@BUILD_GET@&#34; == &#34;ON&#34; ]; then
</span></span></span><span class="line"><span class="cl"><span class="gd"></span><span class="gi">+if [[ &#34;@BUILD_GET@&#34; == &#34;ON&#34; ]]; then
</span></span></span><span class="line"><span class="cl"><span class="gi"></span>     export LD_LIBRARY_PATH=@GET_LIB_DIR@:$LD_LIBRARY_PATH
</span></span><span class="line"><span class="cl"> fi
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gd">-if [ &#34;@MPI_CXX_FOUND@&#34; == &#34;TRUE&#34; ]; then
</span></span></span><span class="line"><span class="cl"><span class="gd"></span><span class="gi">+if [[ &#34;@MPI_CXX_FOUND@&#34; == &#34;TRUE&#34; ]]; then
</span></span></span><span class="line"><span class="cl"><span class="gi"></span>     dir=@MPI_CXX_LIBRARIES@
</span></span><span class="line"><span class="cl">     libdir=&#34;$(dirname $dir)&#34;
</span></span></code></pre></div></div>
    </div>
  </div>
</div><h3 id="xval-command">xval command</h3>
<p>Add cross hair.</p>

  
<div class="tab-panel" data-tab-group="1929215bbab2650a20311d54e078752f">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="artemissourcescommandstcatcmdxvalcc"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('1929215bbab2650a20311d54e078752f','artemissourcescommandstcatcmdxvalcc')"
    >
      <span>
        <span class="tab-nav-hidden">artemis/sources/commands/TCatCmdXval.cc</span>
        <span class="tab-nav-text">artemis/sources/commands/TCatCmdXval.cc</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="artemissourcescommandstcatcmdxvalcc"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-diff" data-lang="diff"><span class="line"><span class="ln">84</span><span class="cl"> void TCatCmdXval::GetEvent()
</span></span><span class="line"><span class="ln">85</span><span class="cl"> {
</span></span><span class="line"><span class="ln">86</span><span class="cl"><span class="gi">+   dynamic_cast&lt;TPad *&gt;(gPad)-&gt;DrawCrosshair();
</span></span></span><span class="line"><span class="ln">87</span><span class="cl"><span class="gi"></span>    const int event = gPad-&gt;GetEvent();
</span></span></code></pre></div></div>
    </div>
  </div>
</div><figure><img src="/artemis_crib/crib_parts/minor_change/crosshair.png" width="600"/>
</figure>

<h3 id="pr-projection-command">pr (projection) command</h3>
<p>After the command, the projected histogram will automatically be displayed.</p>

  
<div class="tab-panel" data-tab-group="c04b1df94e6f63b456f2f8b25e304081">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="artemissourcescommandstcatcmdprcc"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('c04b1df94e6f63b456f2f8b25e304081','artemissourcescommandstcatcmdprcc')"
    >
      <span>
        <span class="tab-nav-hidden">artemis/sources/commands/TCatCmdPr.cc</span>
        <span class="tab-nav-text">artemis/sources/commands/TCatCmdPr.cc</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="artemissourcescommandstcatcmdprcc"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-diff" data-lang="diff"><span class="line"><span class="ln">55</span><span class="cl">       if (!obj-&gt;InheritsFrom(TH2::Class())) {
</span></span><span class="line"><span class="ln">56</span><span class="cl">          // TArtCore::Info(&#34;TCatCmdPr::Run&#34;,&#34;%s is not 2D histogram&#34;,
</span></span><span class="line"><span class="ln">57</span><span class="cl">          //               obj-&gt;GetName());
</span></span><span class="line"><span class="ln">58</span><span class="cl"><span class="gi">+        Info(&#34;Run&#34;, &#34;%s is not 2D histogram&#34;, obj-&gt;GetName());
</span></span></span><span class="line"><span class="ln">59</span><span class="cl"><span class="gi"></span>          continue;
</span></span><span class="line"><span class="ln">60</span><span class="cl">       }
</span></span><span class="line"><span class="ln">61</span><span class="cl"><span class="gi">+      Int_t nid = (gDirectory-&gt;GetList())-&gt;GetEntries();
</span></span></span><span class="line"><span class="ln">62</span><span class="cl"><span class="gi"></span>       Run((TH2*) obj, opt);
</span></span><span class="line"><span class="ln">63</span><span class="cl"><span class="gi">+      Info(&#34;Run&#34;, &#34;id = %d hist is created&#34;, nid);
</span></span></span><span class="line"><span class="ln">64</span><span class="cl"><span class="gi">+      TCatHistManager::Instance()-&gt;DrawObject(nid);
</span></span></span><span class="line"><span class="ln">65</span><span class="cl"><span class="gi"></span>    }
</span></span><span class="line"><span class="ln">66</span><span class="cl">    return 1;
</span></span><span class="line"><span class="ln">67</span><span class="cl"> }
</span></span></code></pre></div></div>
    </div>
  </div>
</div><h3 id="tmoduleinfo-class">TModuleInfo class</h3>
<p>In the CRIB processor, there is a processor that inherits from TModuleInfo, <a href="https://github.com/okawak/artemis_crib/blob/main/src-crib/TModuleData.h" target="_blank">TModuleData</a>.
In the constractor of this class use <code>copy constractor</code> of TModuleInfo, but the default artemis doesn&rsquo;t implement it.
This class is used when we want to check the raw data.
For the detail, please see <a href="https://okawak.github.io/artemis_crib/example/online_analysis/check_rawdata/index.html" target="_blank">check raw data page</a>.</p>
<p>Therefore, we modified this like this:</p>

  
<div class="tab-panel" data-tab-group="c8a55c988e5c1c5e9648af1ff16a4750">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="artemissourceslooptmoduleinfocc"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('c8a55c988e5c1c5e9648af1ff16a4750','artemissourceslooptmoduleinfocc')"
    >
      <span>
        <span class="tab-nav-hidden">artemis/sources/loop/TModuleInfo.cc</span>
        <span class="tab-nav-text">artemis/sources/loop/TModuleInfo.cc</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="artemissourceslooptmoduleinfocc"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-diff" data-lang="diff"><span class="line"><span class="ln">31</span><span class="cl">  TModuleInfo::TModuleInfo(const TModuleInfo&amp; rhs)
</span></span><span class="line"><span class="ln">32</span><span class="cl"><span class="gi">+   : TParameterObject(rhs),
</span></span></span><span class="line"><span class="ln">33</span><span class="cl"><span class="gi">+   fID(rhs.fID),
</span></span></span><span class="line"><span class="ln">34</span><span class="cl"><span class="gi">+   fType(rhs.fType),
</span></span></span><span class="line"><span class="ln">35</span><span class="cl"><span class="gi">+   fHists(nullptr)
</span></span></span><span class="line"><span class="ln">36</span><span class="cl"><span class="gi"></span>  {
</span></span><span class="line"><span class="ln">37</span><span class="cl"><span class="gi">+   if (rhs.fHist) {
</span></span></span><span class="line"><span class="ln">38</span><span class="cl"><span class="gi">+     fHists = new TObjArray(*(rhs.fHists));
</span></span></span><span class="line"><span class="ln">39</span><span class="cl"><span class="gi">+   }
</span></span></span><span class="line"><span class="ln">40</span><span class="cl"><span class="gi">+
</span></span></span><span class="line"><span class="ln">41</span><span class="cl"><span class="gi">+   fRanges = rhs.fRanges;
</span></span></span><span class="line"><span class="ln">42</span><span class="cl"><span class="gi"></span>  }
</span></span></code></pre></div></div>
    </div>
  </div>
</div><!-- raw HTML omitted -->
<!-- raw HTML omitted -->

            <footer class="footline">

            </footer>
          </article>

          </section>
          <article class="chapter">
            <header class="headline">
            </header>
<div class="article-subheading">Chapter 4</div>
<h1 id="example">Example</h1>

<p>Up to now, we have introduced the installation and concepts of artemis.
This chapter will show you how to analyse with artemis through practical examples; if you want to know how to use artemis, it is no problem to start reading from here.</p>

<ul class="children children-li children-sort-">
	
<li><a href="/artemis_crib/example/preparation/index.html">Preparation</a><ul>
	
<li><a href="/artemis_crib/example/preparation/basic/index.html">Basic</a></li>
<li><a href="/artemis_crib/example/preparation/tref/index.html">Tref for V1190</a></li>
<li><a href="/artemis_crib/example/preparation/ppac_calibration/index.html">PPAC calibration</a></li>
<li><a href="/artemis_crib/example/preparation/mwdc_calibration/index.html">MWDC calibration</a></li>
<li><a href="/artemis_crib/example/preparation/alpha_calibration/index.html">Alpha calibration</a></li>
<li><a href="/artemis_crib/example/preparation/mux_calibration/index.html">MUX calibration</a></li>
<li><a href="/artemis_crib/example/preparation/set_parameter/index.html">Set parameters</a></li>
<li><a href="/artemis_crib/example/preparation/git/index.html">Git</a></li></ul></li>
<li><a href="/artemis_crib/example/online_analysis/index.html">Online analysis</a><ul>
	
<li><a href="/artemis_crib/example/online_analysis/f1/index.html">F1</a></li>
<li><a href="/artemis_crib/example/online_analysis/pid/index.html">Beam PID</a></li>
<li><a href="/artemis_crib/example/online_analysis/f2/index.html">F2</a></li>
<li><a href="/artemis_crib/example/online_analysis/ppac/index.html">PPAC</a></li>
<li><a href="/artemis_crib/example/online_analysis/mwdc/index.html">MWDC</a></li>
<li><a href="/artemis_crib/example/online_analysis/telescope/index.html">Telescope</a></li>
<li><a href="/artemis_crib/example/online_analysis/f3/index.html">F3</a></li>
<li><a href="/artemis_crib/example/online_analysis/gate/index.html">Gate</a></li>
<li><a href="/artemis_crib/example/online_analysis/shift/index.html">Shifter task</a></li>
<li><a href="/artemis_crib/example/online_analysis/scaler/index.html">Scaler</a></li>
<li><a href="/artemis_crib/example/online_analysis/timestamp/index.html">Timestamp</a></li>
<li><a href="/artemis_crib/example/online_analysis/check_rawdata/index.html">Raw data checker</a></li></ul></li>
<li><a href="/artemis_crib/example/offline_analysis/index.html">Offline analysis</a><ul>
	
<li><a href="/artemis_crib/example/offline_analysis/new_processor/index.html">New processors</a></li>
<li><a href="/artemis_crib/example/offline_analysis/merge_files/index.html">Merge files</a></li>
<li><a href="/artemis_crib/example/offline_analysis/python_environment/index.html">Python environment</a></li>
<li><a href="/artemis_crib/example/offline_analysis/pyroot/index.html">pyROOT</a></li></ul></li>
<li><a href="/artemis_crib/example/simulation/index.html">MC Simulation</a><ul>
	
<li><a href="/artemis_crib/example/simulation/beam_generator/index.html">Beam_generator</a></li>
<li><a href="/artemis_crib/example/simulation/nbodyreaction/index.html">Nbodyreaction</a></li>
<li><a href="/artemis_crib/example/simulation/geometry/index.html">Geometry</a></li>
<li><a href="/artemis_crib/example/simulation/detect_particle/index.html">Detect_particle</a></li>
<li><a href="/artemis_crib/example/simulation/solidangle/index.html">Solidangle</a></li></ul></li>
</ul>

            <footer class="footline">

            </footer>
          </article>

          <section>
            <h1 class="a11y-only">Subsections of Example</h1>
          <article class="default">
            <header class="headline">
            </header>
<h1 id="preparation">Preparation</h1>

<p>This section explain the example of preparation by using some useful macro.</p>

<ul class="children children-li children-sort-weight">
	
<li><a href="/artemis_crib/example/preparation/basic/index.html">Basic</a></li>
<li><a href="/artemis_crib/example/preparation/tref/index.html">Tref for V1190</a></li>
<li><a href="/artemis_crib/example/preparation/ppac_calibration/index.html">PPAC calibration</a></li>
<li><a href="/artemis_crib/example/preparation/mwdc_calibration/index.html">MWDC calibration</a></li>
<li><a href="/artemis_crib/example/preparation/alpha_calibration/index.html">Alpha calibration</a></li>
<li><a href="/artemis_crib/example/preparation/mux_calibration/index.html">MUX calibration</a></li>
<li><a href="/artemis_crib/example/preparation/set_parameter/index.html">Set parameters</a></li>
<li><a href="/artemis_crib/example/preparation/git/index.html">Git</a></li>
</ul>

            <footer class="footline">

            </footer>
          </article>

          <section>
            <h1 class="a11y-only">Subsections of Preparation</h1>
          <article class="default">
            <header class="headline">
            </header>
<h1 id="basic">Basic</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-12-13 by Kodai Okawa</span></span>
<p>I would now like to introduce the actual analysis using the CRIB analysis server.
There are two ways to enter the analysis server, directly or remotely via ssh.
If you come to CRIB and operate the server directly, I think it is quicker to analyse using the server
while asking the CRIB members directly as I think they are nearby.</p>
<h3 id="1-ssh-configuration">1. SSH configuration</h3>
<p>To enter the CRIB server, you need to enter the CNS network.
To do this, you need to create an account on the CNS login server.
Please contact Okawa (<a href="mailto:okawa@cns.s.u-tokyo.ac.jp">okawa@cns.s.u-tokyo.ac.jp</a>) or the person responsible for CRIB <a href="https://www.cns.s.u-tokyo.ac.jp/crib/crib-new/home-en/index.html" target="_blank">(see here)</a> and tell us that you want a login server account.</p>
<p>The CNS login server uses public key cryptography, so you need to send a shared key when you apply.
This section describes how to create the key, especially on MacOS.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">cd</span> <span class="c1"># move to /Users/yourname/ (home directory)</span>
</span></span><span class="line"><span class="cl">mkdir .ssh <span class="c1"># if there is no .ssh directory</span>
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> .ssh
</span></span><span class="line"><span class="cl">ssh-keygen</span></span></code></pre></div><p>You will be asked a number of interactive questions after this command, all of which are fine by default (Enter).
Then you will see the pair of public-key and private-key.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">ls 
</span></span><span class="line"><span class="cl">id_rsa  id_rsa.pub</span></span></code></pre></div><p><code>id_rsa</code> is the private-key, and <code>id_rsa.pub</code> is the public-key.
The private key is important for security reasons and should be kept on your own computer.
Then, please send this public-key to the CNS member.
in MacOS, <code>open .</code> command will open a finder for that directory, so it is easy to attach it to an email from here.
In the email,</p>
<ul>
<li>your fullname (affiliation)</li>
<li>username</li>
<li>attached public-key</li>
</ul>
<p>are needed.</p>
<p>Next, let&rsquo;s set up multi-stage ssh.
As the login server is just a jump server, it is useful to be able to ssh to the CRIB analysis server at once!
So create the following config file. The file placed in this directory is automatically read when you ssh.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">cd</span> ~/.ssh
</span></span><span class="line"><span class="cl">vi config</span></span></code></pre></div>
  
<div class="tab-panel" data-tab-group="92aeef760b6a386e9d57e50af060a0fe">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="sshconfig"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('92aeef760b6a386e9d57e50af060a0fe','sshconfig')"
    >
      <span>
        <span class="tab-nav-hidden">~/.ssh/config</span>
        <span class="tab-nav-text">~/.ssh/config</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="sshconfig"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-aconf" data-lang="aconf"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="nb">Host</span> login
</span></span><span class="line hl"><span class="ln"> 2</span><span class="cl">    <span class="nb">HostName</span> CNS_loginserver_hostname
</span></span><span class="line hl"><span class="ln"> 3</span><span class="cl">    <span class="nb">User</span> username
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    <span class="nb">IdentityFile</span> ~/.ssh/id_rsa
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">    <span class="nb">ForWardX11Timeout</span> <span class="m">24</span>h
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    <span class="nb">ControlPersist</span> <span class="m">30</span>m
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    <span class="nb">ForwardAgent</span> yes
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">    <span class="nb">ControlMaster</span> auto
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    <span class="nb">ControlPath</span> ~/.ssh/mux-%r@%h:%p
</span></span><span class="line"><span class="ln">10</span><span class="cl">
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="c"># any name is okay</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="nb">Host</span> cribana
</span></span><span class="line hl"><span class="ln">13</span><span class="cl">    <span class="nb">HostName</span> analysisPC_hostname
</span></span><span class="line"><span class="ln">14</span><span class="cl">    <span class="nb">User</span> crib
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="nb">IdentityFile</span> ~/.ssh/id_rsa
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="nb">ProxyCommand</span> ssh login nc %h %p
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="nb">ForwardAgent</span> yes
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="nb">ControlMaster</span> auto
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="nb">ControlPath</span> ~/.ssh/mux-%r@%h:%p
</span></span><span class="line"><span class="ln">20</span><span class="cl">    <span class="nb">ControlPersist</span> <span class="m">30</span>m</span></span></code></pre></div></div>
    </div>
  </div>
</div><p>You will be informed of the second and third lines above that we highlighted, so please change this parts.
And ask the IP address of the CRIB analysis PC to the CRIB member, and change the 13 line.</p>
<p>Then you can enter the CRIB analysis PC just by</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">ssh cribana</span></span></code></pre></div><p>CRIB member will tell you the passward!</p>
<p>For the VNC server (local forwarding), please see <a href="https://okawak.github.io/artemis_crib/setting/vncserver/index.html" target="_blank">this section</a>.</p>
<h3 id="2-your-artemis-configuration">2. your artemis configuration</h3>
<p>When you enter the CRIB computer, please check this is <code>zsh</code> shell.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; <span class="nb">echo</span> <span class="nv">$SHELL</span>
</span></span><span class="line"><span class="cl">/usr/local/bin/zsh</span></span></code></pre></div>
<div class="box notices cstyle info">
  <div class="box-label"><i class="fa-fw fas fa-info-circle"></i> Info</div>
  <div class="box-content">

<p>Currently, zsh installed locally is used. It is planned to update the OS in the future, after which it will differ from this path in the future.</p>
</div>
</div>
<p>If it is not <code>zsh</code> (like bash), please command</p>
<div class="wrap-code highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; zsh</span></span></code></pre></div><p>Then you can start to configure by</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; artlogin yourname
</span></span><span class="line"><span class="cl"><span class="c1"># input your information...</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&gt; mkdir build
</span></span><span class="line"><span class="cl">&gt; <span class="nb">cd</span> build
</span></span><span class="line"><span class="cl">&gt; cmake ..
</span></span><span class="line"><span class="cl">&gt; make -j4
</span></span><span class="line"><span class="cl">&gt; make install
</span></span><span class="line"><span class="cl">&gt; acd</span></span></code></pre></div><p>For the detail, please check <a href="https://okawak.github.io/artemis_crib/setting/new_user/index.html" target="_blank">here</a>.</p>
<h3 id="3-basic-usage">3. basic usage</h3>
<ul>
<li>start artemis</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; acd <span class="c1"># move to your artemis work directory</span>
</span></span><span class="line"><span class="cl">&gt; a <span class="c1"># start artemis!</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&gt; a macro/macro.C <span class="c1"># run macro script</span></span></span></code></pre></div><ul>
<li>important command in the artemis console</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># read steering file</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> add steering/hoge.yaml <span class="nv">NAME</span><span class="o">=</span>hoge <span class="nv">NUM</span><span class="o">=</span><span class="m">0000</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># start event loop</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> res
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> start <span class="c1"># defined in CRIB artemis</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># stop event loop</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> sus
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> stop <span class="c1"># defined in CRIB artemis</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># help</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> <span class="nb">help</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># quit from artemis</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> .q</span></span></code></pre></div><ul>
<li>commands for checking histograms</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># check and move the directory</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> ls
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> <span class="nb">cd</span> <span class="m">0</span> <span class="c1"># cd ID</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># move to home directory in artemis</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> <span class="nb">cd</span> <span class="c1"># cd .. will work?</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># draw the histograms</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> ht <span class="m">0</span> colz <span class="c1"># ht ID option</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> hn colz <span class="c1"># draw the next histogram object</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> hb colz <span class="c1"># draw the previous histogram object</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># divide the canvas</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> zone <span class="m">2</span> <span class="m">2</span> <span class="c1"># 2 x 2 canvas</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># save and print the canvas</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> sa
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> pri</span></span></code></pre></div><ul>
<li>analize using TTree</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># check the files</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> fls
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># move to the created ROOT file</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> fcd <span class="m">0</span> <span class="c1"># fcd fileID</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># check the all branches</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> br
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># check the data members or methods</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> br branchname <span class="c1"># ex. artemis [1] br ppaca</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># the name of TTree object is &#34;tree&#34; (actually TArtTree object)</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> tree-&gt;Draw<span class="o">(</span><span class="s2">&#34;ppaca.fY:ppaca.fX&gt;&gt;ppaca(100,-20.,20., 100,-20.,20.)&#34;</span>,<span class="s2">&#34;&#34;</span>,<span class="s2">&#34;colz&#34;</span><span class="o">)</span></span></span></code></pre></div><p>See <a href="https://okawak.github.io/artemis_crib/setting/artemis_commands/index.html" target="_blank">here</a> for an example using random numbers.</p>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="tref-for-v1190">Tref for V1190</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-12-15 by Kodai Okawa</span></span>
<p>CRIB uses a multi-hit TDC called V1190 to take timing data (<a href="https://drive.google.com/file/d/1YRwkuFTjKFb5OvC1EfxYZtOGGdf-zKkS/view?usp=sharing" target="_blank">manual</a>).
When a trigger comes into this module, it opens a window with a set time width and records the timing of the data.</p>
<p>However, even if the signal is sent at exactly the same time to the trigger, due to the uncertainty in opening that window, the resulting channel will vary.
Since absolute channel values will vary, but relative channel values for a given (especially trigger) timing will remain the same, it is necessary to subtract all data by some reference channel to achieve good timing resolution.</p>
<p>The signal that serves as the reference for that time is what we call <code>Tref</code>!
(Time reference)
Since it is essential that all events contain that data, we put the trigger signal in one of the channels and make it a Tref.</p>
<p>The &ldquo;tref&rdquo; settings are made in the following file:</p>

  
<div class="tab-panel" data-tab-group="9da2e0c41d5b255ea9d52316d8bcca7f">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="steeringtrefyaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('9da2e0c41d5b255ea9d52316d8bcca7f','steeringtrefyaml')"
    >
      <span>
        <span class="tab-nav-hidden">steering/tref.yaml</span>
        <span class="tab-nav-text">steering/tref.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="steeringtrefyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">Processor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># J1 V1190A</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">proc_tref_v1190A_j1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TTimeReferenceProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="c"># [[device] [focus] [detector] [geo] [ch]]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">RefConfig</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">12</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w">  </span><span class="m">7</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">15</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">SegConfig</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">12</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w">  </span><span class="m">7</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">]</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>Parameters <code>RefConfig</code> and <code>SegConfig</code> are set using the same ID as in the <a href="https://okawak.github.io/artemis_crib/setting/map_config/index.html" target="_blank">map file</a>.</p>
<p>The &ldquo;RefConfig&rdquo; represents the &ldquo;Tref&rdquo; signal and the &ldquo;SegConfig&rdquo; represents the V1190 module.
Therefore, the role of the processor is to subtract the &ldquo;Segconfig&rdquo; V1190 all timing signal from the &ldquo;RefConfig&rdquo; tref signal.</p>
<p>To apply this processor, add the following line to the steering file.
For example,</p>

  
<div class="tab-panel" data-tab-group="e37f3d67853ee3303c20039397fe606f">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="steeringchkf3yaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('e37f3d67853ee3303c20039397fe606f','steeringchkf3yaml')"
    >
      <span>
        <span class="tab-nav-hidden">steering/chkf3.yaml</span>
        <span class="tab-nav-text">steering/chkf3.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="steeringchkf3yaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">Anchor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span>- <span class="cp">&amp;input</span><span class="w"> </span><span class="l">ridf/@NAME@@NUM@.ridf</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span>- <span class="cp">&amp;output</span><span class="w"> </span><span class="l">output/chkf3@NAME@@NUM@.root</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span>- <span class="cp">&amp;histout</span><span class="w"> </span><span class="l">output/chkf3@NAME@@NUM@.hist.root</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">Processor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">timer</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TTimerProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">ridf</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TRIDFEventStore</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputTransparency</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">InputFiles</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="cp">*input</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">mapper</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TMappingProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputTransparency</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line hl"><span class="cl"><span class="w">  </span>- <span class="nt">include</span><span class="p">:</span><span class="w"> </span><span class="l">tref.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">include</span><span class="p">:</span><span class="w"> </span><span class="l">rf/rf.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">include</span><span class="p">:</span><span class="w"> </span><span class="l">coin/coin.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">include</span><span class="p">:</span><span class="w"> </span><span class="l">ppac/dlppac.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">include</span><span class="p">:</span><span class="w"> </span><span class="l">ssd/f3ssd.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">outputtree</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TOutputTreeProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">FileName</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="cp">*output</span></span></span></code></pre></div></div>
    </div>
  </div>
</div>
<div class="box notices cstyle note">
  <div class="box-label"><i class="fa-fw fas fa-exclamation-circle"></i> Note</div>
  <div class="box-content">

<p>The tref.yaml should be written before the main processor. In this example, it is written right after TMappingProcessor, and we recommend writing it in this position.</p>
</div>
</div>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="ppac-calibration">PPAC calibration</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-12-18 by Kodai Okawa</span></span>
<p>CRIB use two kinds of PPAC (Parallel-Plate Avalanche Counter), charge division method or delay-readout method.
The PPAC placed at the F1 focal plane is charge-devision type, and the parameters to be converted to position are fixed and do not need to be calibrated.
Therefore we explain the calibration method for delay-line PPAC (dl-PPAC).</p>
<h2 id="principles">Principles</h2>
<p>Here we briefly describe the principle of converting from the obtained signal to position, but for more details, see here<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>.</p>
<p>We will discuss the x-direction because x and y is exactly same.
First, define the parameters as follows</p>
<ol>
<li>
<span class="math align-center">$k_x$</span> : convert from signal time difference to position [mm/ns]</li>
<li>
<span class="math align-center">$T_{X1},~T_{X2}$</span> : time at both ends of delay-line, measured at TDC [ns]</li>
<li>
<span class="math align-center">$T_{Xin-offset}$</span> : timing offset come from inside the chamber [ns]</li>
<li>
<span class="math align-center">$T_{Xout-offset}$</span> : timing offset come from outside the chamber [ns] (like from cabling)</li>
<li>
<span class="math align-center">$X_{offset}$</span> : geometry offset [mm]</li>
</ol>
<p>The artemis codes calculate the X position like this formula (see <a href="https://github.com/artemis-dev/artemis/blob/develop/artemis-share/src/ppac/TPPACProcessor.cc" target="_blank">TPPACProcessor.cc</a>).</p>

<span class="math align-center">$$ X~\mathrm{[mm]} = k_x\left( \frac{T_{X1} - T_{X2} + T_{Xin-offset} - T_{Xout-offset}}{2} \right) - X_{offset}$$</span>
<div class="box notices cstyle warning">
  <div class="box-label"><i class="fa-fw fas fa-exclamation-triangle"></i> Warning</div>
  <div class="box-content">

<p>Check the sign carefully! We often mistook the direction!!</p>
</div>
</div>
<h2 id="fixed-parameters">Fixed parameters</h2>
<p>The 
<span class="math align-center">$T_{X1},~T_{X2}$</span> are measured value by TDC, and 
<span class="math align-center">$k_x$</span> and 
<span class="math align-center">$T_{Xin-offset}$</span> are specific value to PPAC, so we need to care only 
<span class="math align-center">$T_{Xout-offset}$</span> and 
<span class="math align-center">$X_{offset}$</span>.

<span class="math align-center">$X_{offset}$</span> value depends on where we put the PPAC, so what we have to do is determine the line calibration parameter (
<span class="math align-center">$T_{Xout-offset}$</span>).</p>
<p>The following is a list of dl-PPAC parameters used in CRIB experiment.</p>
<table>
<thead>
<tr>
<th>PPAC ID</th>
<th>
<span class="math align-center">$k_x$</span> [mm/ns]</th>
<th>
<span class="math align-center">$k_y$</span> [mm/ns]</th>
<th>
<span class="math align-center">$T_{Xin-offset}$</span></th>
<th>
<span class="math align-center">$T_{Yin-offset}$</span></th>
</tr>
</thead>
<tbody>
<tr>
<td>#2</td>
<td>1.256</td>
<td>1.256</td>
<td>0.29 mm</td>
<td>0.18 mm</td>
</tr>
<tr>
<td>#3</td>
<td>1.264</td>
<td>1.253</td>
<td>0.22 mm</td>
<td>0.30 mm</td>
</tr>
<tr>
<td>#7</td>
<td>1.240</td>
<td>1.242</td>
<td>0.92 ns</td>
<td>1.58 ns</td>
</tr>
<tr>
<td>#8</td>
<td>1.241</td>
<td>1.233</td>
<td>0.17 ns</td>
<td>0.11 ns</td>
</tr>
<tr>
<td>#9</td>
<td>1.257</td>
<td>1.257</td>
<td>0.05 mm</td>
<td>0.04 mm</td>
</tr>
<tr>
<td>#10</td>
<td>1.257</td>
<td>1.257</td>
<td>0.05 mm</td>
<td>0.04 mm</td>
</tr>
</tbody>
</table>

<div class="box notices cstyle warning">
  <div class="box-label"><i class="fa-fw fas fa-exclamation-triangle"></i> Warning</div>
  <div class="box-content">

<p>Different units are used for the offset. However, since the effect of this offset is eventually absorbed to the other offset value, it is no problem to use the values if we calibrate it correctly.</p>
</div>
</div>
<h2 id="parameter-setting">Parameter setting</h2>
<p>PPAC parameters are defined in the following files</p>
<ul>
<li><a href="https://github.com/okawak/artemis_crib/blob/main/prm/ppac/dlppac.yaml" target="_blank">prm/ppac/dlppac.yaml</a></li>
</ul>
<p>For example, it is like this:</p>

  
<div class="tab-panel" data-tab-group="8f97ad0e39f89ecccdd603839309249b">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="prmppacdlppacyaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('8f97ad0e39f89ecccdd603839309249b','prmppacdlppacyaml')"
    >
      <span>
        <span class="tab-nav-hidden">prm/ppac/dlppac.yaml</span>
        <span class="tab-nav-text">prm/ppac/dlppac.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="prmppacdlppacyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TPPACParameter</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">Contents</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># #7 PPAC</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">f3bppac</span><span class="p">:</span><span class="w"> </span><span class="c"># this is the name of PPAC, should be the same name with the one in steering file!</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">ns2mm</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="m">1.240</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="m">1.242</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">delayoffset</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="m">0.92</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="m">1.58</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">linecalib</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="m">1.31</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- -<span class="m">1.00</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># 0: no exchange, 1: X -&gt; Y, Y -&gt; X</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">exchange</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># 0: no reflect, 1: X -&gt; -X</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">reflectx</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">geometry</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="m">0.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="m">0.5</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="m">322.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">TXSumLimit</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- -<span class="m">800.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="m">2000.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">TYSumLimit</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- -<span class="m">800.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="m">2000.0</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><ul>
<li>
<p>ns2mm</p>
<p>This is 
<span class="math align-center">$k_x$</span> and 
<span class="math align-center">$k_y$</span> parameters -&gt; input the fixed value</p>
</li>
<li>
<p>delayoffset</p>
<p>This is 
<span class="math align-center">$T_{Xin-offset}$</span> and 
<span class="math align-center">$T_{Yin-offset}$</span> parameters -&gt; input the fixed value</p>
</li>
<li>
<p>linecalib</p>
<p>This is explained next.</p>
</li>
<li>
<p>exchange, reflectx</p>
<p>This parameter should be changed depending on the direction in which the PPAC is placed. The meanings of the parameters are given above as comments.

<div class="box notices cstyle note">
  <div class="box-label"><i class="fa-fw fas fa-exclamation-circle"></i> Note</div>
  <div class="box-content">

<p>CRIB takes a coordinate system such that when viewed from downstream of the beam, the x-axis is rightward and the y-axis is upward. In other words, it takes a right-handed coordinate system with the beam as the Z-axis. While looking at the actual data, change these parameters so that the coordinate system becomes this coordinate system.</p>
</div>
</div></p>
</li>
<li>
<p>geometry</p>
<p>In the Line calibration, please set this value to (0,0).
After Line calibration, if we put the PPAC with some geometry offset, we should change this parameters.
Please be careful that the parameter will add minus this value for X and Y.
Z offset will be used for <a href="https://github.com/artemis-dev/artemis/blob/develop/artemis-share/src/ppac/TPPACProcessor.cc" target="_blank">TPPACTrackingProcessor</a>.</p>
</li>
<li>
<p>TXSumLimit, TYSumLimit</p>
<p>Used to determine if it is a good event or not. Currently not used.</p>
</li>
</ul>
<h2 id="line-calibration">Line calibration</h2>
<p>Before starting line calibration, please make sure that map file and steering file is correctly set.
Also we need parameter file of prm/ppac/ch2ns.dat to convert TDC channel to ns unit. (already prepared I think)</p>

<div class="mermaid align-center">
graph LR;
    A[TDC channel] --&gt;|prm/ppac/ch2ns.dat| B[ns scale]
    B --&gt; |prm/ppac/dlppac.yaml|C{PPAC object}
</div>
<p>When you complete the setting except for <code>linecalib</code> parameters, let&rsquo;s start calibration!
We prepared two useful macros to calibrate dl-PPAC.</p>
<ul>
<li><a href="https://github.com/okawak/artemis_crib/blob/main/macro/run_PPACLineCalibration.C" target="_blank">macro/run_PPACLineCalibration.C</a> : Macro to actually execute</li>
<li><a href="https://github.com/okawak/artemis_crib/blob/main/macro/PPACLineCalibration.C" target="_blank">macro/PPACLineCalibration.C</a> : Macro that actually work</li>
</ul>
<p>First, we have to prepare the data with masks on the PPAC like following picture.
This mask has holes at 12.5 mm intervals.</p>
<figure><img src="/artemis_crib/example/preparation/ppac_calibration/PPAC_pic.jpg" width="300"/>
</figure>

<p>The position of the alpha line through the central hole can be calculated and the offset adjusted to achieve that position.
The geometry inside the PPAC is as follows.
I think all PPAC geometries used by CRIB are the same.</p>
<figure><img src="/artemis_crib/example/preparation/ppac_calibration/PPAC_geo.png" width="700"/>
</figure>

<p>The parameters required to calculate the coordinates of the position are as follows.</p>
<ul>
<li>PPAC ID</li>
<li>PPAC direction (first layer is X or Y)</li>
<li>alpha source offset X</li>
<li>alpha source offset Y</li>
<li>distance between the mask and alpha source</li>
<li>reflectx in the dlppac.yaml</li>
</ul>
<p>Using these parameters, the <code>macro/PPACLineCalibration.C</code> calculate the theoretical position and how much the parameters should be moved.</p>
<h2 id="example">Example</h2>
<p>Let&rsquo;s calibrate PPACa as an example.</p>
<ul>
<li>PPAC ID : #2</li>
<li>First layer is Y</li>
<li>alpha source offset X : 0.0 mm</li>
<li>alpha source offset Y : 2.2 mm</li>
<li>distance between the mask and alpha source : 92 mm</li>
<li>reflectx : 1 (have reflection)</li>
</ul>
<p>When we set the parameter like this files, the XY figure can be obtained.</p>

  
<div class="tab-panel" data-tab-group="d543bd48dbe011a50eb46cd7d9af0ae3">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="prmppacdlppacyaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('d543bd48dbe011a50eb46cd7d9af0ae3','prmppacdlppacyaml')"
    >
      <span>
        <span class="tab-nav-hidden">prm/ppac/dlppac.yaml</span>
        <span class="tab-nav-text">prm/ppac/dlppac.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="prmppacdlppacyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TPPACParameter</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">Contents</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># #2 PPAC</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">f3appac</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">ns2mm</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="m">1.256</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="m">1.256</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">delayoffset</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="m">0.29</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="m">0.18</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">linecalib</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="m">0.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="m">0.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">exchange</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">reflectx</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">geometry</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="m">0.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="m">0.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- -<span class="m">677.0</span><span class="w"> </span><span class="c"># user defined</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">TXSumLimit</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- -<span class="m">800.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="m">2000.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">TYSumLimit</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- -<span class="m">800.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="m">2000.0</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><figure><img src="/artemis_crib/example/preparation/ppac_calibration/PPAC_before.png" width="600"/>
</figure>

<p>Then we can run the macro.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; acd
</span></span><span class="line"><span class="cl">&gt; vi macro/run_PPACLineCalibraion.C
</span></span><span class="line"><span class="cl"><span class="c1"># please set the parameters.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># instruction is written in this file</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&gt; a
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>0<span class="o">]</span> add steering/hoge.yaml <span class="nv">NAME</span><span class="o">=</span>hoge <span class="nv">NUM</span><span class="o">=</span><span class="m">0000</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>1<span class="o">]</span> res
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>2<span class="o">]</span> .x macro/run_PPACLineCalibration.C
</span></span><span class="line"><span class="cl"><span class="c1"># -- snip --</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">===================================================</span>
</span></span><span class="line"><span class="cl">center position <span class="o">(</span>cal<span class="o">)</span>  : <span class="o">(</span>-0, -0.51413<span class="o">)</span>
</span></span><span class="line"><span class="cl">center position <span class="o">(</span>data<span class="o">)</span> : <span class="o">(</span>0.890109, -0.274066<span class="o">)</span>
</span></span><span class="line"><span class="cl">difference             : <span class="o">(</span>0.890109, 0.240065<span class="o">)</span>
</span></span><span class="line"><span class="cl">move parameters        : <span class="o">(</span>-1.41737, 0.382269<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">===================================================</span></span></span></code></pre></div><p>And please input this value to the dlppac.yaml.</p>

  
<div class="tab-panel" data-tab-group="9bcadf31e7f6a4e980f6a6a1a76748ba">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="prmppacdlppacyaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('9bcadf31e7f6a4e980f6a6a1a76748ba','prmppacdlppacyaml')"
    >
      <span>
        <span class="tab-nav-hidden">prm/ppac/dlppac.yaml</span>
        <span class="tab-nav-text">prm/ppac/dlppac.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="prmppacdlppacyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TPPACParameter</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">Contents</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># #2 PPAC</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">f3appac</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">ns2mm</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="m">1.256</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="m">1.256</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">delayoffset</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="m">0.29</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="m">0.18</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">linecalib</span><span class="p">:</span><span class="w">
</span></span></span><span class="line hl"><span class="cl"><span class="w">      </span>- -<span class="m">1.417</span><span class="w">
</span></span></span><span class="line hl"><span class="cl"><span class="w">      </span>- <span class="m">0.382</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">exchange</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">reflectx</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">geometry</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="m">0.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="m">0.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- -<span class="m">677.0</span><span class="w"> </span><span class="c"># user defined</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">TXSumLimit</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- -<span class="m">800.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="m">2000.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">TYSumLimit</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- -<span class="m">800.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="m">2000.0</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>Then you can complete the line calibration of the PPAC.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; a
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>0<span class="o">]</span> add steering/hoge.yaml <span class="nv">NAME</span><span class="o">=</span>hoge <span class="nv">NUM</span><span class="o">=</span><span class="m">0000</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>1<span class="o">]</span> res
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>2<span class="o">]</span> .x macro/run_PPACLineCalibration.C
</span></span><span class="line"><span class="cl"><span class="c1"># -- snip --</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">===================================================</span>
</span></span><span class="line"><span class="cl">center position <span class="o">(</span>cal<span class="o">)</span>  : <span class="o">(</span>-0, -0.51413<span class="o">)</span>
</span></span><span class="line"><span class="cl">center position <span class="o">(</span>data<span class="o">)</span> : <span class="o">(</span>-0.0191028, -0.571067<span class="o">)</span>
</span></span><span class="line"><span class="cl">difference             : <span class="o">(</span>-0.0191028, -0.0569366<span class="o">)</span> <span class="c1"># &lt;= almost zero!</span>
</span></span><span class="line"><span class="cl">move parameters        : <span class="o">(</span>0.0304184, -0.0906633<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">===================================================</span></span></span></code></pre></div><figure><img src="/artemis_crib/example/preparation/ppac_calibration/PPAC_after.png" width="600"/>
</figure>


<div class="box notices cstyle info">
  <div class="box-label"><i class="fa-fw fas fa-info-circle"></i> Info</div>
  <div class="box-content">

<p>Because of the accuracy of the fitting, it does not make much sense to move the parameters any further.</p>
</div>
</div>
<p>The PPAC is then ready to be used by measuring how much offset the beamline axis has with respect to the delay-line axis at the position where the PPAC is actually placed, and putting this into the geometry parameters.</p>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>H. Kumagai et al., Nucl. Inst. and Meth. A <strong>470</strong>, 562 (2001)&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="mwdc-calibration">MWDC calibration</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2024-01-22 by Kodai Okawa</span></span>
<p>updating&hellip;</p>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="alpha-calibration">Alpha calibration</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-12-23 by Kodai Okawa</span></span>
<p>This is the CRIB alpha source information.
(unit: MeV)</p>
<table>
<thead>
<tr>
<th>ID</th>
<th>alpha-2</th>
<th>alpha-3</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td>4.780</td>
<td>3.148</td>
</tr>
<tr>
<td></td>
<td>5.480</td>
<td>5.462</td>
</tr>
<tr>
<td></td>
<td>5.795</td>
<td>5.771</td>
</tr>
</tbody>
</table>
<h3 id="calibration-files">calibration files</h3>
<p>SSD calibration files need to be set at <code>prm/ssd/</code> directory.
The directory structure is like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ tree -L <span class="m">2</span> prm/ssd
</span></span><span class="line"><span class="cl">prm/ssd
</span></span><span class="line"><span class="cl">├── ch2MeV.dat <span class="c1"># test file</span>
</span></span><span class="line"><span class="cl">├── ch2ns.dat <span class="c1"># test file</span>
</span></span><span class="line"><span class="cl">├── f2ch2MeV.dat
</span></span><span class="line"><span class="cl">├── f2ch2MeV_raw.dat
</span></span><span class="line"><span class="cl">├── f2ch2ns.dat
</span></span><span class="line"><span class="cl">├── tel1
</span></span><span class="line"><span class="cl">│   ├── ch2MeV_dEX.dat
</span></span><span class="line"><span class="cl">│   ├── ch2MeV_dEX_raw.dat
</span></span><span class="line"><span class="cl">│   ├── ch2MeV_dEY.dat
</span></span><span class="line"><span class="cl">│   ├── ch2MeV_dEY_raw.dat
</span></span><span class="line"><span class="cl">│   ├── ch2MeV_E.dat
</span></span><span class="line"><span class="cl">│   ├── ch2MeV_E_raw.dat
</span></span><span class="line"><span class="cl">│   ├── ch2ns_dEX.dat
</span></span><span class="line"><span class="cl">│   ├── ch2ns_dEY.dat
</span></span><span class="line"><span class="cl">│   ├── ch2ns_E.dat
</span></span><span class="line"><span class="cl">│   └── tel_conf.yaml <span class="c1"># telescope configuration, explain later</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">-- snip --</span></span></code></pre></div><p>The <code>prm/ssd/ch2MeV.dat</code> and <code>prm/ssd/ch2ns.dat</code> are used for test, so in the beam time measurement, actually this files are not necessory.
And <code>prm/ssd/f2*</code> files are used for F2SSD calibration, and files in <code>prm/ssd/tel1/</code> directory are used for SSDs of a telescope.</p>
<p>The <code>ch2ns.dat</code> depends on TDC setting, so basically we don&rsquo;t have to care so muc
(Usually the setting (the value) is same with previous experiment.), so we have to prepare the <code>ch2MeV.dat</code> files!</p>

<div class="box notices cstyle note">
  <div class="box-label"><i class="fa-fw fas fa-exclamation-circle"></i> Note</div>
  <div class="box-content">

<p>The file name need to be set like this example.
The loaded parameter file name is defined SSD steering file, and we don&rsquo;t want to change the SSD steering files so much, so please use such file names.</p>
</div>
</div>
<p>The &ldquo;ch2MeV.dat&rdquo; file format is like this:</p>

  
<div class="tab-panel" data-tab-group="7190152491555301d87f457131e3bb29">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="prmssdf2ch2mevdat"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('7190152491555301d87f457131e3bb29','prmssdf2ch2mevdat')"
    >
      <span>
        <span class="tab-nav-hidden">prm/ssd/f2ch2MeV.dat</span>
        <span class="tab-nav-text">prm/ssd/f2ch2MeV.dat</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="prmssdf2ch2mevdat"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># offset gain</span>
</span></span><span class="line"><span class="cl">1.7009  0.0173
</span></span><span class="line"><span class="cl">0.0 1.0 <span class="c1"># if there are some SSDs or strip SSD, you can add the line.</span></span></span></code></pre></div></div>
    </div>
  </div>
</div>
<span class="math align-center">$$ E~\mathrm{[MeV]} = \mathrm{offset} + \mathrm{gain} \times \mathrm{ch} $$</span><h3 id="usage">Usage</h3>
<p>We prepared useful macros to calibrate many SSDs.
Please check these for more information.</p>
<ul>
<li><a href="https://github.com/okawak/artemis_crib/blob/main/macro/AlphaCalibration.C" target="_blank">macro/AlphaCalibration.C</a></li>
<li><a href="https://github.com/okawak/artemis_crib/blob/main/macro/run_AlphaCalibration.C" target="_blank">macro/run_AlphaCalibraion.C</a></li>
</ul>
<p>It is sufficient to use the AlphaCalibration.C, but it is recommended to use the run_AlphaCalibration.C to keep a record of what arguments were used to calibrate.</p>
<p>After you prepared alpha calibration data and steering file (for example <code>steering/calibration.yaml</code>) to show raw data, you can use this macro.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ acd
</span></span><span class="line"><span class="cl">$ vi macro/run_AlphaCalibration.C
</span></span><span class="line"><span class="cl"><span class="c1"># please set the parameters.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># instraction is written in this file</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">$ a
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>0<span class="o">]</span> add steering/hoge.yaml <span class="nv">NAME</span><span class="o">=</span>hoge <span class="nv">NUM</span><span class="o">=</span><span class="m">0000</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>1<span class="o">]</span> res
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>2<span class="o">]</span> .x macro/run_AlphaCalibration.C</span></span></code></pre></div><p>Then the parameter file that defined at the &ldquo;run_AlphaCalibration.C&rdquo; and calibration figures will be created automatically.</p>
<p>These are example of the figures;</p>
<ul>
<li>raw fitting figure (figure/calib/tel*/ch2MeV_*/raw/)</li>
</ul>
<figure><img src="/artemis_crib/example/preparation/alpha_calibration/ex_raw.png" width="600"/>
</figure>

<ul>
<li>calibration line and residual figure (figure/calib/tel*/ch2MeV_*/calibration/)</li>
</ul>
<figure><img src="/artemis_crib/example/preparation/alpha_calibration/ex_cal.png" width="600"/>
</figure>

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ a
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>0<span class="o">]</span> add steering/hoge.yaml <span class="nv">NAME</span><span class="o">=</span>hoge <span class="nv">NUM</span><span class="o">=</span><span class="m">0000</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>1<span class="o">]</span> res
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>2<span class="o">]</span> fcd <span class="m">0</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>3<span class="o">]</span> zo
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>4<span class="o">]</span> tree-&gt;Draw<span class="o">(</span><span class="s2">&#34;...&#34;</span><span class="o">)</span> <span class="c1"># draw calibrated data</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>5<span class="o">]</span> gStyle-&gt;SetOptStat<span class="o">(</span>0<span class="o">)</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>6<span class="o">]</span> sa</span></span></code></pre></div><figure><img src="/artemis_crib/example/preparation/alpha_calibration/ex_all_cal.png" width="600"/>
</figure>


            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="mux-calibration">MUX calibration</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2024-01-22 by Kodai Okawa</span></span>
<p>updating&hellip;</p>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="set-parameters">Set parameters</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2024-01-22 by Kodai Okawa</span></span>
<p>updating&hellip;</p>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
<div class="tags">
  <a class="tag-link" href="/artemis_crib/tags/need_update/index.html">need_update</a>
</div>
            </header>
<h1 id="git">Git</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2024-01-22 by Kodai Okawa</span></span>
<p>Analysis files for each experiment are managed using <code>git</code>.
This is so that they can be quickly restored if they are all lost for some reason.</p>
<p><code>Git</code> is a bit complicated and you can commit freely if you are knowledgeable, but if you are unfamiliar with it, you don&rsquo;t have to worry too much.
The main use is that if someone creates a useful file, it will be reflected for each user as well.</p>
<p>Here is a brief description of how to use it.</p>
<h2 id="directory-structure">Directory structure</h2>
<p>In the CRIB analysis PC, we used local repository.
The files related the repository is stored here.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; <span class="nb">cd</span> ~
</span></span><span class="line"><span class="cl">&gt; tree -L <span class="m">1</span> repos/exp
</span></span><span class="line"><span class="cl">repos/exp
</span></span><span class="line"><span class="cl">├── he6p2024.git
</span></span><span class="line"><span class="cl">├── he6p.git
</span></span><span class="line"><span class="cl">└── o14a.git
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 2023/12/18 current status</span></span></span></code></pre></div>
<div class="box notices cstyle warning">
  <div class="box-label"><i class="fa-fw fas fa-exclamation-triangle"></i> Warning</div>
  <div class="box-content">

<p>Note that if you delete the files in this directory, you will lose all backups.</p>
</div>
</div>
<h2 id="basic-commands">basic commands</h2>
<p>I will describe the most commonly used commands and how to resolve conflicts.</p>

            <footer class="footline">

            </footer>
          </article>

          </section>
          <article class="default">
            <header class="headline">
            </header>
<h1 id="online-analysis">Online analysis</h1>

<p>This section explain the example of the online analysis in the CRIB experiment.</p>

<ul class="children children-li children-sort-weight">
	
<li><a href="/artemis_crib/example/online_analysis/f1/index.html">F1</a></li>
<li><a href="/artemis_crib/example/online_analysis/pid/index.html">Beam PID</a></li>
<li><a href="/artemis_crib/example/online_analysis/f2/index.html">F2</a></li>
<li><a href="/artemis_crib/example/online_analysis/ppac/index.html">PPAC</a></li>
<li><a href="/artemis_crib/example/online_analysis/mwdc/index.html">MWDC</a></li>
<li><a href="/artemis_crib/example/online_analysis/telescope/index.html">Telescope</a></li>
<li><a href="/artemis_crib/example/online_analysis/f3/index.html">F3</a></li>
<li><a href="/artemis_crib/example/online_analysis/gate/index.html">Gate</a></li>
<li><a href="/artemis_crib/example/online_analysis/shift/index.html">Shifter task</a></li>
<li><a href="/artemis_crib/example/online_analysis/scaler/index.html">Scaler</a></li>
<li><a href="/artemis_crib/example/online_analysis/timestamp/index.html">Timestamp</a></li>
<li><a href="/artemis_crib/example/online_analysis/check_rawdata/index.html">Raw data checker</a></li>
</ul>

            <footer class="footline">

            </footer>
          </article>

          <section>
            <h1 class="a11y-only">Subsections of Online analysis</h1>
          <article class="default">
            <header class="headline">
            </header>
<h1 id="f1">F1</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2024-01-20 by Kodai Okawa</span></span>
<p>From here, we would like to explain in detail how to analyze the actual experiment.
We assume that you have already prepared your the analysis environment.
It is okay either your own directory or the default directory (<a href="/artemis_crib/example/online_analysis/f1/../../../crib_parts/environment">see CRIB configuration</a>).
If you are not ready yet, please see <a href="/artemis_crib/example/online_analysis/f1/../../preparation/basic">here</a>.</p>
<p>So let&rsquo;s start to check the data.
At the F1 focal plane, there is (charge-divition) PPAC.
The steering file to analyze f1 data is <code>chkf1.yaml</code>.</p>
<ul>
<li><a href="https://github.com/okawak/artemis_crib/blob/main/steering/chkf1.yaml" target="_blank">steering/chkf1.yaml</a></li>
</ul>
<p>We usually use &ldquo;chk&rdquo; (check) as a prefix of the steering files to analyze from raw binaly data.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ artlogin <span class="o">(</span>username<span class="o">)</span>
</span></span><span class="line"><span class="cl">$ a
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>0<span class="o">]</span> add steering/chkf1.yaml <span class="nv">NAME</span><span class="o">=</span>hoge <span class="nv">NUM</span><span class="o">=</span><span class="m">0000</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>1<span class="o">]</span> res</span></span></code></pre></div><p>The important data is &ldquo;X position&rdquo; at the F1PPAC.
The histogram can be check by following step:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>2<span class="o">]</span> sus
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>3<span class="o">]</span> ls
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> artemis
</span></span><span class="line"><span class="cl">&gt;   <span class="m">0</span> art::TTreeProjGroup f1check         f1_check
</span></span><span class="line"><span class="cl">    <span class="m">1</span> art::TAnalysisInfo analysisInfo
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>4<span class="o">]</span> <span class="nb">cd</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>5<span class="o">]</span> ls
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> f1check
</span></span><span class="line"><span class="cl">&gt;   <span class="m">0</span> art::TH1FTreeProj f1ppac_X        f1ppac X
</span></span><span class="line"><span class="cl">    <span class="m">1</span> art::TH1FTreeProj f1ppac_Y        f1ppac Y
</span></span><span class="line"><span class="cl">    <span class="m">2</span> art::TH1FTreeProj f1ppac_X1raw    f1ppac X1raw
</span></span><span class="line"><span class="cl">    <span class="m">3</span> art::TH1FTreeProj f1ppac_X2raw    f1ppac X2raw
</span></span><span class="line"><span class="cl">    <span class="m">4</span> art::TH1FTreeProj f1ppac_Y1raw    f1ppac Y1raw
</span></span><span class="line"><span class="cl">    <span class="m">5</span> art::TH1FTreeProj f1ppac_Y2raw    f1ppac Y2raw
</span></span><span class="line"><span class="cl">    <span class="m">6</span> art::TH2FTreeProj f1ppac_x_y      f1ppac X vs Y
</span></span><span class="line"><span class="cl">    <span class="m">7</span> art::TH2FTreeProj f1ppac_x_rf     f1ppac X vs RF
</span></span><span class="line"><span class="cl">    <span class="m">8</span> art::TH2FTreeProj f1ppac_x1_x2    f1ppac x1 vs x2
</span></span><span class="line"><span class="cl">    <span class="m">9</span> art::TH2FTreeProj f1ppac_y1_y2    f1ppac y1 vs y2</span></span></code></pre></div><p>Many histograms are defined, but in practice it&rsquo;s enough to check the first X position.
Sometimes we check other raw data histograms to see if the behavior of F1PPAC is correct or not.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>6<span class="o">]</span> ht <span class="m">0</span></span></span></code></pre></div><p>Usually a gaussian fit is performed to get center the position.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>7<span class="o">]</span> xf</span></span></code></pre></div><p>For the commane &ldquo;xf&rdquo; (xfitg), please check <a href="/artemis_crib/example/online_analysis/f1/../../../crib_parts/newcommand">here</a>.</p>
<p>When you think the signals from F1PPAC is okay, but position seems wrong (the X position is different from the setting of F1 slit), pleace modify the parameter files.</p>
<ul>
<li><a href="https://github.com/okawak/artemis_crib/blob/main/prm/ppac/ch2q.prm" target="_blank">prm/ppac/ch2q.prm</a></li>
<li><a href="https://github.com/okawak/artemis_crib/blob/main/prm/ppac/f1ppac.yaml" target="_blank">prm/ppac/f1ppac.yaml</a></li>
</ul>
<p>It is actually charge-divition PPAC, but the structure of parameter file is the same with dl-PPAC, so please also check <a href="/artemis_crib/example/online_analysis/f1/../../preparation/ppac_calibration">PPAC preparation</a>.</p>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
<div class="tags">
  <a class="tag-link" href="/artemis_crib/tags/need_update/index.html">need_update</a>
</div>
            </header>
<h1 id="beam-pid">Beam PID</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2024-01-22 by Kodai Okawa</span></span>
<p>In the F2 focal plane, we check the secondary beam condition.
In other words, identify the beam particles we want and adjust the beamline parameters to get the most amount of the beam particle.
Therefore, we need to identify the beam ion from the data.
To do so, we perform simulation.</p>
<p>This is almost the same with <a href="https://www.cns.s.u-tokyo.ac.jp/crib/cgi-bin/pid/CRIB_PID_calc.html" target="_blank">this web application</a>.
This web application uses <code>enewz</code> energy loss calculation, but PID using artemis uses <code>SRIM</code>.</p>
<p>These are the source code for the PID calculation.</p>
<ul>
<li><a href="https://github.com/okawak/artemis_crib/blob/main/src-crib/simulation/TCRIBPIDProcessor.cc" target="_blank">TCRIBPIDProcessor.cc</a></li>
<li><a href="https://github.com/okawak/artemis_crib/blob/main/src-crib/simulation/TCRIBPIDProcessor.h" target="_blank">TCRIBPIDProcessor.h</a></li>
</ul>
<h3 id="principles">Principles</h3>
<p>The simple principle of PID (Particle IDentification) is described.</p>
<p>First, the energies of the various beam ions are determined from the value of the magnetic rigidity (
<span class="math align-center">$B\rho$</span>) of the dipole magnets.
The values are then calculated using relativity.</p>

<span class="math align-center">$$ m_0\gamma\frac{v^2}{\rho} = qevB $$
$$ B\rho = \frac{m_0\gamma\beta c}{qe} $$
$$ \frac{B\rho qe}{c} = m_0\frac{\beta}{\sqrt{1-\beta^2}} $$</span><p>From this equation, solving for 
<span class="math align-center">$\beta^2$</span>,</p>

<span class="math align-center">$$ \beta^2 = \frac{1}{1+\left( \frac{m_0 c}{B\rho qe} \right)^2} $$
$$ \frac{1}{\sqrt{1-\beta^2}} = \sqrt{1+\left( \frac{B\rho qe}{m_0 c} \right)^2} $$</span><p>Relativistic energy 
<span class="math align-center">$E$</span> is</p>

<span class="math align-center">$$ E = \frac{m_0 c^2}{\sqrt{1-\beta^2}} $$
$$ E^2 = \left(m_0 c^2\right)^2 + \left( B\rho qec \right)^2 $$</span><p>Therefore, from this equation, 
<span class="math align-center">$E$</span> can be obtained from 
<span class="math align-center">$B\rho$</span> and the kinetic energy can be derived from the following relationship.</p>

<span class="math align-center">$$ E = E_{kin} + m_0 c^2 $$
$$ E_{kin} = m_0 c^2\left( \sqrt{1+\left( \frac{B\rho qec}{m_0 c^2} \right)^2} -1 \right) $$</span><p>The equation for determining velocity from energy using relativity can also be obtained as follows.</p>

<span class="math align-center">$$ E_{kin} + m_0 c^2 = \frac{m_0 c^2}{\sqrt{1-\left(\frac{v}{c}\right)^2}} $$
$$ v = c\sqrt{1-\left( \frac{1}{\frac{E_{kin}}{m_0 c^2} +1} \right)^2} $$</span><p>The energy loss of the detector placed on the beamline is then calculated and the PID diagram is obtained by plotting the possible measured values using these relationships.</p>
<h3 id="usage">Usage</h3>
<p>First, please prepare the SRIMlib dataset.
You need all input ion for &ldquo;mylar&rdquo; and &ldquo;Si&rdquo; target energy loss table.
For the SRIMlib setting, please refer <a href="https://okawak.github.io/artemis_crib/installation/energyloss_calculator/index.html" target="_blank">this page</a>.</p>
<p>Next, you need input ions and beamline parameter files.
The format is like this.</p>

  
<div class="tab-panel" data-tab-group="5816baaec89b4384d8f87a2416940f78">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="prmpidexpnameyaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('5816baaec89b4384d8f87a2416940f78','prmpidexpnameyaml')"
    >
      <span>
        <span class="tab-nav-hidden">prm/pid/expname.yaml</span>
        <span class="tab-nav-text">prm/pid/expname.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="prmpidexpnameyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">input_ions</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">7Li3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">charge</span><span class="p">:</span><span class="w"> </span><span class="m">3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">mass</span><span class="p">:</span><span class="w"> </span><span class="m">7.01435758</span><span class="w"> </span><span class="c"># amu</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">color</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="c"># 0 -&gt; red, 1 -&gt; blue, 2 -&gt; black</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">6He2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">charge</span><span class="p">:</span><span class="w"> </span><span class="m">2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">mass</span><span class="p">:</span><span class="w"> </span><span class="m">6.01778863</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">color</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">3H1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">charge</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">mass</span><span class="p">:</span><span class="w"> </span><span class="m">3.015500905</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">color</span><span class="p">:</span><span class="w"> </span><span class="m">2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">2H1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">charge</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">mass</span><span class="p">:</span><span class="w"> </span><span class="m">2.013553496</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">color</span><span class="p">:</span><span class="w"> </span><span class="m">2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">1H1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">charge</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">mass</span><span class="p">:</span><span class="w"> </span><span class="m">1.007276452</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">color</span><span class="p">:</span><span class="w"> </span><span class="m">2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">4He2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">charge</span><span class="p">:</span><span class="w"> </span><span class="m">2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">mass</span><span class="p">:</span><span class="w"> </span><span class="m">4.001506094</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">color</span><span class="p">:</span><span class="w"> </span><span class="m">2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># BLD parameters</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">f1_parameters</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">brho</span><span class="p">:</span><span class="w"> </span><span class="m">1.227</span><span class="w"> </span><span class="c"># Tm</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">rf_period</span><span class="p">:</span><span class="w"> </span><span class="m">57.0</span><span class="w"> </span><span class="c"># ns</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">f2_parameters</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">PPAC_thickness</span><span class="p">:</span><span class="w"> </span><span class="m">10.0</span><span class="w"> </span><span class="c"># um, mylar</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">SSD_thickness</span><span class="p">:</span><span class="w"> </span><span class="m">1500.0</span><span class="w"> </span><span class="c"># um</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">f3_parameters</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">a_thickness</span><span class="p">:</span><span class="w"> </span><span class="m">15.0</span><span class="w"> </span><span class="c"># um, mylar, PPACa/MWDCa</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">b_thickness</span><span class="p">:</span><span class="w"> </span><span class="m">15.0</span><span class="w"> </span><span class="c"># um, mylar, PPACb/MWDCb</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">distance</span><span class="p">:</span><span class="w"> </span><span class="m">290.5</span><span class="w"> </span><span class="c"># mm, between two tracking detectors</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">trigger</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="c"># PPACa/MWDCa -&gt; 0, PPACb/MWDCb -&gt; 1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># display parameters</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">f2_display</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">rf_offset</span><span class="p">:</span><span class="w"> </span>-<span class="m">6.5</span><span class="w"> </span><span class="c"># ns</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">rf_range</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">0.0</span><span class="p">,</span><span class="w"> </span><span class="m">120.0</span><span class="p">]</span><span class="w"> </span><span class="c"># ns</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">energy_range</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">0.0</span><span class="p">,</span><span class="w"> </span><span class="m">100.0</span><span class="p">]</span><span class="w"> </span><span class="c"># MeV</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">f3_display</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">rf_offset</span><span class="p">:</span><span class="w"> </span>-<span class="m">12.0</span><span class="w"> </span><span class="c"># ns</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">tof_offset</span><span class="p">:</span><span class="w"> </span>-<span class="m">2.7</span><span class="w"> </span><span class="c"># ns</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">rf_range</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">0.0</span><span class="p">,</span><span class="w"> </span><span class="m">120.0</span><span class="p">]</span><span class="w"> </span><span class="c"># ns</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">tof_range</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">0.0</span><span class="p">,</span><span class="w"> </span><span class="m">8.0</span><span class="p">]</span><span class="w"> </span><span class="c"># ns</span></span></span></code></pre></div></div>
    </div>
  </div>
</div>
<div class="box notices cstyle info">
  <div class="box-label"><i class="fa-fw fas fa-info-circle"></i> Info</div>
  <div class="box-content">

<p>You can add the beam ions freely, but you need to prepare SRIM Output table.</p>
</div>
</div>
<p>Lastly, let&rsquo;s prepare the steering file.
If you want to do only PID calculation, you can use <code>chkpid.yaml</code>.</p>

  
<div class="tab-panel" data-tab-group="daf77f0cee28d0de6344d938679ff161">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="steeringchkpidyaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('daf77f0cee28d0de6344d938679ff161','steeringchkpidyaml')"
    >
      <span>
        <span class="tab-nav-hidden">steering/chkpid.yaml</span>
        <span class="tab-nav-text">steering/chkpid.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="steeringchkpidyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">Processor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">pid</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TCRIBPIDProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">FileName</span><span class="p">:</span><span class="w"> </span><span class="l">prm/pid/expname.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Batch</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputTransparency</span><span class="p">:</span><span class="w"> </span><span class="m">1</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>You can add these sentences for any other steering files.
I think it is useful when you want to overlap the data figure and calculation figure.
If you set <code>Batch: false</code>, the canvases for F2 PID and F3 PID will appear automatically.
<code>Batch: true</code> is quiet mode.</p>
<p>This is an example of the automatically generated figure.</p>
<figure><img src="/artemis_crib/example/online_analysis/pid/auto.png" width="600"/>
</figure>

<p>The process for the calculation is performed in init process (I mean not event loop), so when you <code>add</code> the steering file, the figure will be created.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; acd
</span></span><span class="line"><span class="cl">&gt; a
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>0<span class="o">]</span> add steering/chkpid.yaml
</span></span><span class="line"><span class="cl"><span class="c1"># process is performed now</span>
</span></span><span class="line"><span class="cl"><span class="c1"># if Batch: false, the two PID figure will appear automatically </span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>1<span class="o">]</span> ls
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> artemis
</span></span><span class="line"><span class="cl">&gt;   <span class="m">0</span> TDirectory pid             pid       
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>2<span class="o">]</span> <span class="nb">cd</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>3<span class="o">]</span> ls
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> pid
</span></span><span class="line"><span class="cl">&gt;   <span class="m">0</span> TMultiGraph                 F2_PID<span class="p">;</span> F2 RF <span class="o">[</span>ns<span class="o">]</span><span class="p">;</span> F2 SSD <span class="o">[</span>MeV<span class="o">]</span>
</span></span><span class="line"><span class="cl">    <span class="m">1</span> TMultiGraph                 F3_PID<span class="p">;</span> F3 RF <span class="o">[</span>ns<span class="o">]</span><span class="p">;</span> PPACs/MWDCs TOF <span class="o">[</span>ns<span class="o">]</span>
</span></span><span class="line"><span class="cl">    <span class="m">2</span> TCanvas F2_canvas       F2_canvas 
</span></span><span class="line"><span class="cl">    <span class="m">3</span> TCanvas F3_canvas       F3_canvas 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>4<span class="o">]</span> draw <span class="m">0</span></span></span></code></pre></div><figure><img src="/artemis_crib/example/online_analysis/pid/multigraph.png" width="600"/>
</figure>


<div class="box notices cstyle info">
  <div class="box-label"><i class="fa-fw fas fa-info-circle"></i> Info</div>
  <div class="box-content">

<p>There are two kinds of object, <code>TMultiGraph</code> and <code>TCanvas</code>.
The <code>ht</code> command cannot draw these object, so I also made <code>draw</code> command to be able to draw &ldquo;TMultiGraph&rdquo; objects.</p>
<p>HOWEVER, even this &ldquo;draw&rdquo; command cannot display the &ldquo;TCanvas&rdquo; object yet&hellip;
If you save the object using <code>hstore</code> command or check from THttpServer, you can check the TCanvas objects.</p>
</div>
</div>
<p>This &ldquo;TMultiGraph&rdquo; object is useful when you want to overlay th data.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> ht something <span class="c1"># this is gaussian example</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> dr <span class="m">0</span> p same</span></span></code></pre></div><figure><img src="/artemis_crib/example/online_analysis/pid/overlap.png" width="600"/>
</figure>


            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="f2">F2</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2024-01-20 by Kodai Okawa</span></span>
<p>The basic usage is the same.</p>
<p>We use this steering file to check F2 data.</p>
<ul>
<li><a href="https://github.com/okawak/artemis_crib/blob/main/steering/chkf2.yaml" target="_blank">steering/chkf2.yaml</a></li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ artlogin <span class="o">(</span>username<span class="o">)</span>
</span></span><span class="line"><span class="cl">$ a
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>0<span class="o">]</span> add steering/chkf2.yaml <span class="nv">NAME</span><span class="o">=</span>hoge <span class="nv">NUM</span><span class="o">=</span><span class="m">0000</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>1<span class="o">]</span> res
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>2<span class="o">]</span> sus
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>3<span class="o">]</span> ls
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> artemis
</span></span><span class="line"><span class="cl">&gt;   <span class="m">0</span> art::TTreeProjGroup f2check         f2_check
</span></span><span class="line"><span class="cl">    <span class="m">1</span> art::TAnalysisInfo analysisInfo</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>4<span class="o">]</span> <span class="nb">cd</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>5<span class="o">]</span> ls
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> f2check
</span></span><span class="line"><span class="cl">&gt;   <span class="m">0</span> art::TH1FTreeProj f2PPAC X        f2ppac x
</span></span><span class="line"><span class="cl">    <span class="m">1</span> art::TH1FTreeProj f2PPAC Y        f2ppac y
</span></span><span class="line"><span class="cl">    <span class="m">2</span> art::TH1FTreeProj f2SSD raw       f2ssd raw
</span></span><span class="line"><span class="cl">    <span class="m">3</span> art::TH1FTreeProj f2SSD raw <span class="o">(</span>low<span class="o">)</span> f2ssd raw <span class="o">(</span>low<span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="m">4</span> art::TH1FTreeProj f2SSD cal       f2ssd cal
</span></span><span class="line"><span class="cl">    <span class="m">5</span> art::TH2FTreeProj f2PPAC X vs Y   f2ppac X vs Y
</span></span><span class="line"><span class="cl">    <span class="m">6</span> art::TH2FTreeProj F2PPAC X vs RF0 f2ppac X vs rf0
</span></span><span class="line"><span class="cl">    <span class="m">7</span> art::TH2FTreeProj F2PPAC Y vs RF0 f2ppac Y vs rf0
</span></span><span class="line"><span class="cl">    <span class="m">8</span> art::TH2FTreeProj RF0 vs F2SSD raw rf0 vs f2ssd raw
</span></span><span class="line"><span class="cl">    <span class="m">9</span> art::TH2FTreeProj RF0 vs F2SSD cal rf0 vs f2ssd cal
</span></span><span class="line"><span class="cl">   <span class="m">10</span> art::TH2FTreeProj RF1 vs F2SSD cal rf1 vs f2ssd cal
</span></span><span class="line"><span class="cl">   <span class="m">11</span> art::TH2FTreeProj F2PPAC X vs F2SSD raw f2ppac x vs f2ssd raw
</span></span><span class="line"><span class="cl">   <span class="m">12</span> art::TH2FTreeProj F2PPAC X vs F2SSD cal f2ppac x vs f2ssd cal
</span></span><span class="line"><span class="cl">   <span class="m">13</span> art::TH2FTreeProj F2PPAC Y vs F2SSD cal f2ppac y vs f2ssd cal
</span></span><span class="line"><span class="cl">   <span class="m">14</span> art::TH1FTreeProj RF0             rf0</span></span></code></pre></div><p>As you know, you can check the histograms</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># for 1D histograms</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> ht <span class="o">[</span>id<span class="o">]</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> hn <span class="c1"># histogram next</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> hb <span class="c1"># histogram before (back?)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># for 2D histograms</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> ht <span class="o">[</span>id<span class="o">]</span> colz <span class="c1"># colz is option</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> hn colz
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> hb colz</span></span></code></pre></div><p>If you want to save,</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> sa
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> pri</span></span></code></pre></div>
            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="ppac">PPAC</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2024-01-22 by Kodai Okawa</span></span>
<p>updating&hellip;</p>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="mwdc">MWDC</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2024-01-22 by Kodai Okawa</span></span>
<p>updating&hellip;</p>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="telescope">Telescope</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2024-01-22 by Kodai Okawa</span></span>
<p>In the CRIB experiment, we often use a &ldquo;telescope&rdquo; consisting of DSSSD (Double-Sided SSD) and SSD (Single-Pad SSD).
The combination of these multiple Si detectors as a dE-E detector is called a <code>telescope</code>.</p>
<p>To analyze the data as telescope data rather than individual detectors, I created a data class called TTelescopeData.
This section describes its data structure and usage.</p>
<ul>
<li><a href="https://github.com/okawak/artemis_crib/blob/main/src-crib/telescope/TTelescopeData.h" target="_blank">src-crib/telescope/TTelescopeData.h</a></li>
</ul>
<p>Please assume that one of the name of TTelescopeData object is &ldquo;tel1&rdquo;</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># after some process</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> br tel1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> art::TTelescopeData
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> Data Members
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                 TVector3   fPos                   detected position <span class="o">(</span>X, Y, Z<span class="o">)</span>
</span></span><span class="line"><span class="cl">                      int   fXID                   X strip number
</span></span><span class="line"><span class="cl">                      int   fYID                   Y strip number
</span></span><span class="line"><span class="cl">                      int   fNE                    number of all SSDs
</span></span><span class="line"><span class="cl">                   double   fdE                    energy at first layor
</span></span><span class="line"><span class="cl">                   double   fdEX                   X side energy <span class="o">(=</span>~ fdEY<span class="o">)</span>
</span></span><span class="line"><span class="cl">                   double   fdEY                   Y side energy <span class="o">(=</span>~ fdEX<span class="o">)</span>
</span></span><span class="line"><span class="cl">                   double   fE                     added energy at thick SSDs
</span></span><span class="line"><span class="cl">                   double   fEtotal                all energy deposit in the telescope
</span></span><span class="line"><span class="cl">                   double   fTiming                timing information at the first layor <span class="o">(</span>X side<span class="o">)</span>
</span></span><span class="line"><span class="cl">                   double   fYTiming               <span class="k">for</span> <span class="k">case</span> that X side have trouble <span class="o">(</span>Y side<span class="o">)</span>
</span></span><span class="line"><span class="cl">                   double   fTheta_L               reaction angle in LAB system
</span></span><span class="line"><span class="cl">           vector&lt;double&gt;   fEnergyArray           energy array <span class="k">for</span> each SSD
</span></span><span class="line"><span class="cl">           vector&lt;double&gt;   fTimingArray           timing array <span class="k">for</span> each SSD
</span></span><span class="line"><span class="cl">                ESortType   kID
</span></span><span class="line"><span class="cl">                ESortType   kTiming
</span></span><span class="line"><span class="cl">               ESortOrder   kASC
</span></span><span class="line"><span class="cl">               ESortOrder   kDESC
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># snip for Method as for now</span></span></span></code></pre></div><p>These are the all data members of the &ldquo;TTelescopeData&rdquo;.
The most commonly used variables are &ldquo;fXID&rdquo;, &ldquo;fYID&rdquo;, &ldquo;fdE&rdquo; and &ldquo;fE&rdquo;.
Other variables are accessed by using methods (explain later).
The meaning of these variables are written the upper code block.</p>
<p>We use them like,</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> tree-&gt;Draw<span class="o">(</span><span class="s2">&#34;tel1.fYID:tel1.fXID&gt;&gt;strip(16,-0.5,15.5, 16,-0.5,15.5)&#34;</span>,<span class="s2">&#34;&#34;</span>,<span class="s2">&#34;colz&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> tree-&gt;Draw<span class="o">(</span><span class="s2">&#34;tel1.fdE:tel1.fE&#34;</span>,<span class="s2">&#34;&#34;</span>,<span class="s2">&#34;&#34;</span><span class="o">)</span></span></span></code></pre></div><p>or we can use in histogram definition file of course.</p>
<p>The following are the methods of the TTelescopeData object:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># after some process</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> br tel1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># snip for Data Members</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> Methods
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">          TTelescopeData<span class="p">&amp;</span>   <span class="nv">operator</span><span class="o">=</span>
</span></span><span class="line"><span class="cl">                 TVector3   GetPosition
</span></span><span class="line"><span class="cl">                 Double_t   X
</span></span><span class="line"><span class="cl">                 Double_t   Y
</span></span><span class="line"><span class="cl">                 Double_t   Z
</span></span><span class="line"><span class="cl">                     void   SetPosition
</span></span><span class="line"><span class="cl">                     void   SetPosition
</span></span><span class="line"><span class="cl">                    Int_t   GetN
</span></span><span class="line"><span class="cl">                     void   SetN
</span></span><span class="line"><span class="cl">                    Int_t   GetXID
</span></span><span class="line"><span class="cl">                     void   SetXID
</span></span><span class="line"><span class="cl">                    Int_t   GetYID
</span></span><span class="line"><span class="cl">                     void   SetYID
</span></span><span class="line"><span class="cl">                 Double_t   GetdE
</span></span><span class="line"><span class="cl">                     void   SetdE
</span></span><span class="line"><span class="cl">                 Double_t   GetdEX
</span></span><span class="line"><span class="cl">                     void   SetdEX
</span></span><span class="line"><span class="cl">                 Double_t   GetdEY
</span></span><span class="line"><span class="cl">                     void   SetdEY
</span></span><span class="line"><span class="cl">                 Double_t   GetE
</span></span><span class="line"><span class="cl">                     void   SetE
</span></span><span class="line"><span class="cl">                 Double_t   GetEtotal
</span></span><span class="line"><span class="cl">                     void   SetEtotal
</span></span><span class="line"><span class="cl">                 Double_t   GetTelTiming
</span></span><span class="line"><span class="cl">                     void   SetTelTiming
</span></span><span class="line"><span class="cl">                 Double_t   GetTelYTiming
</span></span><span class="line"><span class="cl">                     void   SetTelYTiming
</span></span><span class="line"><span class="cl">                 Double_t   GetTheta_L
</span></span><span class="line"><span class="cl">                     void   SetTheta_L
</span></span><span class="line"><span class="cl">                 Double_t   A
</span></span><span class="line"><span class="cl">              DoubleVec_t   GetEnergyArray
</span></span><span class="line"><span class="cl">                 Double_t   GetEnergyArray
</span></span><span class="line"><span class="cl">                     void   PushEnergyArray
</span></span><span class="line"><span class="cl">              DoubleVec_t   GetTimingArray
</span></span><span class="line"><span class="cl">                 Double_t   GetTimingArray
</span></span><span class="line"><span class="cl">                     void   PushTimingArray
</span></span><span class="line"><span class="cl">                 Double_t   E
</span></span><span class="line"><span class="cl">                 Double_t   T
</span></span><span class="line"><span class="cl">                     void   Copy
</span></span><span class="line"><span class="cl">                     void   Clear
</span></span><span class="line"><span class="cl">                   Bool_t   CheckTObjectHashConsistency
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> See also
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">     art::TDataObject       base class <span class="k">for</span> data object</span></span></code></pre></div><p>The most commonly used methods are &ldquo;X()&rdquo;, &ldquo;Y()&rdquo;, &ldquo;Z()&rdquo;, &ldquo;E()&rdquo;, &ldquo;T()&rdquo; and &ldquo;A()&rdquo;.
There are also longer name methods, but it is troublesome to write long methods, so I prepared short name methods.
The longer name methods are mainly used in the source processor to make it more readable.</p>
<ul>
<li><code>X()</code>: return fPos.X(), detected X position</li>
<li><code>Y()</code>: return fPos.Y(), detected Y position</li>
<li><code>Z()</code>: return fPos.Z(), detected Z position</li>
<li><code>E()</code>: return fEtotal, total energy deposit in the telescope</li>
<li><code>E(id: int)</code>: return fEnergyArray[id], energy deposit of each Si layer, id=0 means dE, id=1 means second layer</li>
<li><code>T()</code>: return fTiming, detected timing at first layer</li>
<li><code>T(id: int)</code>: return fTimingArray[id], timing at the &ldquo;id&rdquo; th Si detector</li>
<li><code>A()</code>: return fTheta_L, the angle of the event, deg unit</li>
</ul>
<p>We use them like:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> tree-&gt;Draw<span class="o">(</span><span class="s2">&#34;tel1.Y():tel1.X()&#34;</span>,<span class="s2">&#34;&#34;</span>,<span class="s2">&#34;colz&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> tree-&gt;Draw<span class="o">(</span><span class="s2">&#34;tel1.E(0):tel1.E()&#34;</span>,<span class="s2">&#34;&#34;</span>,<span class="s2">&#34;colz&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> tree-&gt;Draw<span class="o">(</span><span class="s2">&#34;tel1.E():tel1.A()&#34;</span>,<span class="s2">&#34;&#34;</span>,<span class="s2">&#34;colz&#34;</span><span class="o">)</span></span></span></code></pre></div>
            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="f3">F3</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2024-01-22 by Kodai Okawa</span></span>
<p>In the physics run (production run or physics measurement), we check all the detector data like tracking detector (PPAC, MWDC), TOF (RF) and Telescope data.
In order to analyse them, we prepared steering/chkf3.yaml steering file.
This file includes all the information of F3 analysis.</p>
<ul>
<li><a href="https://github.com/okawak/artemis_crib/blob/main/steering/chkf3.yaml" target="_blank">steering/chkf3.yaml</a></li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ artlogin <span class="o">(</span>username<span class="o">)</span>
</span></span><span class="line"><span class="cl">$ a
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>0<span class="o">]</span> add steering/chkf3.yaml <span class="nv">NAME</span><span class="o">=</span>hoge <span class="nv">NUM</span><span class="o">=</span><span class="m">0000</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>1<span class="o">]</span> res
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>2<span class="o">]</span> sus
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>3<span class="o">]</span> ls
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> artemis
</span></span><span class="line"><span class="cl">&gt;   <span class="m">0</span> art::TTreeProjGroup f3check         f3check
</span></span><span class="line"><span class="cl">    <span class="m">1</span> art::TAnalysisInfo analysisInfo
</span></span><span class="line"><span class="cl">    <span class="m">2</span> art::TTreeProjGroup mwdca           mwdca
</span></span><span class="line"><span class="cl">    <span class="m">3</span> art::TTreeProjGroup mwdcb           mwdcb
</span></span><span class="line"><span class="cl">    <span class="m">4</span> art::TTreeProjGroup tel1            tel1
</span></span><span class="line"><span class="cl">    <span class="m">5</span> art::TTreeProjGroup tel2            tel2
</span></span><span class="line"><span class="cl">    <span class="m">6</span> art::TTreeProjGroup tel3            tel3
</span></span><span class="line"><span class="cl">    <span class="m">7</span> art::TTreeProjGroup tel4            tel4
</span></span><span class="line"><span class="cl">    <span class="m">8</span> art::TTreeProjGroup tel5            tel5
</span></span><span class="line"><span class="cl">    <span class="m">9</span> art::TTreeProjGroup tel6            tel6
</span></span><span class="line"><span class="cl">   <span class="m">10</span> art::TTreeProjGroup MUX             MUX
</span></span><span class="line"><span class="cl">   <span class="m">11</span> TDirectory MWDCCalibHists  MWDC calibration
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># this is the situation at 2024/01/22</span></span></span></code></pre></div><p>There are many histogram definition, and you can freely update the histogram files.</p>
<p>Because this file contains most of the knowledge about the steering file, so you can test your own histogram or something based on this file.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ <span class="nb">cd</span> steering
</span></span><span class="line"><span class="cl">$ cp chkf3.yaml chkYourOwnName.yaml
</span></span><span class="line"><span class="cl">$ vi <span class="o">(</span>emacs<span class="o">)</span> chkYourOwnName.yaml
</span></span><span class="line"><span class="cl"><span class="c1"># change or test something</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">$ acd
</span></span><span class="line"><span class="cl">$ a
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>0<span class="o">]</span> add steering/chkYourOwnName.yaml <span class="nv">NAME</span><span class="o">=</span>hoge <span class="nv">NUM</span><span class="o">=</span><span class="m">0000</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>1<span class="o">]</span> res
</span></span><span class="line"><span class="cl">artmeis <span class="o">[</span>2<span class="o">]</span> sus
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># some analysis</span></span></span></code></pre></div>
            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="gate">Gate</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2024-01-17 by Kodai Okawa</span></span>
<p>It is very important to select events for online analysis as well.
There are several options to do so, and I will cover all of them.
If you know other useful way, please let me know.</p>
<ul>
<li>Histogram definition</li>
<li>TCutG object</li>
<li>TGateStopProcessor</li>
</ul>
<p>For clearer understanding, we will use this figure, and we call this as default figure:</p>
<figure><img src="/artemis_crib/example/online_analysis/gate/default.png" width="600"/>
</figure>

<h2 id="histogram-definition">Histogram definition</h2>
<p>We explained in the <a href="/artemis_crib/example/online_analysis/gate/../../../setting/histograms">Histograms</a> page, but again we describe about histogram definition focus on the <code>cut</code> part.</p>
<p>The default figure defined like this:</p>

  
<div class="tab-panel" data-tab-group="a74329e47c7a72dfbefbfd021df4e8fb">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="histf2f2yaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('a74329e47c7a72dfbefbfd021df4e8fb','histf2f2yaml')"
    >
      <span>
        <span class="tab-nav-hidden">hist/f2/f2.yaml</span>
        <span class="tab-nav-text">hist/f2/f2.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="histf2f2yaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">anchor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="cp">&amp;f2ppacx</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;f2ppac.fX&#34;</span><span class="p">,</span><span class="m">200</span><span class="p">,</span>-<span class="m">50</span><span class="l">.,50.]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="cp">&amp;f2ppacy</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;f2ppac.fY&#34;</span><span class="p">,</span><span class="m">200</span><span class="p">,</span>-<span class="m">50</span><span class="l">.,50.]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">alias</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">group</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">f2check</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l">f2_check</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">contents</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">f2PPAC X vs Y</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l">f2ppac X vs Y</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">x</span><span class="p">:</span><span class="w"> </span><span class="cp">*f2ppacx</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">y</span><span class="p">:</span><span class="w"> </span><span class="cp">*f2ppacy</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>For example, let&rsquo;s add the gate to select only &ldquo;-10.0 &lt; X &lt; 10.0&rdquo;.
We can use alias node to define that.</p>

  
<div class="tab-panel" data-tab-group="3b2457897136c410d47b5abd2f66725d">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="histf2f2yaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('3b2457897136c410d47b5abd2f66725d','histf2f2yaml')"
    >
      <span>
        <span class="tab-nav-hidden">hist/f2/f2.yaml</span>
        <span class="tab-nav-text">hist/f2/f2.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="histf2f2yaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">anchor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="cp">&amp;f2ppacx</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;f2ppac.fX&#34;</span><span class="p">,</span><span class="m">200</span><span class="p">,</span>-<span class="m">50</span><span class="l">.,50.]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="cp">&amp;f2ppacy</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;f2ppac.fY&#34;</span><span class="p">,</span><span class="m">200</span><span class="p">,</span>-<span class="m">50</span><span class="l">.,50.]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">alias</span><span class="p">:</span><span class="w">
</span></span></span><span class="line hl"><span class="cl"><span class="w">  </span><span class="nt">centerx</span><span class="p">:</span><span class="w"> </span><span class="l">abs(f2ppac.fX) &lt; 10.0;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">group</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">f2check</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l">f2_check</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">contents</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">f2PPAC X vs Y{centerx}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l">f2ppac X vs Y{centerx}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">x</span><span class="p">:</span><span class="w"> </span><span class="cp">*f2ppacx</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">y</span><span class="p">:</span><span class="w"> </span><span class="cp">*f2ppacy</span><span class="w">
</span></span></span><span class="line hl"><span class="cl"><span class="w">        </span><span class="nt">cut</span><span class="p">:</span><span class="w"> </span><span class="l">centerx</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>Then the following histogram is created.</p>
<figure><img src="/artemis_crib/example/online_analysis/gate/yaml_gate.png" width="600"/>
</figure>

<p>Also, multiple conditions can be specified at the same time.</p>

  
<div class="tab-panel" data-tab-group="3a54746a5dea23fcf5699e51d871ef91">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="histf2f2yaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('3a54746a5dea23fcf5699e51d871ef91','histf2f2yaml')"
    >
      <span>
        <span class="tab-nav-hidden">hist/f2/f2.yaml</span>
        <span class="tab-nav-text">hist/f2/f2.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="histf2f2yaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">anchor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="cp">&amp;f2ppacx</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;f2ppac.fX&#34;</span><span class="p">,</span><span class="m">200</span><span class="p">,</span>-<span class="m">50</span><span class="l">.,50.]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="cp">&amp;f2ppacy</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;f2ppac.fY&#34;</span><span class="p">,</span><span class="m">200</span><span class="p">,</span>-<span class="m">50</span><span class="l">.,50.]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">alias</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">centerx</span><span class="p">:</span><span class="w"> </span><span class="l">abs(f2ppac.fX) &lt; 10.0;</span><span class="w">
</span></span></span><span class="line hl"><span class="cl"><span class="w">  </span><span class="nt">centery</span><span class="p">:</span><span class="w"> </span><span class="l">abs(f2ppac.fY) &lt; 10.0;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">group</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">f2check</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l">f2_check</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">contents</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">f2PPAC X vs Y{centerx &amp;&amp; centery}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l">f2ppac X vs Y{centerx &amp;&amp; centery}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">x</span><span class="p">:</span><span class="w"> </span><span class="cp">*f2ppacx</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">y</span><span class="p">:</span><span class="w"> </span><span class="cp">*f2ppacy</span><span class="w">
</span></span></span><span class="line hl"><span class="cl"><span class="w">        </span><span class="nt">cut</span><span class="p">:</span><span class="w"> </span><span class="l">centerx &amp;&amp; centery</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><figure><img src="/artemis_crib/example/online_analysis/gate/yaml_multigate.png" width="600"/>
</figure>

<h2 id="tcutg-object">TCutG object</h2>
<p>We can also use TCutG object to select the event.
As in <a href="/artemis_crib/example/online_analysis/gate/../../../crib_parts/newcommand">new commands</a> page, let&rsquo;s assume we create this TCutG ROOT file by <code>tcutg</code> command.
And the ROOT file and TCutG object name is <code>f2star</code>.</p>
<figure><img src="/artemis_crib/example/online_analysis/gate/tcutg_raw.png" width="600"/>
</figure>

<p>If you want to use this object to select event, just add this line is fine, as long as you use <a href="/artemis_crib/example/online_analysis/gate/../../../crib_parts/userconfig">userlogon.C</a>.</p>

  
<div class="tab-panel" data-tab-group="906587b8c2388a3528e26c15fb2fa22e">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="histf2f2yaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('906587b8c2388a3528e26c15fb2fa22e','histf2f2yaml')"
    >
      <span>
        <span class="tab-nav-hidden">hist/f2/f2.yaml</span>
        <span class="tab-nav-text">hist/f2/f2.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="histf2f2yaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">anchor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="cp">&amp;f2ppacx</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;f2ppac.fX&#34;</span><span class="p">,</span><span class="m">200</span><span class="p">,</span>-<span class="m">50</span><span class="l">.,50.]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="cp">&amp;f2ppacy</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;f2ppac.fY&#34;</span><span class="p">,</span><span class="m">200</span><span class="p">,</span>-<span class="m">50</span><span class="l">.,50.]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">alias</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">group</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">f2check</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l">f2_check</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">contents</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">f2PPAC X vs Y{f2star}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l">f2ppac X vs Y{f2star}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">x</span><span class="p">:</span><span class="w"> </span><span class="cp">*f2ppacx</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">y</span><span class="p">:</span><span class="w"> </span><span class="cp">*f2ppacy</span><span class="w">
</span></span></span><span class="line hl"><span class="cl"><span class="w">        </span><span class="nt">cut</span><span class="p">:</span><span class="w"> </span><span class="l">f2star</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><figure><img src="/artemis_crib/example/online_analysis/gate/tcutg_star.png" width="600"/>
</figure>

<p>Of course we can use in &ldquo;tree-&gt;Draw()&rdquo; because this TCutG objects are automatically loaded.
The following sentence generate the same figure.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[]</span> fcd <span class="m">0</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[]</span> zo
</span></span><span class="line"><span class="cl">artemis <span class="o">[]</span> tree-&gt;Draw<span class="o">(</span><span class="s2">&#34;f2ppac.fY:f2ppac.fX&gt;&gt;(200,-50.,50., 200,-50.,50.)&#34;</span>,<span class="s2">&#34;f2star&#34;</span>,<span class="s2">&#34;colz&#34;</span><span class="o">)</span></span></span></code></pre></div><h2 id="tgatestopprocessor">TGateStopProcessor</h2>
<p>The method used until now was to process just histograms and analyze them for all events in the event loop.
If you know which events you don&rsquo;t want, there are processors that allow you to skip the event loop under certain conditions.
This may speed up the event loop.</p>
<p>For example. when we want to analyze only <code>beam single</code> event (it means the events are not coincident with SSD, and let&rsquo;s suppose that condition is given by <code>single.fID==0</code>), let&rsquo;s prepare the steering file.</p>

  
<div class="tab-panel" data-tab-group="7d4f38200b73b40fbccefdfb23c0891f">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="steeringgatecoinyaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('7d4f38200b73b40fbccefdfb23c0891f','steeringgatecoinyaml')"
    >
      <span>
        <span class="tab-nav-hidden">steering/gate/coin.yaml</span>
        <span class="tab-nav-text">steering/gate/coin.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="steeringgatecoinyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">Processor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">proc_gateinit</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TGateArrayInitializer</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputTransparency</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">proc_gate</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TTreeFormulaGateProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Definitions</span><span class="p">:</span><span class="w">
</span></span></span><span class="line hl"><span class="cl"><span class="w">        </span>- <span class="s2">&#34;beam_single; single.fID==0&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputTransparency</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Verbose</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">beam_single_gate</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TGateStopProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line hl"><span class="cl"><span class="w">      </span><span class="nt">GateName</span><span class="p">:</span><span class="w"> </span><span class="l">beam_single</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputTransparency</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">StopIf</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Verbose</span><span class="p">:</span><span class="w"> </span><span class="m">1</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>To use TGateStopProcessor, we need to initialize the &ldquo;gate&rdquo; array object, so the first <code>art::TGateArrayInitializer</code> is needed.
In the second processor, <code>art::TTreeFormulaGateProcessor</code>, we define the gate condition.</p>
<p>Then the <code>art::TGateStopProcessor</code> judges the event is skipped or not.
In the case of <code>StopIf: 0</code>, artemis ignore the event that the condition become <code>false</code>.
In other words, <code>StopIf: 0</code> means artemis will analyze the event only when the condition is <code>true</code>.</p>
<p>Then, including this yaml file to the main steering file, you can check only the selected events.</p>

  
<div class="tab-panel" data-tab-group="063dc378e84c91bbffe961a4aa31806e">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="steeringhogeyaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('063dc378e84c91bbffe961a4aa31806e','steeringhogeyaml')"
    >
      <span>
        <span class="tab-nav-hidden">steering/hoge.yaml</span>
        <span class="tab-nav-text">steering/hoge.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="steeringhogeyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">Anchor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="cp">&amp;input</span><span class="w"> </span><span class="l">ridf/@NAME@@NUM@.ridf</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="cp">&amp;output</span><span class="w"> </span><span class="l">output/@NAME@/@NUM@/hoge@NAME@@NUM@.root</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="cp">&amp;histout</span><span class="w"> </span><span class="l">output/@NAME@/@NUM@/hoge@NAME@@NUM@.hist.root</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">Processor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">timer</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TTimerProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">ridf</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TRIDFEventStore</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputTransparency</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">InputFiles</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="cp">*input</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">SHMID</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">mapper</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TMappingProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputTransparency</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># include some other steering files</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line hl"><span class="cl"><span class="w">  </span>- <span class="nt">include</span><span class="p">:</span><span class="w"> </span><span class="l">gate/coin.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">outputtree</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TOutputTreeProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">FileName</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="cp">*output</span></span></span></code></pre></div></div>
    </div>
  </div>
</div>
<div class="box notices cstyle info">
  <div class="box-label"><i class="fa-fw fas fa-info-circle"></i> Info</div>
  <div class="box-content">

<p>We didn&rsquo;t check if we can use the TCutG object in this process&hellip;</p>
</div>
</div>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="shifter-task">Shifter task</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-12-20 by Kodai Okawa</span></span>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="scaler">Scaler</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-12-20 by Kodai Okawa</span></span>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="timestamp">Timestamp</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-12-15 by Kodai Okawa</span></span>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="raw-data-checker">Raw data checker</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2024-01-22 by Kodai Okawa</span></span>
<p>Artemis produces mainly <code>TArtTree</code> and the branches are <code>TClonesArray(art::hoge)</code>.
It means that all objects rely on the artemis library, and we cannot open and check the data by using normal ROOT.</p>
<p>Also, sometimes it is necessary top check the raw data obtained by ADC and TDC as it is.
Of course, the real raw data is binary and therefore difficult to read, so we will check the raw data after the decoders.</p>
<p>Related processors;</p>
<ul>
<li><a href="https://github.com/okawak/artemis_crib/blob/main/src-crib/TSegmentOutputProcessor.cc" target="_blank">TSegmentOutputProcessor.cc</a></li>
<li><a href="https://github.com/okawak/artemis_crib/blob/main/src-crib/TModuleData.cc" target="_blank">TModuleData.cc</a></li>
<li><a href="https://github.com/artemis-dev/artemis/blob/develop/sources/loop/TSegmentCheckProcessor.cc" target="_blank">TSegmentCheckProcessor.cc</a> (in original artemis source)</li>
</ul>
<h2 id="how-to-check-the-raw-data">How to check the raw data</h2>
<h3 id="1-prepare-conf-files">1. prepare conf files</h3>
<p>We already prepared <code>conf/map</code> files, but in this case, we need to prepare <code>conf/seg</code> files.
There are two files.
This is an example, so please change it according to the experimental conditions.</p>

  
<div class="tab-panel" data-tab-group="033a5f8283116a3eea865acab074e65a">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="confsegmodulelistyaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('033a5f8283116a3eea865acab074e65a','confsegmodulelistyaml')"
    >
      <span>
        <span class="tab-nav-hidden">conf/seg/modulelist.yaml</span>
        <span class="tab-nav-text">conf/seg/modulelist.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="confsegmodulelistyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="c">#modulename:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#  id: module id (it is module-specific)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#  ch: channel number</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#  values:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#    - name1: [Nbin: int, min: double, max: double] it is for 2D histogram (these values vs. ch)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#    - name2: [Nbin: int, min: double, max: double] &lt;= somehow two line needed...?</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">MADC32</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="m">32</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">ch</span><span class="p">:</span><span class="w"> </span><span class="m">32</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">values</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">adc</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">4000</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="l">., 4000.]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">tdc</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">4000</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="l">., 4000.]</span><span class="w"> </span><span class="c"># no use, but seems it needed...</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">V1190A</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="m">24</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">ch</span><span class="p">:</span><span class="w"> </span><span class="m">128</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">values</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">tdcL</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">300</span><span class="p">,</span><span class="w"> </span>-<span class="m">5000</span><span class="l">., 300000.]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">tdcT</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">300</span><span class="p">,</span><span class="w"> </span>-<span class="m">5000</span><span class="l">., 300000.]</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>The module id list is <a href="/artemis_crib/example/online_analysis/check_rawdata/../../../example/segid">here</a>.</p>

  
<div class="tab-panel" data-tab-group="0329d2590bc8a7da86fe94552c87b7d2">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="confsegseglistyaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('0329d2590bc8a7da86fe94552c87b7d2','confsegseglistyaml')"
    >
      <span>
        <span class="tab-nav-hidden">conf/seg/seglist.yaml</span>
        <span class="tab-nav-text">conf/seg/seglist.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="confsegseglistyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="c">#segment_name:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># segid: [[dev], [fp], [det]] &lt;= same as a map file</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># type: V7XX &lt;= defined type in modulelist.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># modules:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#   - id: geo1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#   - id: geo2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">V1190</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">segid</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">12</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">7</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">V1190A</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">modules</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">MADC</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">segid</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">12</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">6</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">MADC32</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">modules</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="m">2</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><h3 id="2-use-steeringchksegyaml">2. use &ldquo;steering/chkseg.yaml&rdquo;</h3>
<p>Based on these two conf file, the <code>steering/chkseg.yaml</code> file produce rawdata histograms and TTree object.
We can use <a href="https://github.com/okawak/artemis_crib/blob/main/steering/chkseg.yaml" target="_blank">steering/chkseg.yaml</a> without any change I think.</p>
<p>This is an example from one CRIB experiment.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ a
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>0<span class="o">]</span> add steering/chkseg.yaml <span class="nv">NAME</span><span class="o">=</span>hoge <span class="nv">NUM</span><span class="o">=</span><span class="m">0000</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>1<span class="o">]</span> res
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>2<span class="o">]</span> sus
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>3<span class="o">]</span> ls
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> artemis
</span></span><span class="line"><span class="cl">&gt;   <span class="m">0</span> TDirectory SegmentHistogram art::TSegmentCheckProcessor
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>4<span class="o">]</span> <span class="nb">cd</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>5<span class="o">]</span> ls
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> SegmentHistogram
</span></span><span class="line"><span class="cl">&gt;   <span class="m">0</span> TDirectory E7_V1190        E7_V1190
</span></span><span class="line"><span class="cl">    <span class="m">1</span> TDirectory J1_V785         J1_V785
</span></span><span class="line"><span class="cl">    <span class="m">2</span> TDirectory J1_MADC         J1_MADC
</span></span><span class="line"><span class="cl">    <span class="m">3</span> TDirectory J1_V1190        J1_V1190
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>6<span class="o">]</span> <span class="nb">cd</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>7<span class="o">]</span> ls
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> E7_V1190
</span></span><span class="line"><span class="cl">&gt;   <span class="m">0</span> TH2F E7_V1190_0_tdcL E7_V1190_0_tdcL
</span></span><span class="line"><span class="cl">    <span class="m">1</span> TH2F E7_V1190_0_tdcT E7_V1190_0_tdcT
</span></span><span class="line"><span class="cl">    <span class="m">2</span> TH2F E7_V1190_1_tdcL E7_V1190_1_tdcL
</span></span><span class="line"><span class="cl">    <span class="m">3</span> TH2F E7_V1190_1_tdcT E7_V1190_1_tdcT
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># we can check these histograms by ht command</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>8<span class="o">]</span> fcd <span class="m">0</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>9<span class="o">]</span> br
</span></span><span class="line"><span class="cl">E7_V1190_0           vector&lt;vector&lt;int&gt; &gt;
</span></span><span class="line"><span class="cl">E7_V1190_1           vector&lt;vector&lt;int&gt; &gt;
</span></span><span class="line"><span class="cl">J1_V785_0            vector&lt;int&gt;
</span></span><span class="line"><span class="cl">J1_V785_1            vector&lt;int&gt;
</span></span><span class="line"><span class="cl">J1_V785_2            vector&lt;int&gt;
</span></span><span class="line"><span class="cl">J1_MADC_3            vector&lt;int&gt;
</span></span><span class="line"><span class="cl">J1_MADC_4            vector&lt;int&gt;
</span></span><span class="line"><span class="cl">J1_MADC_5            vector&lt;int&gt;
</span></span><span class="line"><span class="cl">J1_V1190_0           vector&lt;vector&lt;int&gt; &gt;</span></span></code></pre></div>
<div class="box notices cstyle info">
  <div class="box-label"><i class="fa-fw fas fa-info-circle"></i> Info</div>
  <div class="box-content">

<p>If the module ID = 24 or 25, it is multihit TDC, so the branch become 2D vector.
When you want to use std::vector<!-- raw HTML omitted --> method, you can use by &ldquo;@&rdquo; like</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> tree-&gt;Draw<span class="o">(</span><span class="s2">&#34;J1_V785_0@.size()&#34;</span><span class="o">)</span></span></span></code></pre></div></div>
</div>
<p>Of course we can open this output ROOT file from normal ROOT.</p>

            <footer class="footline">

            </footer>
          </article>

          </section>
          <article class="default">
            <header class="headline">
            </header>
<h1 id="offline-analysis">Offline analysis</h1>

<p>This section explain the example of the offline analysis (some useful processors).</p>

<ul class="children children-li children-sort-weight">
	
<li><a href="/artemis_crib/example/offline_analysis/new_processor/index.html">New processors</a></li>
<li><a href="/artemis_crib/example/offline_analysis/merge_files/index.html">Merge files</a></li>
<li><a href="/artemis_crib/example/offline_analysis/python_environment/index.html">Python environment</a></li>
<li><a href="/artemis_crib/example/offline_analysis/pyroot/index.html">pyROOT</a></li>
</ul>

            <footer class="footline">

            </footer>
          </article>

          <section>
            <h1 class="a11y-only">Subsections of Offline analysis</h1>
          <article class="default">
            <header class="headline">
            </header>
<h1 id="new-processors">New processors</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-12-15 by</span></span>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="merge-files">Merge files</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-12-15 by Kodai Okawa</span></span>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="python-environment">Python environment</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-12-15 by Kodai Okawa</span></span>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="pyroot">pyROOT</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-12-15 by Kodai Okawa</span></span>

            <footer class="footline">

            </footer>
          </article>

          </section>
          <article class="default">
            <header class="headline">
            </header>
<h1 id="mc-simulation">MC Simulation</h1>

<p>This section explain the example of the Monte Carlo simulation by using artemis.</p>

<ul class="children children-li children-sort-weight">
	
<li><a href="/artemis_crib/example/simulation/beam_generator/index.html">Beam_generator</a></li>
<li><a href="/artemis_crib/example/simulation/nbodyreaction/index.html">Nbodyreaction</a></li>
<li><a href="/artemis_crib/example/simulation/geometry/index.html">Geometry</a></li>
<li><a href="/artemis_crib/example/simulation/detect_particle/index.html">Detect_particle</a></li>
<li><a href="/artemis_crib/example/simulation/solidangle/index.html">Solidangle</a></li>
</ul>

            <footer class="footline">

            </footer>
          </article>

          <section>
            <h1 class="a11y-only">Subsections of MC Simulation</h1>
          <article class="default">
            <header class="headline">
            </header>
<h1 id="beam_generator">Beam_generator</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-09-29 by Kodai Okawa</span></span>
<p>The previous sections have described how to loop events from a <code>ridf</code> file or <code>root</code> file, but now I will describe how to generate events to use as a simulation.</p>
<p>Requirements:</p>
<ul>
<li>src-crib/simulation/TRandomBeamGenerator</li>
<li>src-crib/simulation/TTreeBeamGenerator</li>
<li>src-crib/simulation/TParticleInfo</li>
</ul>
<hr>
<p>As you know, an &ldquo;event store&rdquo; must be used to analyse the event loop.
For example, in the online analysis, we used <code>TRIDFEventStore</code>, and in the offline analysis, we used <code>TTreeEventStore</code>.</p>
<p>But when we want to simulate something, there are no data file.
In that case, we can use <code>TCounterEventStore</code> or <code>TRandomNumberEventStore</code>.</p>
<ul>
<li>TCounterEventStore: generate numbers in sequence from 0 to N.</li>
<li>TRandomNumberEventStore: generate number from 0.0 to 1.0 randomly.</li>
</ul>
<p>Here I will simply describe a simulation using TCounterEventStore.</p>

<div class="box notices cstyle info">
  <div class="box-label"><i class="fa-fw fas fa-info-circle"></i> Info</div>
  <div class="box-content">

<p>As I explained in <code>CRIB_parts</code> before, in the current artemis version, the TCounterEventStore does not seem to be recognised as EventStore.
So if we use this EventStore, &ldquo;no event store&rdquo; comments will output.
I don&rsquo;t think it makes problem, so it is okay comment out the part of TLoop.cc that prints &ldquo;no event store&rdquo;.
(Possibly a problem with your environment).</p>
</div>
</div>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="nbodyreaction">Nbodyreaction</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-09-29 by Kodai Okawa</span></span>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="geometry">Geometry</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-09-29 by Kodai Okawa</span></span>
<p>In this page, I will explain how to determine the detecter geometry configration.</p>
<p>Requirement:</p>
<ul>
<li><a href="https://github.com/okawak/artemis_crib/blob/main/src-crib/geo/TUserGeoInitializer.h" target="_blank">src-crib/geo/TUserGeoInitializer</a></li>
<li><a href="https://github.com/okawak/artemis_crib/blob/main/src-crib/geo/TUserGeoInitializer.h" target="_blank">src-crib/geo/TDetectorParameter</a></li>
</ul>
<hr>
<p>Firstly, let&rsquo;s prepare the parameter file like this:</p>

  
<div class="tab-panel" data-tab-group="03ccc4945dc20a3fc4dc0f3a44357cb1">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="prmgeoexampleyaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('03ccc4945dc20a3fc4dc0f3a44357cb1','prmgeoexampleyaml')"
    >
      <span>
        <span class="tab-nav-hidden">prm/geo/example.yaml</span>
        <span class="tab-nav-text">prm/geo/example.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="prmgeoexampleyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="wrap-code highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">material</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Vaccum</span><span class="w"> </span><span class="c"># id=0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">atomic_mass</span><span class="p">:</span><span class="w"> </span><span class="m">0.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">atomic_num</span><span class="p">:</span><span class="w"> </span><span class="m">0.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">density</span><span class="p">:</span><span class="w"> </span><span class="m">0.0</span><span class="w"> </span><span class="c"># g/cm3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Si</span><span class="w"> </span><span class="c"># id=1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">atomic_mass</span><span class="p">:</span><span class="w"> </span><span class="m">28.084</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">atomic_num</span><span class="p">:</span><span class="w"> </span><span class="m">14.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">density</span><span class="p">:</span><span class="w"> </span><span class="m">2.321</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># Note: beam axis -&gt; z, upper direction -&gt; y</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">conposition</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">detector</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">tel1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">strip</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="m">16</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">center_rotation</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">0</span><span class="l">., 0., 322.0]</span><span class="w"> </span><span class="c"># mm</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">offset</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">0</span><span class="l">., 0., 0.]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">distance</span><span class="p">:</span><span class="w"> </span><span class="m">244.0</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">angle</span><span class="p">:</span><span class="w"> </span>-<span class="m">4.0</span><span class="w"> </span><span class="c"># deg</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">thickness</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">0.02</span><span class="p">,</span><span class="w"> </span><span class="m">0.301</span><span class="p">,</span><span class="w"> </span><span class="m">1.494</span><span class="p">,</span><span class="w"> </span><span class="m">1.486</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">material</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="l">Si]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">tel2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">strip</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="m">16</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">center_rotation</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">0</span><span class="l">., 0., 322.0]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">offset</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">0</span><span class="l">., 0., 0.]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">distance</span><span class="p">:</span><span class="w"> </span><span class="m">154.5</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">angle</span><span class="p">:</span><span class="w"> </span><span class="m">27.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">thickness</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">0.02</span><span class="p">,</span><span class="w"> </span><span class="m">0.300</span><span class="p">,</span><span class="w"> </span><span class="m">1.494</span><span class="p">,</span><span class="w"> </span><span class="m">1.485</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">material</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="l">Si]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">volume</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">top</span><span class="p">:</span><span class="w"> </span><span class="c"># detector world</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">TOP</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">box</span><span class="w"> </span><span class="c"># now only box is available</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">material</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">size</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">400.0</span><span class="p">,</span><span class="w"> </span><span class="m">200.0</span><span class="p">,</span><span class="w"> </span><span class="m">1288.0</span><span class="p">]</span><span class="w"> </span><span class="c"># mm</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">detector</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">tel1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">box</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">material</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">size</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">50.0</span><span class="p">,</span><span class="w"> </span><span class="m">50.0</span><span class="p">,</span><span class="w"> </span><span class="m">1.0</span><span class="p">]</span><span class="w"> </span><span class="c"># mm</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">tel2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">box</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">material</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">size</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">50.0</span><span class="p">,</span><span class="w"> </span><span class="m">50.0</span><span class="p">,</span><span class="w"> </span><span class="m">1.0</span><span class="p">]</span><span class="w"> </span><span class="c"># mm</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>There are many components to explain!
The <code>material</code> node is used to define <code>TGeoMaterial</code> and <code>TGeoMedium</code> classes.
(But they are not directly used.)
From <strong>name</strong> to <strong>density</strong> node are used to make a instance of this object.
This values are not used in the current processors.</p>
<p>The next <code>conposition</code> node define the detector configuration!
General telescopes of the CRIB experiment consist of <strong>DSSSD</strong> and <strong>SSD</strong> (single-pad),
and the node below defines the SSD of the telescope.</p>
<ul>
<li>name: Name of the telescope. For example tel1, tel2, and so on.</li>
<li>strip: X x Y strip number. It is defined as an array like [16, 32], this means X:16 strips and Y:32 strips</li>
<li>thickness: Thickness of the each layer. If there are two layer, the size of the array become two. You can add to any size. The unit is <strong>mm</strong>.</li>
<li>material: material of the each layer. The string is used in <code>SRIMlib</code> calculation. This node is defined as a array for each layer, but if it is one, the same material is applied. For example, in example.yaml, [Si] means [Si, Si, Si, Si]. (You need to prepare SRIMlib setting beforehand!)</li>
</ul>
<p>Let&rsquo;s move on to the geometry part!
The node is <code>center_rotation</code>, <code>offset</code>, <code>distance</code> and <code>angle</code>.
Please look at this figure.</p>
<figure><img src="/artemis_crib/example/simulation/geometry/../geo_example.png"/>
</figure>

<p>Please not that the center_rotation and offset are defined in (x, y, z) coordinate (-&gt; [x, y, z]), but distance and angle is scalar value.
The unit of length is <code>mm</code>, angle is <code>deg</code>.</p>

<div class="box notices cstyle info">
  <div class="box-label"><i class="fa-fw fas fa-info-circle"></i> Info</div>
  <div class="box-content">

<p>The sign of the angle is defined as positive at this figure.
And generally, we set z=0 at target position. (For the gas target, we set 0 at window position.)</p>
</div>
</div>
<p>The last part is <code>volume</code> node!
In this parts, the shape of the detector will be defined by using <code>TGeoVolume</code> class.
The TGeoVolume needs <strong>name</strong>, <strong>type</strong>, <strong>material</strong> and <strong>size</strong>.
For the type, I only prepared &ldquo;box&rdquo;. (It means the code use only vol-&gt;MakeBox method.)</p>
<p>The first <code>top</code> node must be set because it defined &ldquo;detector world&rdquo;.
Generally, the material is okay to set vaccum.
And the material is defined in the <code>material</code> node, and the id (the order) can be used.
So the format is like <code>material: 0</code>.
And the size is generally set to the size of the scattering chamber, but for the safety, it is okay to set larger number.
Also the unit is <code>mm</code> and format is (x, y, z).</p>
<p>Next, at the <code>volume/detector</code> node, we can define the detector size.
Please NOTE that the name should be the same with <code>conposition/detector/name</code> node.</p>
<hr>
<p>Then, let&rsquo;s check if the parameter file can be correctly used!
Please prepare the steering file.</p>

  
<div class="tab-panel" data-tab-group="dd88cc89137d368e2814d87f85def995">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="steeringgeo_exampleyaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('dd88cc89137d368e2814d87f85def995','steeringgeo_exampleyaml')"
    >
      <span>
        <span class="tab-nav-hidden">steering/geo_example.yaml</span>
        <span class="tab-nav-text">steering/geo_example.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="steeringgeo_exampleyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="wrap-code highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">Anchor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">Processor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">detector_initialize</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TUserGeoInitializer</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">Name</span><span class="p">:</span><span class="w"> </span><span class="l">prm_detector</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">FileName</span><span class="p">:</span><span class="w"> </span><span class="l">prm/geo/example.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">OutputTransparency</span><span class="p">:</span><span class="w"> </span><span class="m">1</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>This steering file doesn&rsquo;t use event loop.
Just we want to check the parameter file works well or not.</p>
<p>Then let&rsquo;s see in the artemis!</p>
<div class="wrap-code highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">acd
</span></span><span class="line"><span class="cl">a
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">-- snip --
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>0<span class="o">]</span> add steering/geo_example.yaml
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">-- snip --
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>1<span class="o">]</span> ls
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> artemis
</span></span><span class="line"><span class="cl">&gt;   <span class="m">0</span> TGeoVolume TOP             Top volume
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>2<span class="o">]</span></span></span></code></pre></div><p>The detector geometry object is successfully generated!
In order to check the object, please use <a href="https://github.com/okawak/artemis_crib/blob/main/src-crib/commands/TCmdDraw.cc" target="_blank">draw</a> command for example.
(It is defined only in CRIB artemis, to draw not only histogram object. This is under development.)</p>
<div class="wrap-code highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>2<span class="o">]</span> draw <span class="m">0</span></span></span></code></pre></div><figure><img src="/artemis_crib/example/simulation/geometry/../geo_canvas.png"/>
</figure>

<p>The red box is the TOP, and the black boxes are detectors.
If the detector is placed where you expect it to be, the parameters have been successfully set!</p>
<p>In the event loop process, if you want to use the detector geometry information, you can use <code>prm_detector</code> in the steering files.
I will explain the next session!</p>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="detect_particle">Detect_particle</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-09-29 by Kodai Okawa</span></span>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="solidangle">Solidangle</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-09-29 by KodaiOkawa</span></span>
<ul>
<li>Beam_generator</li>
<li>Nbodyreaction</li>
<li>Geometry</li>
<li>Detect_particle</li>
</ul>
<p>As an application of the above four sections, I would like to explain how to calculate solid angles using Monte Carlo methods!</p>

            <footer class="footline">

            </footer>
          </article>

          </section>
          </section>
          <article class="chapter">
            <header class="headline">
            </header>
<div class="article-subheading">Chapter 5</div>
<h1 id="qa">Q&amp;A</h1>

<h3 id="cannot-be-analysed-in-online-mode">Cannot be analysed in online mode&hellip;</h3>
<p>When you start the event loop in online mode and artemis gets stuck, <code>babian</code> may not have been activated.
There is a shellscript to run the &ldquo;babian&rdquo; in cribana PC.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">~/bin/run_babian
</span></span><span class="line"><span class="cl">ps aux <span class="p">|</span> grep babi <span class="c1"># check if the &#34;babian&#34; process is working or not</span></span></span></code></pre></div><hr>
<h3 id="chkridf-command-shows-rev-dev-fp-det-and-mod-id-but-they-are-different-from-map-file-configuration">&ldquo;chkridf&rdquo; command shows &ldquo;Rev&rdquo;, &ldquo;Dev&rdquo;, &ldquo;FP&rdquo;, &ldquo;Det&rdquo; and &ldquo;Mod&rdquo; ID, but they are different from map file configuration&hellip;?</h3>
<p>chkridf command shows like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">chkridf hoge.ridf</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-plain" data-lang="plain"><span class="line"><span class="cl">-- snip --
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">:
</span></span><span class="line"><span class="cl">Segment Header / blkn=1
</span></span><span class="line"><span class="cl">hd1 = 0x2100004c
</span></span><span class="line"><span class="cl">ly=2, cid=4, size=76, efn=120
</span></span><span class="line"><span class="cl">Segment ID = 12600853 (0x00c04615)
</span></span><span class="line hl"><span class="cl">Rev 0 / Dev 12 / FP  1 / Det 6 / Mod 21
</span></span><span class="line"><span class="cl">2000 0200 4072 0000 406c 0010 405f 0001
</span></span><span class="line"><span class="cl">4068 0011 406a 0002 4053 0012 4058 0003
</span></span><span class="line"><span class="cl">4058 0013 4051 0004 4066 0014 404d 0005
</span></span><span class="line"><span class="cl">4047 0015 4045 0006 4056 0016 405a 0007
</span></span><span class="line"><span class="cl">404b 0017 4050 0008 406c 0018 404b 0009
</span></span><span class="line"><span class="cl">4069 0019 4059 000a 4051 001a 404e 000b
</span></span><span class="line"><span class="cl">405f 001b 4064 000c 4052 001c 4033 000d
</span></span><span class="line"><span class="cl">4055 001d 4064 000e 4067 001e 4043 000f
</span></span><span class="line"><span class="cl">4052 001f 1dd2 0401 1dd2 0601
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">-- snip --</span></span></code></pre></div><hr>
<h3 id="conflicts-occurred-with-git-operations">Conflicts occurred with Git operations</h3>
<p>If you forgot to &ldquo;git pull&rdquo; and you have already modified the files, you will get conflicts.
If you think it is okay to forget your modified file, please command like</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git stash</span></span></code></pre></div><p>and</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git pull</span></span></code></pre></div><p>And you want to recover your modified file,</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ git stash pop</span></span></code></pre></div><p>Then you encounter the conficts again, and please select the code you want to keep, and git push again.
For the detail, please check <a href="/artemis_crib/q_and_a/../example/preparation/git">here</a>.</p>

            <footer class="footline">

            </footer>
          </article>

          </section>
        </div>
      </main>
    </div>
    <script src="/artemis_crib/js/clipboard.min.js?1707539174" defer></script>
    <script src="/artemis_crib/js/perfect-scrollbar.min.js?1707539174" defer></script>
    <script>
      function useMathJax( config ){
        if( !Object.assign ){
          
          return;
        }
        window.MathJax = Object.assign( window.MathJax || {}, {
          loader: {
            load: ['[tex]/mhchem']
          },
          startup: {
            elements: [
              '.math'
            ]
          },
          tex: {
            inlineMath: [
              ['$', '$'], 
              ['\\(', '\\)']
            ]
          },
          options: {
            enableMenu: false 
          }
        }, config );
      }
      useMathJax( JSON.parse("{}") );
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="/artemis_crib/js/d3/d3-color.min.js?1707539174" defer></script>
    <script src="/artemis_crib/js/d3/d3-dispatch.min.js?1707539174" defer></script>
    <script src="/artemis_crib/js/d3/d3-drag.min.js?1707539174" defer></script>
    <script src="/artemis_crib/js/d3/d3-ease.min.js?1707539174" defer></script>
    <script src="/artemis_crib/js/d3/d3-interpolate.min.js?1707539174" defer></script>
    <script src="/artemis_crib/js/d3/d3-selection.min.js?1707539174" defer></script>
    <script src="/artemis_crib/js/d3/d3-timer.min.js?1707539174" defer></script>
    <script src="/artemis_crib/js/d3/d3-transition.min.js?1707539174" defer></script>
    <script src="/artemis_crib/js/d3/d3-zoom.min.js?1707539174" defer></script>
    <script src="/artemis_crib/js/js-yaml.min.js?1707539174" defer></script>
    <script src="/artemis_crib/js/mermaid.min.js?1707539174" defer></script>
    <script>
      window.themeUseMermaid = JSON.parse("{}");
    </script>
    <script src="/artemis_crib/js/theme.js?1707539174" defer></script>
  </body>
</html>
