<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.121.2">
    <meta name="generator" content="Relearn 5.22.0">
    <meta name="description" content="">
    <meta name="author" content="Kodai Okawa">
    <title>Check raw data :: CRIB artemis</title>
    <link href="https://okawak.github.io/artemis_crib/example/online_analysis/check_rawdata/index.html" rel="canonical" type="text/html" title="Check raw data :: CRIB artemis">
    <link href="/artemis_crib/example/online_analysis/check_rawdata/index.xml" rel="alternate" type="application/rss+xml" title="Check raw data :: CRIB artemis"><link rel="icon" href="/artemis_crib/images/crib_overlay.png" type="image/png">

    <!-- https://github.com/filamentgroup/loadCSS/blob/master/README.md#how-to-use -->
    <link href="/artemis_crib/css/fontawesome-all.min.css?1704980285" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/artemis_crib/css/fontawesome-all.min.css?1704980285" rel="stylesheet"></noscript>
    <link href="/artemis_crib/css/nucleus.css?1704980285" rel="stylesheet">
    <link href="/artemis_crib/css/auto-complete.css?1704980285" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/artemis_crib/css/auto-complete.css?1704980285" rel="stylesheet"></noscript>
    <link href="/artemis_crib/css/perfect-scrollbar.min.css?1704980285" rel="stylesheet">
    <link href="/artemis_crib/css/fonts.css?1704980285" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/artemis_crib/css/fonts.css?1704980285" rel="stylesheet"></noscript>
    <link href="/artemis_crib/css/theme.css?1704980285" rel="stylesheet">
    <link href="/artemis_crib/css/theme-artemis_crib.css?1704980285" rel="stylesheet" id="R-variant-style">
    <link href="/artemis_crib/css/variant.css?1704980285" rel="stylesheet">
    <link href="/artemis_crib/css/print.css?1704980285" rel="stylesheet" media="print">
    <link href="/artemis_crib/css/format-print.css?1704980285" rel="stylesheet">
    <link href="/artemis_crib/css/ie.css?1704980285" rel="stylesheet">
    <script src="/artemis_crib/js/url.js?1704980285"></script>
    <script src="/artemis_crib/js/variant.js?1704980285"></script>
    <script>
      // hack to let hugo tell us how to get to the root when using relativeURLs, it needs to be called *url= for it to do its magic:
      // https://github.com/gohugoio/hugo/blob/145b3fcce35fbac25c7033c91c1b7ae6d1179da8/transform/urlreplacers/absurlreplacer.go#L72
      window.index_js_url="/artemis_crib/index.search.js";
      var root_url="/";
      var baseUri=root_url.replace(/\/$/, '');
      // translations
      window.T_Copy_to_clipboard = 'Copy to clipboard';
      window.T_Copied_to_clipboard = 'Copied to clipboard!';
      window.T_Copy_link_to_clipboard = 'Copy link to clipboard';
      window.T_Link_copied_to_clipboard = 'Copied link to clipboard!';
      window.T_Reset_view = 'Reset view';
      window.T_No_results_found = 'No results found for \u0022{0}\u0022';
      window.T_N_results_found = '{1} results found for \u0022{0}\u0022';
      // some further base stuff
      var baseUriFull='https:\/\/okawak.github.io\/artemis_crib/';
      window.variants && variants.init( [ 'artemis_crib' ] );
    </script>

  
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-MZF67K577Y"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'G-MZF67K577Y');
  </script>
  


  </head>
  <body class="mobile-support print" data-url="/artemis_crib/example/online_analysis/check_rawdata/index.html">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide">
              <button class="topbar-control" onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)">
                <i class="fa-fw fas fa-bars"></i>
              </button>
            </div>
          </div>
          <ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype="http://schema.org/BreadcrumbList"><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="/artemis_crib/example/index.html"><span itemprop="name">Example</span></a><meta itemprop="position" content="1">&nbsp;>&nbsp;</li><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="/artemis_crib/example/online_analysis/index.html"><span itemprop="name">Online analysis</span></a><meta itemprop="position" content="2">&nbsp;>&nbsp;</li><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><span itemprop="name">Check raw data</span><meta itemprop="position" content="3"></li>
          </ol>
          <div class="topbar-area topbar-area-end" data-area="end">
          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable default" tabindex="-1">
        <div class="flex-block-wrapper">
          <article class="default">
            <header class="headline">
            </header>
<h1 id="check-raw-data">Check raw data</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2024-01-11 by Kodai Okawa</span></span>
<p>Artemis produces mainly <code>TArtTree</code> and the branches are <code>TClonesArray(art::hoge)</code>.
It means that all objects rely on the artemis library, and we cannot open and check the data by using normal ROOT.</p>
<p>Also, sometimes it is necessary top check the raw data obtained by ADC and TDC as it is.
Of course, the real raw data is binary and therefore difficult to read, so we will check the raw data after the decoders.</p>
<p>Related processors;</p>
<ul>
<li><a href="https://github.com/okawak/artemis_crib/blob/main/src-crib/TSegmentOutputProcessor.cc" target="_blank">TSegmentOutputProcessor.cc</a></li>
<li><a href="https://github.com/okawak/artemis_crib/blob/main/src-crib/TModuleData.cc" target="_blank">TModuleData.cc</a></li>
<li><a href="https://github.com/artemis-dev/artemis/blob/develop/sources/loop/TSegmentCheckProcessor.cc" target="_blank">TSegmentCheckProcessor.cc</a> (in original artemis source)</li>
</ul>
<h2 id="how-to-check-the-raw-data">How to check the raw data</h2>
<h3 id="1-prepare-conf-files">1. prepare conf files</h3>
<p>We already prepared <code>conf/map</code> files, but in this case, we need to prepare <code>conf/seg</code> files.
There are two files.
This is an example, so please change it according to the experimental conditions.</p>

  
<div class="tab-panel" data-tab-group="1bea6321d1e5eb810066796f824ff2bd">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="confsegmodulelistyaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('1bea6321d1e5eb810066796f824ff2bd','confsegmodulelistyaml')"
    >
      <span>
        <span class="tab-nav-hidden">conf/seg/modulelist.yaml</span>
        <span class="tab-nav-text">conf/seg/modulelist.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="confsegmodulelistyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#75715e">#modulename:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  id: module id (it is module-specific)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  ch: channel number</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  values:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#    - name1: [Nbin: int, min: double, max: double] it is for 2D histogram (these values vs. ch)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#    - name2: [Nbin: int, min: double, max: double] &lt;= somehow two line needed...?</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">MADC32</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">id</span>: <span style="color:#ae81ff">32</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">ch</span>: <span style="color:#ae81ff">32</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">values</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">adc</span>: [<span style="color:#ae81ff">4000</span>, <span style="color:#ae81ff">0</span><span style="color:#ae81ff">., 4000.]</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">tdc</span>: [<span style="color:#ae81ff">4000</span>, <span style="color:#ae81ff">0</span><span style="color:#ae81ff">., 4000.]</span> <span style="color:#75715e"># no use, but seems it needed...</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">V1190A</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">id</span>: <span style="color:#ae81ff">24</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">ch</span>: <span style="color:#ae81ff">128</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">values</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">tdcL</span>: [<span style="color:#ae81ff">300</span>, -<span style="color:#ae81ff">5000</span><span style="color:#ae81ff">., 300000.]</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">tdcT</span>: [<span style="color:#ae81ff">300</span>, -<span style="color:#ae81ff">5000</span><span style="color:#ae81ff">., 300000.]</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>The module id list is <a href="/artemis_crib/example/online_analysis/check_rawdata/../../../example/segid">here</a>.</p>

  
<div class="tab-panel" data-tab-group="8d820c6b53c45361a1dd51090025a7ad">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="confsegseglistyaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('8d820c6b53c45361a1dd51090025a7ad','confsegseglistyaml')"
    >
      <span>
        <span class="tab-nav-hidden">conf/seg/seglist.yaml</span>
        <span class="tab-nav-text">conf/seg/seglist.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="confsegseglistyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#75715e">#segment_name:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># segid: [[dev], [fp], [det]] &lt;= same as a map file</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># type: V7XX &lt;= defined type in modulelist.yaml</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># modules:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   - id: geo1</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   - id: geo2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">V1190</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">segid</span>: [<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">7</span>]
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">type</span>: <span style="color:#ae81ff">V1190A</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">modules</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">id</span>: <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">id</span>: <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">MADC</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">segid</span>: [<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">6</span>]
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">type</span>: <span style="color:#ae81ff">MADC32</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">modules</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">id</span>: <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">id</span>: <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">id</span>: <span style="color:#ae81ff">2</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><h3 id="2-use-steeringchksegyaml">2. use &ldquo;steering/chkseg.yaml&rdquo;</h3>
<p>Based on these two conf file, the <code>steering/chkseg.yaml</code> file produce rawdata histograms and TTree object.
We can use <a href="https://github.com/okawak/artemis_crib/blob/main/steering/chkseg.yaml" target="_blank">steering/chkseg.yaml</a> without any change I think.</p>
<p>This is an example from one CRIB experiment.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ a
</span></span><span style="display:flex;"><span>artemis <span style="color:#f92672">[</span>0<span style="color:#f92672">]</span> add steering/chkseg.yaml NAME<span style="color:#f92672">=</span>hoge NUM<span style="color:#f92672">=</span><span style="color:#ae81ff">0000</span>
</span></span><span style="display:flex;"><span>artemis <span style="color:#f92672">[</span>1<span style="color:#f92672">]</span> res
</span></span><span style="display:flex;"><span>artemis <span style="color:#f92672">[</span>2<span style="color:#f92672">]</span> sus
</span></span><span style="display:flex;"><span>artemis <span style="color:#f92672">[</span>3<span style="color:#f92672">]</span> ls
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> artemis
</span></span><span style="display:flex;"><span>&gt;   <span style="color:#ae81ff">0</span> TDirectory SegmentHistogram art::TSegmentCheckProcessor
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>artemis <span style="color:#f92672">[</span>4<span style="color:#f92672">]</span> cd <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>artemis <span style="color:#f92672">[</span>5<span style="color:#f92672">]</span> ls
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> SegmentHistogram
</span></span><span style="display:flex;"><span>&gt;   <span style="color:#ae81ff">0</span> TDirectory E7_V1190        E7_V1190
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">1</span> TDirectory J1_V785         J1_V785
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">2</span> TDirectory J1_MADC         J1_MADC
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">3</span> TDirectory J1_V1190        J1_V1190
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>artemis <span style="color:#f92672">[</span>6<span style="color:#f92672">]</span> cd <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>artemis <span style="color:#f92672">[</span>7<span style="color:#f92672">]</span> ls
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> E7_V1190
</span></span><span style="display:flex;"><span>&gt;   <span style="color:#ae81ff">0</span> TH2F E7_V1190_0_tdcL E7_V1190_0_tdcL
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">1</span> TH2F E7_V1190_0_tdcT E7_V1190_0_tdcT
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">2</span> TH2F E7_V1190_1_tdcL E7_V1190_1_tdcL
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">3</span> TH2F E7_V1190_1_tdcT E7_V1190_1_tdcT
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># we can check these histograms by ht command</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>artemis <span style="color:#f92672">[</span>8<span style="color:#f92672">]</span> fcd <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>artemis <span style="color:#f92672">[</span>9<span style="color:#f92672">]</span> br
</span></span><span style="display:flex;"><span>E7_V1190_0           vector&lt;vector&lt;int&gt; &gt;
</span></span><span style="display:flex;"><span>E7_V1190_1           vector&lt;vector&lt;int&gt; &gt;
</span></span><span style="display:flex;"><span>J1_V785_0            vector&lt;int&gt;
</span></span><span style="display:flex;"><span>J1_V785_1            vector&lt;int&gt;
</span></span><span style="display:flex;"><span>J1_V785_2            vector&lt;int&gt;
</span></span><span style="display:flex;"><span>J1_MADC_3            vector&lt;int&gt;
</span></span><span style="display:flex;"><span>J1_MADC_4            vector&lt;int&gt;
</span></span><span style="display:flex;"><span>J1_MADC_5            vector&lt;int&gt;
</span></span><span style="display:flex;"><span>J1_V1190_0           vector&lt;vector&lt;int&gt; &gt;</span></span></code></pre></div>
<div class="box notices cstyle info">
  <div class="box-label"><i class="fa-fw fas fa-info-circle"></i> Info</div>
  <div class="box-content">

<p>If the module ID = 24 or 25, it is multihit TDC, so the branch become 2D vector.
When you want to use std::vector<!-- raw HTML omitted --> method, you can use by &ldquo;@&rdquo; like</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>artemis <span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> tree-&gt;Draw<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;J1_V785_0@.size()&#34;</span><span style="color:#f92672">)</span></span></span></code></pre></div></div>
</div>
<p>Of course we can open this output ROOT file from normal ROOT.</p>

            <footer class="footline">

            </footer>
          </article>

        </div>
      </main>
    </div>
    <script src="/artemis_crib/js/clipboard.min.js?1704980285" defer></script>
    <script src="/artemis_crib/js/perfect-scrollbar.min.js?1704980285" defer></script>
    <script>
      function useMathJax( config ){
        if( !Object.assign ){
          
          return;
        }
        window.MathJax = Object.assign( window.MathJax || {}, {
          loader: {
            load: ['[tex]/mhchem']
          },
          startup: {
            elements: [
              '.math'
            ]
          },
          tex: {
            inlineMath: [
              ['$', '$'], 
              ['\\(', '\\)']
            ]
          },
          options: {
            enableMenu: false 
          }
        }, config );
      }
      useMathJax( JSON.parse("{}") );
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="/artemis_crib/js/theme.js?1704980285" defer></script>
  </body>
</html>
