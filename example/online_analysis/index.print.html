<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.121.2">
    <meta name="generator" content="Relearn 5.22.0">
    <meta name="description" content="">
    <meta name="author" content="Kodai Okawa">
    <title>Online analysis :: CRIB artemis</title>
    <link href="https://okawak.github.io/artemis_crib/example/online_analysis/index.html" rel="canonical" type="text/html" title="Online analysis :: CRIB artemis">
    <link href="/artemis_crib/example/online_analysis/index.xml" rel="alternate" type="application/rss+xml" title="Online analysis :: CRIB artemis"><link rel="icon" href="/artemis_crib/images/crib_overlay.png" type="image/png">

    <!-- https://github.com/filamentgroup/loadCSS/blob/master/README.md#how-to-use -->
    <link href="/artemis_crib/css/fontawesome-all.min.css?1705116300" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/artemis_crib/css/fontawesome-all.min.css?1705116300" rel="stylesheet"></noscript>
    <link href="/artemis_crib/css/nucleus.css?1705116300" rel="stylesheet">
    <link href="/artemis_crib/css/auto-complete.css?1705116300" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/artemis_crib/css/auto-complete.css?1705116300" rel="stylesheet"></noscript>
    <link href="/artemis_crib/css/perfect-scrollbar.min.css?1705116300" rel="stylesheet">
    <link href="/artemis_crib/css/fonts.css?1705116300" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/artemis_crib/css/fonts.css?1705116300" rel="stylesheet"></noscript>
    <link href="/artemis_crib/css/theme.css?1705116300" rel="stylesheet">
    <link href="/artemis_crib/css/theme-artemis_crib.css?1705116300" rel="stylesheet" id="R-variant-style">
    <link href="/artemis_crib/css/variant.css?1705116300" rel="stylesheet">
    <link href="/artemis_crib/css/print.css?1705116300" rel="stylesheet" media="print">
    <link href="/artemis_crib/css/format-print.css?1705116300" rel="stylesheet">
    <link href="/artemis_crib/css/ie.css?1705116300" rel="stylesheet">
    <script src="/artemis_crib/js/url.js?1705116300"></script>
    <script src="/artemis_crib/js/variant.js?1705116300"></script>
    <script>
      // hack to let hugo tell us how to get to the root when using relativeURLs, it needs to be called *url= for it to do its magic:
      // https://github.com/gohugoio/hugo/blob/145b3fcce35fbac25c7033c91c1b7ae6d1179da8/transform/urlreplacers/absurlreplacer.go#L72
      window.index_js_url="/artemis_crib/index.search.js";
      var root_url="/";
      var baseUri=root_url.replace(/\/$/, '');
      // translations
      window.T_Copy_to_clipboard = 'Copy to clipboard';
      window.T_Copied_to_clipboard = 'Copied to clipboard!';
      window.T_Copy_link_to_clipboard = 'Copy link to clipboard';
      window.T_Link_copied_to_clipboard = 'Copied link to clipboard!';
      window.T_Reset_view = 'Reset view';
      window.T_No_results_found = 'No results found for \u0022{0}\u0022';
      window.T_N_results_found = '{1} results found for \u0022{0}\u0022';
      // some further base stuff
      var baseUriFull='https:\/\/okawak.github.io\/artemis_crib/';
      window.variants && variants.init( [ 'artemis_crib' ] );
    </script>

  
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-MZF67K577Y"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'G-MZF67K577Y');
  </script>
  


  </head>
  <body class="mobile-support print" data-url="/artemis_crib/example/online_analysis/index.html">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide">
              <button class="topbar-control" onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)">
                <i class="fa-fw fas fa-bars"></i>
              </button>
            </div>
          </div>
          <ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype="http://schema.org/BreadcrumbList"><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="/artemis_crib/example/index.html"><span itemprop="name">Example</span></a><meta itemprop="position" content="1">&nbsp;>&nbsp;</li><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><span itemprop="name">Online analysis</span><meta itemprop="position" content="2"></li>
          </ol>
          <div class="topbar-area topbar-area-end" data-area="end">
          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable default" tabindex="-1">
        <div class="flex-block-wrapper">
          <article class="default">
            <header class="headline">
            </header>
<h1 id="online-analysis">Online analysis</h1>

<p>This section explain the example of the online analysis in the CRIB experiment.</p>

<ul class="children children-li children-sort-weight">
	
<li><a href="/artemis_crib/example/online_analysis/f1/index.html">F1</a></li>
<li><a href="/artemis_crib/example/online_analysis/pid/index.html">PID</a></li>
<li><a href="/artemis_crib/example/online_analysis/f2/index.html">F2</a></li>
<li><a href="/artemis_crib/example/online_analysis/ppac/index.html">PPAC</a></li>
<li><a href="/artemis_crib/example/online_analysis/mwdc/index.html">MWDC</a></li>
<li><a href="/artemis_crib/example/online_analysis/ssd/index.html">SSD</a></li>
<li><a href="/artemis_crib/example/online_analysis/f3/index.html">F3</a></li>
<li><a href="/artemis_crib/example/online_analysis/gate/index.html">Gate</a></li>
<li><a href="/artemis_crib/example/online_analysis/shift/index.html">Shifter task</a></li>
<li><a href="/artemis_crib/example/online_analysis/scaler/index.html">Scaler</a></li>
<li><a href="/artemis_crib/example/online_analysis/timestamp/index.html">Timestamp</a></li>
<li><a href="/artemis_crib/example/online_analysis/check_rawdata/index.html">Check raw data</a></li>
</ul>

            <footer class="footline">

            </footer>
          </article>

          <section>
            <h1 class="a11y-only">Subsections of Online analysis</h1>
          <article class="default">
            <header class="headline">
            </header>
<h1 id="f1">F1</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-12-13 by Kodai Okawa</span></span>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="pid">PID</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-12-20 by Kodai Okawa</span></span>
<p>This is almost the same with <a href="https://www.cns.s.u-tokyo.ac.jp/crib/cgi-bin/pid/CRIB_PID_calc.html" target="_blank">this web application</a>.
This web application uses <code>enewz</code> energy loss calculation, but PID using artemis uses <code>SRIM</code>.</p>
<p>These are the source code for the PID calculation.</p>
<ul>
<li><a href="https://github.com/okawak/artemis_crib/blob/main/src-crib/simulation/TCRIBPIDProcessor.cc" target="_blank">TCRIBPIDProcessor.cc</a></li>
<li><a href="https://github.com/okawak/artemis_crib/blob/main/src-crib/simulation/TCRIBPIDProcessor.h" target="_blank">TCRIBPIDProcessor.h</a></li>
</ul>
<h3 id="principles">Principles</h3>
<p>The simple principle of PID (Particle IDentification) is described.</p>
<p>First, the energies of the various beam ions are determined from the value of the magnetic rigidity (
<span class="math align-center">$B\rho$</span>) of the dipole magnets.
The values are then calculated using relativity.</p>

<span class="math align-center">$$ m_0\gamma\frac{v^2}{\rho} = qevB $$
$$ B\rho = \frac{m_0\gamma\beta c}{qe} $$
$$ \frac{B\rho qe}{c} = m_0\frac{\beta}{\sqrt{1-\beta^2}} $$</span><p>From this equation, solving for 
<span class="math align-center">$\beta^2$</span>,</p>

<span class="math align-center">$$ \beta^2 = \frac{1}{1+\left( \frac{m_0 c}{B\rho qe} \right)^2} $$
$$ \frac{1}{\sqrt{1-\beta^2}} = \sqrt{1+\left( \frac{B\rho qe}{m_0 c} \right)^2} $$</span><p>Relativistic energy 
<span class="math align-center">$E$</span> is</p>

<span class="math align-center">$$ E = \frac{m_0 c^2}{\sqrt{1-\beta^2}} $$
$$ E^2 = \left(m_0 c^2\right)^2 + \left( B\rho qec \right)^2 $$</span><p>Therefore, from this equation, 
<span class="math align-center">$E$</span> can be obtained from 
<span class="math align-center">$B\rho$</span> and the kinetic energy can be derived from the following relationship.</p>

<span class="math align-center">$$ E = E_{kin} + m_0 c^2 $$
$$ E_{kin} = m_0 c^2\left( \sqrt{1+\left( \frac{B\rho qec}{m_0 c^2} \right)^2} -1 \right) $$</span><p>The equation for determining velocity from energy using relativity can also be obtained as follows.</p>

<span class="math align-center">$$ E_{kin} + m_0 c^2 = \frac{m_0 c^2}{\sqrt{1-\left(\frac{v}{c}\right)^2}} $$
$$ v = c\sqrt{1-\left( \frac{1}{\frac{E_{kin}}{m_0 c^2} +1} \right)^2} $$</span><p>The energy loss of the detector placed on the beamline is then calculated and the PID diagram is obtained by plotting the possible measured values using these relationships.</p>
<h3 id="usage">Usage</h3>
<p>First, please prepare the SRIMlib dataset.
You need all input ion for &ldquo;mylar&rdquo; and &ldquo;Si&rdquo; target energy loss table.
For the SRIMlib setting, please refer <a href="https://okawak.github.io/artemis_crib/installation/energyloss_calculator/index.html" target="_blank">this page</a>.</p>
<p>Next, you need input ions and beamline parameter files.
The format is like this.</p>

  
<div class="tab-panel" data-tab-group="0ba8e03659cd2c6896a38a8de0afa4a7">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="prmpidexpnameyaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('0ba8e03659cd2c6896a38a8de0afa4a7','prmpidexpnameyaml')"
    >
      <span>
        <span class="tab-nav-hidden">prm/pid/expname.yaml</span>
        <span class="tab-nav-text">prm/pid/expname.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="prmpidexpnameyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">input_ions</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">7Li3</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">charge</span>: <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">mass</span>: <span style="color:#ae81ff">7.01435758</span> <span style="color:#75715e"># amu</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">color</span>: <span style="color:#ae81ff">0</span> <span style="color:#75715e"># 0 -&gt; red, 1 -&gt; blue, 2 -&gt; black</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">6He2</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">charge</span>: <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">mass</span>: <span style="color:#ae81ff">6.01778863</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">color</span>: <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">3H1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">charge</span>: <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">mass</span>: <span style="color:#ae81ff">3.015500905</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">color</span>: <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">2H1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">charge</span>: <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">mass</span>: <span style="color:#ae81ff">2.013553496</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">color</span>: <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">1H1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">charge</span>: <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">mass</span>: <span style="color:#ae81ff">1.007276452</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">color</span>: <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">4He2</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">charge</span>: <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">mass</span>: <span style="color:#ae81ff">4.001506094</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">color</span>: <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># BLD parameters</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">f1_parameters</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">brho</span>: <span style="color:#ae81ff">1.227</span> <span style="color:#75715e"># Tm</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">rf_period</span>: <span style="color:#ae81ff">57.0</span> <span style="color:#75715e"># ns</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">f2_parameters</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">PPAC_thickness</span>: <span style="color:#ae81ff">10.0</span> <span style="color:#75715e"># um, mylar</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">SSD_thickness</span>: <span style="color:#ae81ff">1500.0</span> <span style="color:#75715e"># um</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">f3_parameters</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">a_thickness</span>: <span style="color:#ae81ff">15.0</span> <span style="color:#75715e"># um, mylar, PPACa/MWDCa</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">b_thickness</span>: <span style="color:#ae81ff">15.0</span> <span style="color:#75715e"># um, mylar, PPACb/MWDCb</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">distance</span>: <span style="color:#ae81ff">290.5</span> <span style="color:#75715e"># mm, between two tracking detectors</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">trigger</span>: <span style="color:#ae81ff">0</span> <span style="color:#75715e"># PPACa/MWDCa -&gt; 0, PPACb/MWDCb -&gt; 1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># display parameters</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">f2_display</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">rf_offset</span>: -<span style="color:#ae81ff">6.5</span> <span style="color:#75715e"># ns</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">rf_range</span>: [<span style="color:#ae81ff">0.0</span>, <span style="color:#ae81ff">120.0</span>] <span style="color:#75715e"># ns</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">energy_range</span>: [<span style="color:#ae81ff">0.0</span>, <span style="color:#ae81ff">100.0</span>] <span style="color:#75715e"># MeV</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">f3_display</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">rf_offset</span>: -<span style="color:#ae81ff">12.0</span> <span style="color:#75715e"># ns</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">tof_offset</span>: -<span style="color:#ae81ff">2.7</span> <span style="color:#75715e"># ns</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">rf_range</span>: [<span style="color:#ae81ff">0.0</span>, <span style="color:#ae81ff">120.0</span>] <span style="color:#75715e"># ns</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">tof_range</span>: [<span style="color:#ae81ff">0.0</span>, <span style="color:#ae81ff">8.0</span>] <span style="color:#75715e"># ns</span></span></span></code></pre></div></div>
    </div>
  </div>
</div>
<div class="box notices cstyle info">
  <div class="box-label"><i class="fa-fw fas fa-info-circle"></i> Info</div>
  <div class="box-content">

<p>You can add the beam ions freely, but you need to prepare SRIM Output table.</p>
</div>
</div>
<p>Lastly, let&rsquo;s prepare the steering file.
If you want to do only PID calculation, you can use <code>chkpid.yaml</code>.</p>

  
<div class="tab-panel" data-tab-group="8079a1d25d00eff394c5c4bdf31eee6b">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="steeringchkpidyaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('8079a1d25d00eff394c5c4bdf31eee6b','steeringchkpidyaml')"
    >
      <span>
        <span class="tab-nav-hidden">steering/chkpid.yaml</span>
        <span class="tab-nav-text">steering/chkpid.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="steeringchkpidyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">Processor</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">pid</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">type</span>: <span style="color:#ae81ff">art::TCRIBPIDProcessor</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">parameter</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">FileName</span>: <span style="color:#ae81ff">prm/pid/expname.yaml</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">Batch</span>: <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">OutputTransparency</span>: <span style="color:#ae81ff">1</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>You can add these sentences for any other steering files.
I think it is useful when you want to overlap the data figure and calculation figure.
If you set <code>Batch: false</code>, the canvases for F2 PID and F3 PID will appear automatically.
<code>Batch: true</code> is quiet mode.</p>
<p>This is an example of the automatically generated figure.</p>
<figure><img src="/artemis_crib/example/online_analysis/pid/auto.png" width="600"/>
</figure>

<p>The process for the calculation is performed in init process (I mean not event loop), so when you <code>add</code> the steering file, the figure will be created.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>&gt; acd
</span></span><span style="display:flex;"><span>&gt; a
</span></span><span style="display:flex;"><span>artemis <span style="color:#f92672">[</span>0<span style="color:#f92672">]</span> add steering/chkpid.yaml
</span></span><span style="display:flex;"><span><span style="color:#75715e"># process is performed now</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># if Batch: false, the two PID figure will appear automatically </span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>artemis <span style="color:#f92672">[</span>1<span style="color:#f92672">]</span> ls
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> artemis
</span></span><span style="display:flex;"><span>&gt;   <span style="color:#ae81ff">0</span> TDirectory pid             pid       
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>artemis <span style="color:#f92672">[</span>2<span style="color:#f92672">]</span> cd <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>artemis <span style="color:#f92672">[</span>3<span style="color:#f92672">]</span> ls
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> pid
</span></span><span style="display:flex;"><span>&gt;   <span style="color:#ae81ff">0</span> TMultiGraph                 F2_PID; F2 RF <span style="color:#f92672">[</span>ns<span style="color:#f92672">]</span>; F2 SSD <span style="color:#f92672">[</span>MeV<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">1</span> TMultiGraph                 F3_PID; F3 RF <span style="color:#f92672">[</span>ns<span style="color:#f92672">]</span>; PPACs/MWDCs TOF <span style="color:#f92672">[</span>ns<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">2</span> TCanvas F2_canvas       F2_canvas 
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">3</span> TCanvas F3_canvas       F3_canvas 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>artemis <span style="color:#f92672">[</span>4<span style="color:#f92672">]</span> draw <span style="color:#ae81ff">0</span></span></span></code></pre></div><figure><img src="/artemis_crib/example/online_analysis/pid/multigraph.png" width="600"/>
</figure>


<div class="box notices cstyle info">
  <div class="box-label"><i class="fa-fw fas fa-info-circle"></i> Info</div>
  <div class="box-content">

<p>There are two kinds of object, <code>TMultiGraph</code> and <code>TCanvas</code>.
The <code>ht</code> command cannot draw these object, so I also made <code>draw</code> command to be able to draw &ldquo;TMultiGraph&rdquo; objects.</p>
<p>HOWEVER, even this &ldquo;draw&rdquo; command cannot display the &ldquo;TCanvas&rdquo; object yet&hellip;
If you save the object using <code>hstore</code> command or check from THttpServer, you can check the TCanvas objects.</p>
</div>
</div>
<p>This &ldquo;TMultiGraph&rdquo; object is useful when you want to overlay th data.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>artemis <span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> ht something <span style="color:#75715e"># this is gaussian example</span>
</span></span><span style="display:flex;"><span>artemis <span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> dr <span style="color:#ae81ff">0</span> p same</span></span></code></pre></div><figure><img src="/artemis_crib/example/online_analysis/pid/overlap.png" width="600"/>
</figure>


            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="f2">F2</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-12-20 by Kodai Okawa</span></span>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="ppac">PPAC</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-12-20 by Kodai Okawa</span></span>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="mwdc">MWDC</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-12-20 by Kodai Okawa</span></span>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="ssd">SSD</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-12-20 by Kodai Okawa</span></span>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="f3">F3</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-12-20 by Kodai Okawa</span></span>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="gate">Gate</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-12-20 by Kodai Okawa</span></span>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="shifter-task">Shifter task</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-12-20 by Kodai Okawa</span></span>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="scaler">Scaler</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-12-20 by Kodai Okawa</span></span>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="timestamp">Timestamp</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-12-15 by Kodai Okawa</span></span>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="check-raw-data">Check raw data</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2024-01-11 by Kodai Okawa</span></span>
<p>Artemis produces mainly <code>TArtTree</code> and the branches are <code>TClonesArray(art::hoge)</code>.
It means that all objects rely on the artemis library, and we cannot open and check the data by using normal ROOT.</p>
<p>Also, sometimes it is necessary top check the raw data obtained by ADC and TDC as it is.
Of course, the real raw data is binary and therefore difficult to read, so we will check the raw data after the decoders.</p>
<p>Related processors;</p>
<ul>
<li><a href="https://github.com/okawak/artemis_crib/blob/main/src-crib/TSegmentOutputProcessor.cc" target="_blank">TSegmentOutputProcessor.cc</a></li>
<li><a href="https://github.com/okawak/artemis_crib/blob/main/src-crib/TModuleData.cc" target="_blank">TModuleData.cc</a></li>
<li><a href="https://github.com/artemis-dev/artemis/blob/develop/sources/loop/TSegmentCheckProcessor.cc" target="_blank">TSegmentCheckProcessor.cc</a> (in original artemis source)</li>
</ul>
<h2 id="how-to-check-the-raw-data">How to check the raw data</h2>
<h3 id="1-prepare-conf-files">1. prepare conf files</h3>
<p>We already prepared <code>conf/map</code> files, but in this case, we need to prepare <code>conf/seg</code> files.
There are two files.
This is an example, so please change it according to the experimental conditions.</p>

  
<div class="tab-panel" data-tab-group="b3f1ed3c7050777da91a40c0979c3d70">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="confsegmodulelistyaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('b3f1ed3c7050777da91a40c0979c3d70','confsegmodulelistyaml')"
    >
      <span>
        <span class="tab-nav-hidden">conf/seg/modulelist.yaml</span>
        <span class="tab-nav-text">conf/seg/modulelist.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="confsegmodulelistyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#75715e">#modulename:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  id: module id (it is module-specific)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  ch: channel number</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  values:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#    - name1: [Nbin: int, min: double, max: double] it is for 2D histogram (these values vs. ch)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#    - name2: [Nbin: int, min: double, max: double] &lt;= somehow two line needed...?</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">MADC32</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">id</span>: <span style="color:#ae81ff">32</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">ch</span>: <span style="color:#ae81ff">32</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">values</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">adc</span>: [<span style="color:#ae81ff">4000</span>, <span style="color:#ae81ff">0</span><span style="color:#ae81ff">., 4000.]</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">tdc</span>: [<span style="color:#ae81ff">4000</span>, <span style="color:#ae81ff">0</span><span style="color:#ae81ff">., 4000.]</span> <span style="color:#75715e"># no use, but seems it needed...</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">V1190A</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">id</span>: <span style="color:#ae81ff">24</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">ch</span>: <span style="color:#ae81ff">128</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">values</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">tdcL</span>: [<span style="color:#ae81ff">300</span>, -<span style="color:#ae81ff">5000</span><span style="color:#ae81ff">., 300000.]</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">tdcT</span>: [<span style="color:#ae81ff">300</span>, -<span style="color:#ae81ff">5000</span><span style="color:#ae81ff">., 300000.]</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>The module id list is <a href="/artemis_crib/example/online_analysis/check_rawdata/../../../example/segid">here</a>.</p>

  
<div class="tab-panel" data-tab-group="308967398991bb69e561f77c621d14dd">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="confsegseglistyaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('308967398991bb69e561f77c621d14dd','confsegseglistyaml')"
    >
      <span>
        <span class="tab-nav-hidden">conf/seg/seglist.yaml</span>
        <span class="tab-nav-text">conf/seg/seglist.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="confsegseglistyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#75715e">#segment_name:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># segid: [[dev], [fp], [det]] &lt;= same as a map file</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># type: V7XX &lt;= defined type in modulelist.yaml</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># modules:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   - id: geo1</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   - id: geo2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">V1190</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">segid</span>: [<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">7</span>]
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">type</span>: <span style="color:#ae81ff">V1190A</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">modules</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">id</span>: <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">id</span>: <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">MADC</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">segid</span>: [<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">6</span>]
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">type</span>: <span style="color:#ae81ff">MADC32</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">modules</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">id</span>: <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">id</span>: <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">id</span>: <span style="color:#ae81ff">2</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><h3 id="2-use-steeringchksegyaml">2. use &ldquo;steering/chkseg.yaml&rdquo;</h3>
<p>Based on these two conf file, the <code>steering/chkseg.yaml</code> file produce rawdata histograms and TTree object.
We can use <a href="https://github.com/okawak/artemis_crib/blob/main/steering/chkseg.yaml" target="_blank">steering/chkseg.yaml</a> without any change I think.</p>
<p>This is an example from one CRIB experiment.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ a
</span></span><span style="display:flex;"><span>artemis <span style="color:#f92672">[</span>0<span style="color:#f92672">]</span> add steering/chkseg.yaml NAME<span style="color:#f92672">=</span>hoge NUM<span style="color:#f92672">=</span><span style="color:#ae81ff">0000</span>
</span></span><span style="display:flex;"><span>artemis <span style="color:#f92672">[</span>1<span style="color:#f92672">]</span> res
</span></span><span style="display:flex;"><span>artemis <span style="color:#f92672">[</span>2<span style="color:#f92672">]</span> sus
</span></span><span style="display:flex;"><span>artemis <span style="color:#f92672">[</span>3<span style="color:#f92672">]</span> ls
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> artemis
</span></span><span style="display:flex;"><span>&gt;   <span style="color:#ae81ff">0</span> TDirectory SegmentHistogram art::TSegmentCheckProcessor
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>artemis <span style="color:#f92672">[</span>4<span style="color:#f92672">]</span> cd <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>artemis <span style="color:#f92672">[</span>5<span style="color:#f92672">]</span> ls
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> SegmentHistogram
</span></span><span style="display:flex;"><span>&gt;   <span style="color:#ae81ff">0</span> TDirectory E7_V1190        E7_V1190
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">1</span> TDirectory J1_V785         J1_V785
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">2</span> TDirectory J1_MADC         J1_MADC
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">3</span> TDirectory J1_V1190        J1_V1190
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>artemis <span style="color:#f92672">[</span>6<span style="color:#f92672">]</span> cd <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>artemis <span style="color:#f92672">[</span>7<span style="color:#f92672">]</span> ls
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> E7_V1190
</span></span><span style="display:flex;"><span>&gt;   <span style="color:#ae81ff">0</span> TH2F E7_V1190_0_tdcL E7_V1190_0_tdcL
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">1</span> TH2F E7_V1190_0_tdcT E7_V1190_0_tdcT
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">2</span> TH2F E7_V1190_1_tdcL E7_V1190_1_tdcL
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">3</span> TH2F E7_V1190_1_tdcT E7_V1190_1_tdcT
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># we can check these histograms by ht command</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>artemis <span style="color:#f92672">[</span>8<span style="color:#f92672">]</span> fcd <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>artemis <span style="color:#f92672">[</span>9<span style="color:#f92672">]</span> br
</span></span><span style="display:flex;"><span>E7_V1190_0           vector&lt;vector&lt;int&gt; &gt;
</span></span><span style="display:flex;"><span>E7_V1190_1           vector&lt;vector&lt;int&gt; &gt;
</span></span><span style="display:flex;"><span>J1_V785_0            vector&lt;int&gt;
</span></span><span style="display:flex;"><span>J1_V785_1            vector&lt;int&gt;
</span></span><span style="display:flex;"><span>J1_V785_2            vector&lt;int&gt;
</span></span><span style="display:flex;"><span>J1_MADC_3            vector&lt;int&gt;
</span></span><span style="display:flex;"><span>J1_MADC_4            vector&lt;int&gt;
</span></span><span style="display:flex;"><span>J1_MADC_5            vector&lt;int&gt;
</span></span><span style="display:flex;"><span>J1_V1190_0           vector&lt;vector&lt;int&gt; &gt;</span></span></code></pre></div>
<div class="box notices cstyle info">
  <div class="box-label"><i class="fa-fw fas fa-info-circle"></i> Info</div>
  <div class="box-content">

<p>If the module ID = 24 or 25, it is multihit TDC, so the branch become 2D vector.
When you want to use std::vector<!-- raw HTML omitted --> method, you can use by &ldquo;@&rdquo; like</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>artemis <span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> tree-&gt;Draw<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;J1_V785_0@.size()&#34;</span><span style="color:#f92672">)</span></span></span></code></pre></div></div>
</div>
<p>Of course we can open this output ROOT file from normal ROOT.</p>

            <footer class="footline">

            </footer>
          </article>

          </section>
        </div>
      </main>
    </div>
    <script src="/artemis_crib/js/clipboard.min.js?1705116300" defer></script>
    <script src="/artemis_crib/js/perfect-scrollbar.min.js?1705116300" defer></script>
    <script>
      function useMathJax( config ){
        if( !Object.assign ){
          
          return;
        }
        window.MathJax = Object.assign( window.MathJax || {}, {
          loader: {
            load: ['[tex]/mhchem']
          },
          startup: {
            elements: [
              '.math'
            ]
          },
          tex: {
            inlineMath: [
              ['$', '$'], 
              ['\\(', '\\)']
            ]
          },
          options: {
            enableMenu: false 
          }
        }, config );
      }
      useMathJax( JSON.parse("{}") );
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="/artemis_crib/js/theme.js?1705116300" defer></script>
  </body>
</html>
