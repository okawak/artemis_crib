<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.121.2">
    <meta name="generator" content="Relearn 5.22.0">
    <meta name="description" content="Documentation for CRIB artemis">
    <meta name="author" content="map[name:Kodai Okawa]">
    <title>Online analysis :: CRIB artemis</title>
    <link href="https://okawak.github.io/artemis_crib/example/online_analysis/index.html" rel="canonical" type="text/html" title="Online analysis :: CRIB artemis">
    <link href="/artemis_crib/example/online_analysis/index.xml" rel="alternate" type="application/rss+xml" title="Online analysis :: CRIB artemis"><link rel="icon" href="/artemis_crib/images/crib_overlay.png" type="image/png">

    <!-- https://github.com/filamentgroup/loadCSS/blob/master/README.md#how-to-use -->
    <link href="/artemis_crib/css/fontawesome-all.min.css?1705762586" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/artemis_crib/css/fontawesome-all.min.css?1705762586" rel="stylesheet"></noscript>
    <link href="/artemis_crib/css/nucleus.css?1705762586" rel="stylesheet">
    <link href="/artemis_crib/css/auto-complete.css?1705762586" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/artemis_crib/css/auto-complete.css?1705762586" rel="stylesheet"></noscript>
    <link href="/artemis_crib/css/perfect-scrollbar.min.css?1705762586" rel="stylesheet">
    <link href="/artemis_crib/css/fonts.css?1705762586" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/artemis_crib/css/fonts.css?1705762586" rel="stylesheet"></noscript>
    <link href="/artemis_crib/css/theme.css?1705762586" rel="stylesheet">
    <link href="/artemis_crib/css/theme-CRIB-theme.css?1705762586" rel="stylesheet" id="R-variant-style">
    <link href="/artemis_crib/css/variant.css?1705762586" rel="stylesheet">
    <link href="/artemis_crib/css/print.css?1705762586" rel="stylesheet" media="print">
    <link href="/artemis_crib/css/format-print.css?1705762586" rel="stylesheet">
    <link href="/artemis_crib/css/ie.css?1705762586" rel="stylesheet">
    <script src="/artemis_crib/js/url.js?1705762586"></script>
    <script src="/artemis_crib/js/variant.js?1705762586"></script>
    <script>
      // hack to let hugo tell us how to get to the root when using relativeURLs, it needs to be called *url= for it to do its magic:
      // https://github.com/gohugoio/hugo/blob/145b3fcce35fbac25c7033c91c1b7ae6d1179da8/transform/urlreplacers/absurlreplacer.go#L72
      window.index_js_url="/artemis_crib/index.search.js";
      var root_url="/";
      var baseUri=root_url.replace(/\/$/, '');
      // translations
      window.T_Copy_to_clipboard = 'Copy to clipboard';
      window.T_Copied_to_clipboard = 'Copied to clipboard!';
      window.T_Copy_link_to_clipboard = 'Copy link to clipboard';
      window.T_Link_copied_to_clipboard = 'Copied link to clipboard!';
      window.T_Reset_view = 'Reset view';
      window.T_No_results_found = 'No results found for \u0022{0}\u0022';
      window.T_N_results_found = '{1} results found for \u0022{0}\u0022';
      // some further base stuff
      var baseUriFull='https:\/\/okawak.github.io\/artemis_crib/';
      window.variants && variants.init( [ 'CRIB-theme', 'relearn-auto', 'relearn-dark', 'zen-dark', 'learn' ] );
    </script>

  
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-MZF67K577Y"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'G-MZF67K577Y');
  </script>
  


  </head>
  <body class="mobile-support print" data-url="/artemis_crib/example/online_analysis/index.html">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide">
              <button class="topbar-control" onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)">
                <i class="fa-fw fas fa-bars"></i>
              </button>
            </div>
          </div>
          <ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype="http://schema.org/BreadcrumbList"><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="/artemis_crib/example/index.html"><span itemprop="name">Example</span></a><meta itemprop="position" content="1">&nbsp;>&nbsp;</li><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><span itemprop="name">Online analysis</span><meta itemprop="position" content="2"></li>
          </ol>
          <div class="topbar-area topbar-area-end" data-area="end">
          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable default" tabindex="-1">
        <div class="flex-block-wrapper">
          <article class="default">
            <header class="headline">
            </header>
<h1 id="online-analysis">Online analysis</h1>

<p>This section explain the example of the online analysis in the CRIB experiment.</p>

<ul class="children children-li children-sort-weight">
	
<li><a href="/artemis_crib/example/online_analysis/f1/index.html">F1</a></li>
<li><a href="/artemis_crib/example/online_analysis/pid/index.html">Beam PID</a></li>
<li><a href="/artemis_crib/example/online_analysis/f2/index.html">F2</a></li>
<li><a href="/artemis_crib/example/online_analysis/ppac/index.html">PPAC</a></li>
<li><a href="/artemis_crib/example/online_analysis/mwdc/index.html">MWDC</a></li>
<li><a href="/artemis_crib/example/online_analysis/ssd/index.html">SSD</a></li>
<li><a href="/artemis_crib/example/online_analysis/f3/index.html">F3</a></li>
<li><a href="/artemis_crib/example/online_analysis/gate/index.html">Gate</a></li>
<li><a href="/artemis_crib/example/online_analysis/shift/index.html">Shifter task</a></li>
<li><a href="/artemis_crib/example/online_analysis/scaler/index.html">Scaler</a></li>
<li><a href="/artemis_crib/example/online_analysis/timestamp/index.html">Timestamp</a></li>
<li><a href="/artemis_crib/example/online_analysis/check_rawdata/index.html">Check raw data</a></li>
</ul>

            <footer class="footline">

            </footer>
          </article>

          <section>
            <h1 class="a11y-only">Subsections of Online analysis</h1>
          <article class="default">
            <header class="headline">
            </header>
<h1 id="f1">F1</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2024-01-20 by Kodai Okawa</span></span>
<p>From here, we would like to explain in detail how to analyze the actual experiment.
We assume that you have already prepared your the analysis environment.
It is okay either your own directory or the default directory (<a href="/artemis_crib/example/online_analysis/f1/../../../crib_parts/environment">see CRIB configuration</a>).
If you are not ready yet, please see <a href="/artemis_crib/example/online_analysis/f1/../../preparation/basic">here</a>.</p>
<p>So let&rsquo;s start to check the data.
At the F1 focal plane, there is (charge-divition) PPAC.
The steering file to analyze f1 data is <code>chkf1.yaml</code>.</p>
<ul>
<li><a href="https://github.com/okawak/artemis_crib/blob/main/steering/chkf1.yaml" target="_blank">steering/chkf1.yaml</a></li>
</ul>
<p>We usually use &ldquo;chk&rdquo; (check) as a prefix of the steering files to analyze from raw binaly data.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ artlogin <span class="o">(</span>username<span class="o">)</span>
</span></span><span class="line"><span class="cl">$ a
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>0<span class="o">]</span> add steering/chkf1.yaml <span class="nv">NAME</span><span class="o">=</span>hoge <span class="nv">NUM</span><span class="o">=</span><span class="m">0000</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>1<span class="o">]</span> res</span></span></code></pre></div><p>The important data is &ldquo;X position&rdquo; at the F1PPAC.
The histogram can be check by following step:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>2<span class="o">]</span> sus
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>3<span class="o">]</span> ls
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> artemis
</span></span><span class="line"><span class="cl">&gt;   <span class="m">0</span> art::TTreeProjGroup f1check         f1_check
</span></span><span class="line"><span class="cl">    <span class="m">1</span> art::TAnalysisInfo analysisInfo
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>4<span class="o">]</span> <span class="nb">cd</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>5<span class="o">]</span> ls
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> f1check
</span></span><span class="line"><span class="cl">&gt;   <span class="m">0</span> art::TH1FTreeProj f1ppac_X        f1ppac X
</span></span><span class="line"><span class="cl">    <span class="m">1</span> art::TH1FTreeProj f1ppac_Y        f1ppac Y
</span></span><span class="line"><span class="cl">    <span class="m">2</span> art::TH1FTreeProj f1ppac_X1raw    f1ppac X1raw
</span></span><span class="line"><span class="cl">    <span class="m">3</span> art::TH1FTreeProj f1ppac_X2raw    f1ppac X2raw
</span></span><span class="line"><span class="cl">    <span class="m">4</span> art::TH1FTreeProj f1ppac_Y1raw    f1ppac Y1raw
</span></span><span class="line"><span class="cl">    <span class="m">5</span> art::TH1FTreeProj f1ppac_Y2raw    f1ppac Y2raw
</span></span><span class="line"><span class="cl">    <span class="m">6</span> art::TH2FTreeProj f1ppac_x_y      f1ppac X vs Y
</span></span><span class="line"><span class="cl">    <span class="m">7</span> art::TH2FTreeProj f1ppac_x_rf     f1ppac X vs RF
</span></span><span class="line"><span class="cl">    <span class="m">8</span> art::TH2FTreeProj f1ppac_x1_x2    f1ppac x1 vs x2
</span></span><span class="line"><span class="cl">    <span class="m">9</span> art::TH2FTreeProj f1ppac_y1_y2    f1ppac y1 vs y2</span></span></code></pre></div><p>Many histograms are defined, but in practice it&rsquo;s enough to check the first X position.
Sometimes we check other raw data histograms to see if the behavior of F1PPAC is correct or not.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>6<span class="o">]</span> ht <span class="m">0</span></span></span></code></pre></div><p>Usually a gaussian fit is performed to get center the position.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>7<span class="o">]</span> xf</span></span></code></pre></div><p>For the commane &ldquo;xf&rdquo; (xfitg), please check <a href="/artemis_crib/example/online_analysis/f1/../../../crib_parts/newcommand">here</a>.</p>
<p>When you think the signals from F1PPAC is okay, but position seems wrong (the X position is different from the setting of F1 slit), pleace modify the parameter files.</p>
<ul>
<li><a href="https://github.com/okawak/artemis_crib/blob/main/prm/ppac/ch2q.prm" target="_blank">prm/ppac/ch2q.prm</a></li>
<li><a href="https://github.com/okawak/artemis_crib/blob/main/prm/ppac/f1ppac.yaml" target="_blank">prm/ppac/f1ppac.yaml</a></li>
</ul>
<p>It is actually charge-divition PPAC, but the structure of parameter file is the same with dl-PPAC, so please also check <a href="/artemis_crib/example/online_analysis/f1/../../preparation/ppac_calibration">PPAC preparation</a>.</p>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="beam-pid">Beam PID</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2024-01-20 by Kodai Okawa</span></span>
<p>In the F2 focal plane, we check the secondary beam condition.
In other words, identify the beam particles we want and adjust the beamline parameters to get the most amount of the beam particle.
Therefore, we need to identify the beam ion from the data.
To do so, we perform simulation.</p>
<p>This is almost the same with <a href="https://www.cns.s.u-tokyo.ac.jp/crib/cgi-bin/pid/CRIB_PID_calc.html" target="_blank">this web application</a>.
This web application uses <code>enewz</code> energy loss calculation, but PID using artemis uses <code>SRIM</code>.</p>
<p>These are the source code for the PID calculation.</p>
<ul>
<li><a href="https://github.com/okawak/artemis_crib/blob/main/src-crib/simulation/TCRIBPIDProcessor.cc" target="_blank">TCRIBPIDProcessor.cc</a></li>
<li><a href="https://github.com/okawak/artemis_crib/blob/main/src-crib/simulation/TCRIBPIDProcessor.h" target="_blank">TCRIBPIDProcessor.h</a></li>
</ul>
<h3 id="principles">Principles</h3>
<p>The simple principle of PID (Particle IDentification) is described.</p>
<p>First, the energies of the various beam ions are determined from the value of the magnetic rigidity (
<span class="math align-center">$B\rho$</span>) of the dipole magnets.
The values are then calculated using relativity.</p>

<span class="math align-center">$$ m_0\gamma\frac{v^2}{\rho} = qevB $$
$$ B\rho = \frac{m_0\gamma\beta c}{qe} $$
$$ \frac{B\rho qe}{c} = m_0\frac{\beta}{\sqrt{1-\beta^2}} $$</span><p>From this equation, solving for 
<span class="math align-center">$\beta^2$</span>,</p>

<span class="math align-center">$$ \beta^2 = \frac{1}{1+\left( \frac{m_0 c}{B\rho qe} \right)^2} $$
$$ \frac{1}{\sqrt{1-\beta^2}} = \sqrt{1+\left( \frac{B\rho qe}{m_0 c} \right)^2} $$</span><p>Relativistic energy 
<span class="math align-center">$E$</span> is</p>

<span class="math align-center">$$ E = \frac{m_0 c^2}{\sqrt{1-\beta^2}} $$
$$ E^2 = \left(m_0 c^2\right)^2 + \left( B\rho qec \right)^2 $$</span><p>Therefore, from this equation, 
<span class="math align-center">$E$</span> can be obtained from 
<span class="math align-center">$B\rho$</span> and the kinetic energy can be derived from the following relationship.</p>

<span class="math align-center">$$ E = E_{kin} + m_0 c^2 $$
$$ E_{kin} = m_0 c^2\left( \sqrt{1+\left( \frac{B\rho qec}{m_0 c^2} \right)^2} -1 \right) $$</span><p>The equation for determining velocity from energy using relativity can also be obtained as follows.</p>

<span class="math align-center">$$ E_{kin} + m_0 c^2 = \frac{m_0 c^2}{\sqrt{1-\left(\frac{v}{c}\right)^2}} $$
$$ v = c\sqrt{1-\left( \frac{1}{\frac{E_{kin}}{m_0 c^2} +1} \right)^2} $$</span><p>The energy loss of the detector placed on the beamline is then calculated and the PID diagram is obtained by plotting the possible measured values using these relationships.</p>
<h3 id="usage">Usage</h3>
<p>First, please prepare the SRIMlib dataset.
You need all input ion for &ldquo;mylar&rdquo; and &ldquo;Si&rdquo; target energy loss table.
For the SRIMlib setting, please refer <a href="https://okawak.github.io/artemis_crib/installation/energyloss_calculator/index.html" target="_blank">this page</a>.</p>
<p>Next, you need input ions and beamline parameter files.
The format is like this.</p>

  
<div class="tab-panel" data-tab-group="b8ab03132fe1eb5f86bb2a530b86f2fc">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="prmpidexpnameyaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('b8ab03132fe1eb5f86bb2a530b86f2fc','prmpidexpnameyaml')"
    >
      <span>
        <span class="tab-nav-hidden">prm/pid/expname.yaml</span>
        <span class="tab-nav-text">prm/pid/expname.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="prmpidexpnameyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">input_ions</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">7Li3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">charge</span><span class="p">:</span><span class="w"> </span><span class="m">3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">mass</span><span class="p">:</span><span class="w"> </span><span class="m">7.01435758</span><span class="w"> </span><span class="c"># amu</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">color</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="c"># 0 -&gt; red, 1 -&gt; blue, 2 -&gt; black</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">6He2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">charge</span><span class="p">:</span><span class="w"> </span><span class="m">2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">mass</span><span class="p">:</span><span class="w"> </span><span class="m">6.01778863</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">color</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">3H1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">charge</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">mass</span><span class="p">:</span><span class="w"> </span><span class="m">3.015500905</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">color</span><span class="p">:</span><span class="w"> </span><span class="m">2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">2H1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">charge</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">mass</span><span class="p">:</span><span class="w"> </span><span class="m">2.013553496</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">color</span><span class="p">:</span><span class="w"> </span><span class="m">2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">1H1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">charge</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">mass</span><span class="p">:</span><span class="w"> </span><span class="m">1.007276452</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">color</span><span class="p">:</span><span class="w"> </span><span class="m">2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">4He2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">charge</span><span class="p">:</span><span class="w"> </span><span class="m">2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">mass</span><span class="p">:</span><span class="w"> </span><span class="m">4.001506094</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">color</span><span class="p">:</span><span class="w"> </span><span class="m">2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># BLD parameters</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">f1_parameters</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">brho</span><span class="p">:</span><span class="w"> </span><span class="m">1.227</span><span class="w"> </span><span class="c"># Tm</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">rf_period</span><span class="p">:</span><span class="w"> </span><span class="m">57.0</span><span class="w"> </span><span class="c"># ns</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">f2_parameters</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">PPAC_thickness</span><span class="p">:</span><span class="w"> </span><span class="m">10.0</span><span class="w"> </span><span class="c"># um, mylar</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">SSD_thickness</span><span class="p">:</span><span class="w"> </span><span class="m">1500.0</span><span class="w"> </span><span class="c"># um</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">f3_parameters</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">a_thickness</span><span class="p">:</span><span class="w"> </span><span class="m">15.0</span><span class="w"> </span><span class="c"># um, mylar, PPACa/MWDCa</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">b_thickness</span><span class="p">:</span><span class="w"> </span><span class="m">15.0</span><span class="w"> </span><span class="c"># um, mylar, PPACb/MWDCb</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">distance</span><span class="p">:</span><span class="w"> </span><span class="m">290.5</span><span class="w"> </span><span class="c"># mm, between two tracking detectors</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">trigger</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="c"># PPACa/MWDCa -&gt; 0, PPACb/MWDCb -&gt; 1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># display parameters</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">f2_display</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">rf_offset</span><span class="p">:</span><span class="w"> </span>-<span class="m">6.5</span><span class="w"> </span><span class="c"># ns</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">rf_range</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">0.0</span><span class="p">,</span><span class="w"> </span><span class="m">120.0</span><span class="p">]</span><span class="w"> </span><span class="c"># ns</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">energy_range</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">0.0</span><span class="p">,</span><span class="w"> </span><span class="m">100.0</span><span class="p">]</span><span class="w"> </span><span class="c"># MeV</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">f3_display</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">rf_offset</span><span class="p">:</span><span class="w"> </span>-<span class="m">12.0</span><span class="w"> </span><span class="c"># ns</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">tof_offset</span><span class="p">:</span><span class="w"> </span>-<span class="m">2.7</span><span class="w"> </span><span class="c"># ns</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">rf_range</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">0.0</span><span class="p">,</span><span class="w"> </span><span class="m">120.0</span><span class="p">]</span><span class="w"> </span><span class="c"># ns</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">tof_range</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">0.0</span><span class="p">,</span><span class="w"> </span><span class="m">8.0</span><span class="p">]</span><span class="w"> </span><span class="c"># ns</span></span></span></code></pre></div></div>
    </div>
  </div>
</div>
<div class="box notices cstyle info">
  <div class="box-label"><i class="fa-fw fas fa-info-circle"></i> Info</div>
  <div class="box-content">

<p>You can add the beam ions freely, but you need to prepare SRIM Output table.</p>
</div>
</div>
<p>Lastly, let&rsquo;s prepare the steering file.
If you want to do only PID calculation, you can use <code>chkpid.yaml</code>.</p>

  
<div class="tab-panel" data-tab-group="b83dfa778f7645f18c89086ef205ab62">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="steeringchkpidyaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('b83dfa778f7645f18c89086ef205ab62','steeringchkpidyaml')"
    >
      <span>
        <span class="tab-nav-hidden">steering/chkpid.yaml</span>
        <span class="tab-nav-text">steering/chkpid.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="steeringchkpidyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">Processor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">pid</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TCRIBPIDProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">FileName</span><span class="p">:</span><span class="w"> </span><span class="l">prm/pid/expname.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Batch</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputTransparency</span><span class="p">:</span><span class="w"> </span><span class="m">1</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>You can add these sentences for any other steering files.
I think it is useful when you want to overlap the data figure and calculation figure.
If you set <code>Batch: false</code>, the canvases for F2 PID and F3 PID will appear automatically.
<code>Batch: true</code> is quiet mode.</p>
<p>This is an example of the automatically generated figure.</p>
<figure><img src="/artemis_crib/example/online_analysis/pid/auto.png" width="600"/>
</figure>

<p>The process for the calculation is performed in init process (I mean not event loop), so when you <code>add</code> the steering file, the figure will be created.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; acd
</span></span><span class="line"><span class="cl">&gt; a
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>0<span class="o">]</span> add steering/chkpid.yaml
</span></span><span class="line"><span class="cl"><span class="c1"># process is performed now</span>
</span></span><span class="line"><span class="cl"><span class="c1"># if Batch: false, the two PID figure will appear automatically </span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>1<span class="o">]</span> ls
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> artemis
</span></span><span class="line"><span class="cl">&gt;   <span class="m">0</span> TDirectory pid             pid       
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>2<span class="o">]</span> <span class="nb">cd</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>3<span class="o">]</span> ls
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> pid
</span></span><span class="line"><span class="cl">&gt;   <span class="m">0</span> TMultiGraph                 F2_PID<span class="p">;</span> F2 RF <span class="o">[</span>ns<span class="o">]</span><span class="p">;</span> F2 SSD <span class="o">[</span>MeV<span class="o">]</span>
</span></span><span class="line"><span class="cl">    <span class="m">1</span> TMultiGraph                 F3_PID<span class="p">;</span> F3 RF <span class="o">[</span>ns<span class="o">]</span><span class="p">;</span> PPACs/MWDCs TOF <span class="o">[</span>ns<span class="o">]</span>
</span></span><span class="line"><span class="cl">    <span class="m">2</span> TCanvas F2_canvas       F2_canvas 
</span></span><span class="line"><span class="cl">    <span class="m">3</span> TCanvas F3_canvas       F3_canvas 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>4<span class="o">]</span> draw <span class="m">0</span></span></span></code></pre></div><figure><img src="/artemis_crib/example/online_analysis/pid/multigraph.png" width="600"/>
</figure>


<div class="box notices cstyle info">
  <div class="box-label"><i class="fa-fw fas fa-info-circle"></i> Info</div>
  <div class="box-content">

<p>There are two kinds of object, <code>TMultiGraph</code> and <code>TCanvas</code>.
The <code>ht</code> command cannot draw these object, so I also made <code>draw</code> command to be able to draw &ldquo;TMultiGraph&rdquo; objects.</p>
<p>HOWEVER, even this &ldquo;draw&rdquo; command cannot display the &ldquo;TCanvas&rdquo; object yet&hellip;
If you save the object using <code>hstore</code> command or check from THttpServer, you can check the TCanvas objects.</p>
</div>
</div>
<p>This &ldquo;TMultiGraph&rdquo; object is useful when you want to overlay th data.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> ht something <span class="c1"># this is gaussian example</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> dr <span class="m">0</span> p same</span></span></code></pre></div><figure><img src="/artemis_crib/example/online_analysis/pid/overlap.png" width="600"/>
</figure>


            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="f2">F2</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2024-01-20 by Kodai Okawa</span></span>
<p>The basic usage is the same.</p>
<p>We use this steering file to check F2 data.</p>
<ul>
<li><a href="https://github.com/okawak/artemis_crib/blob/main/steering/chkf2.yaml" target="_blank">steering/chkf2.yaml</a></li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ artlogin <span class="o">(</span>username<span class="o">)</span>
</span></span><span class="line"><span class="cl">$ a
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>0<span class="o">]</span> add steering/chkf2.yaml <span class="nv">NAME</span><span class="o">=</span>hoge <span class="nv">NUM</span><span class="o">=</span><span class="m">0000</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>1<span class="o">]</span> res
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>2<span class="o">]</span> sus
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>3<span class="o">]</span> ls
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> artemis
</span></span><span class="line"><span class="cl">&gt;   <span class="m">0</span> art::TTreeProjGroup f2check         f2_check
</span></span><span class="line"><span class="cl">    <span class="m">1</span> art::TAnalysisInfo analysisInfo</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>4<span class="o">]</span> <span class="nb">cd</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>5<span class="o">]</span> ls
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> f2check
</span></span><span class="line"><span class="cl">&gt;   <span class="m">0</span> art::TH1FTreeProj f2PPAC X        f2ppac x
</span></span><span class="line"><span class="cl">    <span class="m">1</span> art::TH1FTreeProj f2PPAC Y        f2ppac y
</span></span><span class="line"><span class="cl">    <span class="m">2</span> art::TH1FTreeProj f2SSD raw       f2ssd raw
</span></span><span class="line"><span class="cl">    <span class="m">3</span> art::TH1FTreeProj f2SSD raw <span class="o">(</span>low<span class="o">)</span> f2ssd raw <span class="o">(</span>low<span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="m">4</span> art::TH1FTreeProj f2SSD cal       f2ssd cal
</span></span><span class="line"><span class="cl">    <span class="m">5</span> art::TH2FTreeProj f2PPAC X vs Y   f2ppac X vs Y
</span></span><span class="line"><span class="cl">    <span class="m">6</span> art::TH2FTreeProj F2PPAC X vs RF0 f2ppac X vs rf0
</span></span><span class="line"><span class="cl">    <span class="m">7</span> art::TH2FTreeProj F2PPAC Y vs RF0 f2ppac Y vs rf0
</span></span><span class="line"><span class="cl">    <span class="m">8</span> art::TH2FTreeProj RF0 vs F2SSD raw rf0 vs f2ssd raw
</span></span><span class="line"><span class="cl">    <span class="m">9</span> art::TH2FTreeProj RF0 vs F2SSD cal rf0 vs f2ssd cal
</span></span><span class="line"><span class="cl">   <span class="m">10</span> art::TH2FTreeProj RF1 vs F2SSD cal rf1 vs f2ssd cal
</span></span><span class="line"><span class="cl">   <span class="m">11</span> art::TH2FTreeProj F2PPAC X vs F2SSD raw f2ppac x vs f2ssd raw
</span></span><span class="line"><span class="cl">   <span class="m">12</span> art::TH2FTreeProj F2PPAC X vs F2SSD cal f2ppac x vs f2ssd cal
</span></span><span class="line"><span class="cl">   <span class="m">13</span> art::TH2FTreeProj F2PPAC Y vs F2SSD cal f2ppac y vs f2ssd cal
</span></span><span class="line"><span class="cl">   <span class="m">14</span> art::TH1FTreeProj RF0             rf0</span></span></code></pre></div><p>As you know, you can check the histograms</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># for 1D histograms</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> ht <span class="o">[</span>id<span class="o">]</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> hn <span class="c1"># histogram next</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> hb <span class="c1"># histogram before (back?)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># for 2D histograms</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> ht <span class="o">[</span>id<span class="o">]</span> colz <span class="c1"># colz is option</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> hn colz
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> hb colz</span></span></code></pre></div><p>If you want to save,</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> sa
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> pri</span></span></code></pre></div>
            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="ppac">PPAC</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-12-20 by Kodai Okawa</span></span>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="mwdc">MWDC</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-12-20 by Kodai Okawa</span></span>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="ssd">SSD</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-12-20 by Kodai Okawa</span></span>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="f3">F3</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-12-20 by Kodai Okawa</span></span>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="gate">Gate</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2024-01-17 by Kodai Okawa</span></span>
<p>It is very important to select events for online analysis as well.
There are several options to do so, and I will cover all of them.
If you know other useful way, please let me know.</p>
<ul>
<li>Histogram definition</li>
<li>TCutG object</li>
<li>TGateStopProcessor</li>
</ul>
<p>For clearer understanding, we will use this figure, and we call this as default figure:</p>
<figure><img src="/artemis_crib/example/online_analysis/gate/default.png" width="600"/>
</figure>

<h2 id="histogram-definition">Histogram definition</h2>
<p>We explained in the <a href="/artemis_crib/example/online_analysis/gate/../../../setting/histograms">Histograms</a> page, but again we describe about histogram definition focus on the <code>cut</code> part.</p>
<p>The default figure defined like this:</p>

  
<div class="tab-panel" data-tab-group="01a1b7167c5c76d763be13df9a3ed883">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="histf2f2yaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('01a1b7167c5c76d763be13df9a3ed883','histf2f2yaml')"
    >
      <span>
        <span class="tab-nav-hidden">hist/f2/f2.yaml</span>
        <span class="tab-nav-text">hist/f2/f2.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="histf2f2yaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">anchor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="cp">&amp;f2ppacx</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;f2ppac.fX&#34;</span><span class="p">,</span><span class="m">200</span><span class="p">,</span>-<span class="m">50</span><span class="l">.,50.]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="cp">&amp;f2ppacy</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;f2ppac.fY&#34;</span><span class="p">,</span><span class="m">200</span><span class="p">,</span>-<span class="m">50</span><span class="l">.,50.]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">alias</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">group</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">f2check</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l">f2_check</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">contents</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">f2PPAC X vs Y</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l">f2ppac X vs Y</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">x</span><span class="p">:</span><span class="w"> </span><span class="cp">*f2ppacx</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">y</span><span class="p">:</span><span class="w"> </span><span class="cp">*f2ppacy</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>For example, let&rsquo;s add the gate to select only &ldquo;-10.0 &lt; X &lt; 10.0&rdquo;.
We can use alias node to define that.</p>

  
<div class="tab-panel" data-tab-group="0aea65c18a0782c21de84ca5bbf9fa13">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="histf2f2yaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('0aea65c18a0782c21de84ca5bbf9fa13','histf2f2yaml')"
    >
      <span>
        <span class="tab-nav-hidden">hist/f2/f2.yaml</span>
        <span class="tab-nav-text">hist/f2/f2.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="histf2f2yaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">anchor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="cp">&amp;f2ppacx</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;f2ppac.fX&#34;</span><span class="p">,</span><span class="m">200</span><span class="p">,</span>-<span class="m">50</span><span class="l">.,50.]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="cp">&amp;f2ppacy</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;f2ppac.fY&#34;</span><span class="p">,</span><span class="m">200</span><span class="p">,</span>-<span class="m">50</span><span class="l">.,50.]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">alias</span><span class="p">:</span><span class="w">
</span></span></span><span class="line hl"><span class="cl"><span class="w">  </span><span class="nt">centerx</span><span class="p">:</span><span class="w"> </span><span class="l">abs(f2ppac.fX) &lt; 10.0;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">group</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">f2check</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l">f2_check</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">contents</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">f2PPAC X vs Y{centerx}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l">f2ppac X vs Y{centerx}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">x</span><span class="p">:</span><span class="w"> </span><span class="cp">*f2ppacx</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">y</span><span class="p">:</span><span class="w"> </span><span class="cp">*f2ppacy</span><span class="w">
</span></span></span><span class="line hl"><span class="cl"><span class="w">        </span><span class="nt">cut</span><span class="p">:</span><span class="w"> </span><span class="l">centerx</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>Then the following histogram is created.</p>
<figure><img src="/artemis_crib/example/online_analysis/gate/yaml_gate.png" width="600"/>
</figure>

<p>Also, multiple conditions can be specified at the same time.</p>

  
<div class="tab-panel" data-tab-group="c8d9314d3cf236d0b6ef5f753e740624">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="histf2f2yaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('c8d9314d3cf236d0b6ef5f753e740624','histf2f2yaml')"
    >
      <span>
        <span class="tab-nav-hidden">hist/f2/f2.yaml</span>
        <span class="tab-nav-text">hist/f2/f2.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="histf2f2yaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">anchor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="cp">&amp;f2ppacx</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;f2ppac.fX&#34;</span><span class="p">,</span><span class="m">200</span><span class="p">,</span>-<span class="m">50</span><span class="l">.,50.]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="cp">&amp;f2ppacy</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;f2ppac.fY&#34;</span><span class="p">,</span><span class="m">200</span><span class="p">,</span>-<span class="m">50</span><span class="l">.,50.]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">alias</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">centerx</span><span class="p">:</span><span class="w"> </span><span class="l">abs(f2ppac.fX) &lt; 10.0;</span><span class="w">
</span></span></span><span class="line hl"><span class="cl"><span class="w">  </span><span class="nt">centery</span><span class="p">:</span><span class="w"> </span><span class="l">abs(f2ppac.fY) &lt; 10.0;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">group</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">f2check</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l">f2_check</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">contents</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">f2PPAC X vs Y{centerx &amp;&amp; centery}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l">f2ppac X vs Y{centerx &amp;&amp; centery}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">x</span><span class="p">:</span><span class="w"> </span><span class="cp">*f2ppacx</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">y</span><span class="p">:</span><span class="w"> </span><span class="cp">*f2ppacy</span><span class="w">
</span></span></span><span class="line hl"><span class="cl"><span class="w">        </span><span class="nt">cut</span><span class="p">:</span><span class="w"> </span><span class="l">centerx &amp;&amp; centery</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><figure><img src="/artemis_crib/example/online_analysis/gate/yaml_multigate.png" width="600"/>
</figure>

<h2 id="tcutg-object">TCutG object</h2>
<p>We can also use TCutG object to select the event.
As in <a href="/artemis_crib/example/online_analysis/gate/../../../crib_parts/newcommand">new commands</a> page, let&rsquo;s assume we create this TCutG ROOT file by <code>tcutg</code> command.
And the ROOT file and TCutG object name is <code>f2star</code>.</p>
<figure><img src="/artemis_crib/example/online_analysis/gate/tcutg_raw.png" width="600"/>
</figure>

<p>If you want to use this object to select event, just add this line is fine, as long as you use <a href="/artemis_crib/example/online_analysis/gate/../../../crib_parts/userconfig">userlogon.C</a>.</p>

  
<div class="tab-panel" data-tab-group="39be7471d412a7baaa0e5f4cc0bc16d4">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="histf2f2yaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('39be7471d412a7baaa0e5f4cc0bc16d4','histf2f2yaml')"
    >
      <span>
        <span class="tab-nav-hidden">hist/f2/f2.yaml</span>
        <span class="tab-nav-text">hist/f2/f2.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="histf2f2yaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">anchor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="cp">&amp;f2ppacx</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;f2ppac.fX&#34;</span><span class="p">,</span><span class="m">200</span><span class="p">,</span>-<span class="m">50</span><span class="l">.,50.]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="cp">&amp;f2ppacy</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;f2ppac.fY&#34;</span><span class="p">,</span><span class="m">200</span><span class="p">,</span>-<span class="m">50</span><span class="l">.,50.]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">alias</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">group</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">f2check</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l">f2_check</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">contents</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">f2PPAC X vs Y{f2star}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l">f2ppac X vs Y{f2star}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">x</span><span class="p">:</span><span class="w"> </span><span class="cp">*f2ppacx</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">y</span><span class="p">:</span><span class="w"> </span><span class="cp">*f2ppacy</span><span class="w">
</span></span></span><span class="line hl"><span class="cl"><span class="w">        </span><span class="nt">cut</span><span class="p">:</span><span class="w"> </span><span class="l">f2star</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><figure><img src="/artemis_crib/example/online_analysis/gate/tcutg_star.png" width="600"/>
</figure>

<p>Of course we can use in &ldquo;tree-&gt;Draw()&rdquo; because this TCutG objects are automatically loaded.
The following sentence generate the same figure.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[]</span> fcd <span class="m">0</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[]</span> zo
</span></span><span class="line"><span class="cl">artemis <span class="o">[]</span> tree-&gt;Draw<span class="o">(</span><span class="s2">&#34;f2ppac.fY:f2ppac.fX&gt;&gt;(200,-50.,50., 200,-50.,50.)&#34;</span>,<span class="s2">&#34;f2star&#34;</span>,<span class="s2">&#34;colz&#34;</span><span class="o">)</span></span></span></code></pre></div><h2 id="tgatestopprocessor">TGateStopProcessor</h2>
<p>The method used until now was to process just histograms and analyze them for all events in the event loop.
If you know which events you don&rsquo;t want, there are processors that allow you to skip the event loop under certain conditions.
This may speed up the event loop.</p>
<p>For example. when we want to analyze only <code>beam single</code> event (it means the events are not coincident with SSD, and let&rsquo;s suppose that condition is given by <code>single.fID==0</code>), let&rsquo;s prepare the steering file.</p>

  
<div class="tab-panel" data-tab-group="8eea4ecfdeea56e02de973280c9c50b8">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="steeringgatecoinyaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('8eea4ecfdeea56e02de973280c9c50b8','steeringgatecoinyaml')"
    >
      <span>
        <span class="tab-nav-hidden">steering/gate/coin.yaml</span>
        <span class="tab-nav-text">steering/gate/coin.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="steeringgatecoinyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">Processor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">proc_gateinit</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TGateArrayInitializer</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputTransparency</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">proc_gate</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TTreeFormulaGateProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Definitions</span><span class="p">:</span><span class="w">
</span></span></span><span class="line hl"><span class="cl"><span class="w">        </span>- <span class="s2">&#34;beam_single; single.fID==0&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputTransparency</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Verbose</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">beam_single_gate</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TGateStopProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line hl"><span class="cl"><span class="w">      </span><span class="nt">GateName</span><span class="p">:</span><span class="w"> </span><span class="l">beam_single</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputTransparency</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">StopIf</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Verbose</span><span class="p">:</span><span class="w"> </span><span class="m">1</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>To use TGateStopProcessor, we need to initialize the &ldquo;gate&rdquo; array object, so the first <code>art::TGateArrayInitializer</code> is needed.
In the second processor, <code>art::TTreeFormulaGateProcessor</code>, we define the gate condition.</p>
<p>Then the <code>art::TGateStopProcessor</code> judges the event is skipped or not.
In the case of <code>StopIf: 0</code>, artemis ignore the event that the condition become <code>false</code>.
In other words, <code>StopIf: 0</code> means artemis will analyze the event only when the condition is <code>true</code>.</p>
<p>Then, including this yaml file to the main steering file, you can check only the selected events.</p>

  
<div class="tab-panel" data-tab-group="f57cdb94cb66fb42e33f2ccde3672b80">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="steeringhogeyaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('f57cdb94cb66fb42e33f2ccde3672b80','steeringhogeyaml')"
    >
      <span>
        <span class="tab-nav-hidden">steering/hoge.yaml</span>
        <span class="tab-nav-text">steering/hoge.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="steeringhogeyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">Anchor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="cp">&amp;input</span><span class="w"> </span><span class="l">ridf/@NAME@@NUM@.ridf</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="cp">&amp;output</span><span class="w"> </span><span class="l">output/@NAME@/@NUM@/hoge@NAME@@NUM@.root</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="cp">&amp;histout</span><span class="w"> </span><span class="l">output/@NAME@/@NUM@/hoge@NAME@@NUM@.hist.root</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">Processor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">timer</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TTimerProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">ridf</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TRIDFEventStore</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputTransparency</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">InputFiles</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="cp">*input</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">SHMID</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">mapper</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TMappingProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputTransparency</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># include some other steering files</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line hl"><span class="cl"><span class="w">  </span>- <span class="nt">include</span><span class="p">:</span><span class="w"> </span><span class="l">gate/coin.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">outputtree</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TOutputTreeProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">FileName</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="cp">*output</span></span></span></code></pre></div></div>
    </div>
  </div>
</div>
<div class="box notices cstyle info">
  <div class="box-label"><i class="fa-fw fas fa-info-circle"></i> Info</div>
  <div class="box-content">

<p>We didn&rsquo;t check if we can use the TCutG object in this process&hellip;</p>
</div>
</div>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="shifter-task">Shifter task</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-12-20 by Kodai Okawa</span></span>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="scaler">Scaler</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-12-20 by Kodai Okawa</span></span>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="timestamp">Timestamp</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-12-15 by Kodai Okawa</span></span>

            <footer class="footline">

            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>
<h1 id="check-raw-data">Check raw data</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2024-01-11 by Kodai Okawa</span></span>
<p>Artemis produces mainly <code>TArtTree</code> and the branches are <code>TClonesArray(art::hoge)</code>.
It means that all objects rely on the artemis library, and we cannot open and check the data by using normal ROOT.</p>
<p>Also, sometimes it is necessary top check the raw data obtained by ADC and TDC as it is.
Of course, the real raw data is binary and therefore difficult to read, so we will check the raw data after the decoders.</p>
<p>Related processors;</p>
<ul>
<li><a href="https://github.com/okawak/artemis_crib/blob/main/src-crib/TSegmentOutputProcessor.cc" target="_blank">TSegmentOutputProcessor.cc</a></li>
<li><a href="https://github.com/okawak/artemis_crib/blob/main/src-crib/TModuleData.cc" target="_blank">TModuleData.cc</a></li>
<li><a href="https://github.com/artemis-dev/artemis/blob/develop/sources/loop/TSegmentCheckProcessor.cc" target="_blank">TSegmentCheckProcessor.cc</a> (in original artemis source)</li>
</ul>
<h2 id="how-to-check-the-raw-data">How to check the raw data</h2>
<h3 id="1-prepare-conf-files">1. prepare conf files</h3>
<p>We already prepared <code>conf/map</code> files, but in this case, we need to prepare <code>conf/seg</code> files.
There are two files.
This is an example, so please change it according to the experimental conditions.</p>

  
<div class="tab-panel" data-tab-group="833d243ad71df6aec7687a18d03b721b">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="confsegmodulelistyaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('833d243ad71df6aec7687a18d03b721b','confsegmodulelistyaml')"
    >
      <span>
        <span class="tab-nav-hidden">conf/seg/modulelist.yaml</span>
        <span class="tab-nav-text">conf/seg/modulelist.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="confsegmodulelistyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="c">#modulename:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#  id: module id (it is module-specific)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#  ch: channel number</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#  values:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#    - name1: [Nbin: int, min: double, max: double] it is for 2D histogram (these values vs. ch)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#    - name2: [Nbin: int, min: double, max: double] &lt;= somehow two line needed...?</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">MADC32</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="m">32</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">ch</span><span class="p">:</span><span class="w"> </span><span class="m">32</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">values</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">adc</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">4000</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="l">., 4000.]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">tdc</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">4000</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="l">., 4000.]</span><span class="w"> </span><span class="c"># no use, but seems it needed...</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">V1190A</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="m">24</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">ch</span><span class="p">:</span><span class="w"> </span><span class="m">128</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">values</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">tdcL</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">300</span><span class="p">,</span><span class="w"> </span>-<span class="m">5000</span><span class="l">., 300000.]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">tdcT</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">300</span><span class="p">,</span><span class="w"> </span>-<span class="m">5000</span><span class="l">., 300000.]</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>The module id list is <a href="/artemis_crib/example/online_analysis/check_rawdata/../../../example/segid">here</a>.</p>

  
<div class="tab-panel" data-tab-group="dda2a9182edfcc290c1ccf08e35e40d6">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="confsegseglistyaml"
      class="tab-nav-button tab-panel-style cstyle initial active"
      onclick="switchTab('dda2a9182edfcc290c1ccf08e35e40d6','confsegseglistyaml')"
    >
      <span>
        <span class="tab-nav-hidden">conf/seg/seglist.yaml</span>
        <span class="tab-nav-text">conf/seg/seglist.yaml</span>
      </span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="confsegseglistyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="c">#segment_name:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># segid: [[dev], [fp], [det]] &lt;= same as a map file</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># type: V7XX &lt;= defined type in modulelist.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># modules:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#   - id: geo1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#   - id: geo2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">V1190</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">segid</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">12</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">7</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">V1190A</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">modules</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">MADC</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">segid</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">12</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">6</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">MADC32</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">modules</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="m">2</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><h3 id="2-use-steeringchksegyaml">2. use &ldquo;steering/chkseg.yaml&rdquo;</h3>
<p>Based on these two conf file, the <code>steering/chkseg.yaml</code> file produce rawdata histograms and TTree object.
We can use <a href="https://github.com/okawak/artemis_crib/blob/main/steering/chkseg.yaml" target="_blank">steering/chkseg.yaml</a> without any change I think.</p>
<p>This is an example from one CRIB experiment.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ a
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>0<span class="o">]</span> add steering/chkseg.yaml <span class="nv">NAME</span><span class="o">=</span>hoge <span class="nv">NUM</span><span class="o">=</span><span class="m">0000</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>1<span class="o">]</span> res
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>2<span class="o">]</span> sus
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>3<span class="o">]</span> ls
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> artemis
</span></span><span class="line"><span class="cl">&gt;   <span class="m">0</span> TDirectory SegmentHistogram art::TSegmentCheckProcessor
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>4<span class="o">]</span> <span class="nb">cd</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>5<span class="o">]</span> ls
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> SegmentHistogram
</span></span><span class="line"><span class="cl">&gt;   <span class="m">0</span> TDirectory E7_V1190        E7_V1190
</span></span><span class="line"><span class="cl">    <span class="m">1</span> TDirectory J1_V785         J1_V785
</span></span><span class="line"><span class="cl">    <span class="m">2</span> TDirectory J1_MADC         J1_MADC
</span></span><span class="line"><span class="cl">    <span class="m">3</span> TDirectory J1_V1190        J1_V1190
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>6<span class="o">]</span> <span class="nb">cd</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>7<span class="o">]</span> ls
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> E7_V1190
</span></span><span class="line"><span class="cl">&gt;   <span class="m">0</span> TH2F E7_V1190_0_tdcL E7_V1190_0_tdcL
</span></span><span class="line"><span class="cl">    <span class="m">1</span> TH2F E7_V1190_0_tdcT E7_V1190_0_tdcT
</span></span><span class="line"><span class="cl">    <span class="m">2</span> TH2F E7_V1190_1_tdcL E7_V1190_1_tdcL
</span></span><span class="line"><span class="cl">    <span class="m">3</span> TH2F E7_V1190_1_tdcT E7_V1190_1_tdcT
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># we can check these histograms by ht command</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>8<span class="o">]</span> fcd <span class="m">0</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>9<span class="o">]</span> br
</span></span><span class="line"><span class="cl">E7_V1190_0           vector&lt;vector&lt;int&gt; &gt;
</span></span><span class="line"><span class="cl">E7_V1190_1           vector&lt;vector&lt;int&gt; &gt;
</span></span><span class="line"><span class="cl">J1_V785_0            vector&lt;int&gt;
</span></span><span class="line"><span class="cl">J1_V785_1            vector&lt;int&gt;
</span></span><span class="line"><span class="cl">J1_V785_2            vector&lt;int&gt;
</span></span><span class="line"><span class="cl">J1_MADC_3            vector&lt;int&gt;
</span></span><span class="line"><span class="cl">J1_MADC_4            vector&lt;int&gt;
</span></span><span class="line"><span class="cl">J1_MADC_5            vector&lt;int&gt;
</span></span><span class="line"><span class="cl">J1_V1190_0           vector&lt;vector&lt;int&gt; &gt;</span></span></code></pre></div>
<div class="box notices cstyle info">
  <div class="box-label"><i class="fa-fw fas fa-info-circle"></i> Info</div>
  <div class="box-content">

<p>If the module ID = 24 or 25, it is multihit TDC, so the branch become 2D vector.
When you want to use std::vector<!-- raw HTML omitted --> method, you can use by &ldquo;@&rdquo; like</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> tree-&gt;Draw<span class="o">(</span><span class="s2">&#34;J1_V785_0@.size()&#34;</span><span class="o">)</span></span></span></code></pre></div></div>
</div>
<p>Of course we can open this output ROOT file from normal ROOT.</p>

            <footer class="footline">

            </footer>
          </article>

          </section>
        </div>
      </main>
    </div>
    <script src="/artemis_crib/js/clipboard.min.js?1705762586" defer></script>
    <script src="/artemis_crib/js/perfect-scrollbar.min.js?1705762586" defer></script>
    <script>
      function useMathJax( config ){
        if( !Object.assign ){
          
          return;
        }
        window.MathJax = Object.assign( window.MathJax || {}, {
          loader: {
            load: ['[tex]/mhchem']
          },
          startup: {
            elements: [
              '.math'
            ]
          },
          tex: {
            inlineMath: [
              ['$', '$'], 
              ['\\(', '\\)']
            ]
          },
          options: {
            enableMenu: false 
          }
        }, config );
      }
      useMathJax( JSON.parse("{}") );
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="/artemis_crib/js/theme.js?1705762586" defer></script>
  </body>
</html>
