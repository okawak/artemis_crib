<!DOCTYPE html>
<html lang="en-us" dir="ltr" itemscope itemtype="http://schema.org/Article">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.130.0">
    <meta name="generator" content="Relearn 6.0.0">
    <meta name="description" content="This section explain the example of the Monte Carlo simulation by using artemis.">
    <meta name="author" content="Kodai Okawa">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="MC Simulation :: CRIB artemis">
    <meta name="twitter:description" content="This section explain the example of the Monte Carlo simulation by using artemis.">
    <meta property="og:url" content="https://okawak.github.io/artemis_crib/example/simulation/index.html">
    <meta property="og:site_name" content="CRIB artemis">
    <meta property="og:title" content="MC Simulation :: CRIB artemis">
    <meta property="og:description" content="This section explain the example of the Monte Carlo simulation by using artemis.">
    <meta property="og:locale" content="en-us">
    <meta property="og:type" content="website">
    <meta itemprop="name" content="MC Simulation :: CRIB artemis">
    <meta itemprop="description" content="This section explain the example of the Monte Carlo simulation by using artemis.">
    <meta itemprop="dateModified" content="2023-12-15T18:58:23+09:00">
    <meta itemprop="wordCount" content="21">
    <title>MC Simulation :: CRIB artemis</title>
    <link href="https://okawak.github.io/artemis_crib/example/simulation/index.html" rel="canonical" type="text/html" title="MC Simulation :: CRIB artemis">
    <link href="/artemis_crib/example/simulation/index.xml" rel="alternate" type="application/rss+xml" title="MC Simulation :: CRIB artemis"><link rel="icon" href="/artemis_crib/images/crib_overlay.png" type="image/png">

    <link href="/artemis_crib/css/fontawesome-all.min.css?1722332067" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/artemis_crib/css/fontawesome-all.min.css?1722332067" rel="stylesheet"></noscript>
    <link href="/artemis_crib/css/nucleus.css?1722332067" rel="stylesheet">
    <link href="/artemis_crib/css/auto-complete.css?1722332067" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/artemis_crib/css/auto-complete.css?1722332067" rel="stylesheet"></noscript>
    <link href="/artemis_crib/css/perfect-scrollbar.min.css?1722332067" rel="stylesheet">
    <link href="/artemis_crib/css/fonts.css?1722332067" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/artemis_crib/css/fonts.css?1722332067" rel="stylesheet"></noscript>
    <link href="/artemis_crib/css/theme.css?1722332067" rel="stylesheet">
    <link href="/artemis_crib/css/theme-CRIB-theme.css?1722332067" rel="stylesheet" id="R-variant-style">
    <link href="/artemis_crib/css/chroma-relearn-dark.css?1722332067" rel="stylesheet" id="R-variant-chroma-style">
    <link href="/artemis_crib/css/variant.css?1722332067" rel="stylesheet">
    <link href="/artemis_crib/css/print.css?1722332067" rel="stylesheet" media="print">
    <link href="/artemis_crib/css/format-print.css?1722332067" rel="stylesheet">
    <script src="/artemis_crib/js/variant.js?1722332067"></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.relBasePath='..\/..';
      window.relearn.relBaseUri='..\/..\/..';
      window.relearn.absBaseUri='https:\/\/okawak.github.io\/artemis_crib';
      window.index_js_url="/artemis_crib/index.search.js";
      // variant stuff
      window.variants && variants.init( [ 'CRIB-theme', 'zen-dark', 'learn', 'relearn-dark' ] );
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
    </script>

  
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-MZF67K577Y"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'G-MZF67K577Y');
  </script>
  


  </head>
  <body class="mobile-support print" data-url="/artemis_crib/example/simulation/index.html">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide"><button class="topbar-control" onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button>
            </div>
          </div>
          <ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype="http://schema.org/BreadcrumbList"><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="/artemis_crib/example/index.html"><span itemprop="name">Example</span></a><meta itemprop="position" content="1">&nbsp;>&nbsp;</li><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><span itemprop="name">MC Simulation</span><meta itemprop="position" content="2"></li>
          </ol>
          <div class="topbar-area topbar-area-end" data-area="end">
            <div class="topbar-button topbar-button-prev" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="/artemis_crib/example/offline_analysis/analysis_example/index.html" title="analysis example (🡐)"><i class="fa-fw fas fa-chevron-left"></i></a>
            </div>
            <div class="topbar-button topbar-button-next" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="/artemis_crib/example/simulation/beam_generator/index.html" title="Beam Generator (🡒)"><i class="fa-fw fas fa-chevron-right"></i></a>
            </div>
          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable default" tabindex="-1">
        <div class="flex-block-wrapper">
          <article class="default">
            <header class="headline">
            </header>

<h1 id="mc-simulation">MC Simulation</h1>

<p>This section explain the example of the Monte Carlo simulation by using artemis.</p>

<ul class="children children-li children-sort-weight">
	
<li><a href="/artemis_crib/example/simulation/beam_generator/index.html">Beam Generator</a></li>
<li><a href="/artemis_crib/example/simulation/nbodyreaction/index.html">Nbody Reaction</a></li>
<li><a href="/artemis_crib/example/simulation/geometry/index.html">Geometry</a></li>
<li><a href="/artemis_crib/example/simulation/detect_particle/index.html">Detect particles</a></li>
<li><a href="/artemis_crib/example/simulation/solidangle/index.html">Solidangle</a></li>
</ul>

            <footer class="footline">
              <i class='fa-fw fas fa-user'></i> <a href="mailto:okawa@cns.s.u-tokyo.ac.jp">KodaiOkawa</a>
              <i class='fa-fw fas fa-calendar'></i> Dec 15, 2023
            </footer>
          </article>

          <section>
            <h1 class="a11y-only">Subsections of MC Simulation</h1>
          <article class="default">
            <header class="headline">
            </header>

<h1 id="beam-generator">Beam Generator</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2024-07-16 by Kodai Okawa</span></span>
<p>It is very useful to use Monte Carlo (MC) simulation to obtain various calculated values.
From this section, we will show the simple example how to perform MC simulation using artemis.</p>
<p>First, we will set the generator of the beam that will bombard on the target.
We have two kinds of generator:</p>
<ul>
<li>Random parameter beam (using Random number)</li>
<li>Get beam parameter from ROOT file</li>
</ul>
<p>After you get beam information from a measurement, second option might be useful.</p>
<h2 id="random-beam-generator">Random Beam Generator</h2>
<p>This is an example of a steering file.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">Processor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">random_eventstore</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TRandomNumberEventStore</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputTransparency</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">MaxLoop</span><span class="p">:</span><span class="w"> </span><span class="cp">*loopnum</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">beam_generator</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TRandomBeamGenerator</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputCollection</span><span class="p">:</span><span class="w"> </span><span class="cp">*beam_name</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputTrackCollection</span><span class="p">:</span><span class="w"> </span><span class="cp">*track_name</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="c">#beam particle information</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">MassNum</span><span class="p">:</span><span class="w"> </span><span class="cp">*beam_A</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">AtomicNum</span><span class="p">:</span><span class="w"> </span><span class="cp">*beam_Z</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">ChargeNum</span><span class="p">:</span><span class="w"> </span><span class="cp">*beam_Z</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">IniEnergy</span><span class="p">:</span><span class="w"> </span><span class="cp">*beam_E</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="c">#beam tracking information</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Xsigma</span><span class="p">:</span><span class="w"> </span><span class="m">1.0</span><span class="w"> </span><span class="c"># mm</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Ysigma</span><span class="p">:</span><span class="w"> </span><span class="m">1.0</span><span class="w"> </span><span class="c"># mm</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Asigma</span><span class="p">:</span><span class="w"> </span><span class="m">1.0</span><span class="w"> </span><span class="c"># deg</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Bsigma</span><span class="p">:</span><span class="w"> </span><span class="m">1.0</span><span class="w"> </span><span class="c"># deg</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Esigma</span><span class="p">:</span><span class="w"> </span><span class="cp">*beam_Esigma</span></span></span></code></pre></div><p>This produces two branch, &ldquo;beam&rdquo; and &ldquo;track&rdquo;.</p>
<ul>
<li>beam: contain all information about beam ion</li>
<li>track: used for reconstract simulation</li>
</ul>
<p>Actually &ldquo;track&rdquo; information is contained in &ldquo;beam&rdquo; branch.</p>
<p>Here is the detail of the type of &ldquo;beam&rdquo;.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">artemis</span> <span class="p">[]</span> <span class="n">classinfo</span> <span class="n">art</span><span class="o">::</span><span class="n">TParticleInfo</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="n">art</span><span class="o">::</span><span class="n">TParticleInfo</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="n">Data</span> <span class="n">Members</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                      <span class="kt">int</span>   <span class="n">fMassNumber</span>                                
</span></span><span class="line"><span class="cl">                      <span class="kt">int</span>   <span class="n">fAtomicNumber</span>                              
</span></span><span class="line"><span class="cl">                      <span class="kt">int</span>   <span class="n">fCharge</span>                                    
</span></span><span class="line"><span class="cl">                   <span class="kt">double</span>   <span class="n">fEnergy</span>                <span class="n">kinetic</span> <span class="n">energy</span> <span class="n">in</span> <span class="n">LAB</span> <span class="n">system</span>
</span></span><span class="line"><span class="cl">                   <span class="kt">double</span>   <span class="n">fCurrentZ</span>              <span class="n">current</span> <span class="n">Z</span> <span class="n">position</span>  
</span></span><span class="line"><span class="cl">                   <span class="kt">double</span>   <span class="n">fTime</span>                  <span class="n">Duration</span> <span class="n">time</span> <span class="p">(</span><span class="n">ns</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">                   <span class="n">TTrack</span>   <span class="n">fTrack</span>                 <span class="n">tracking</span> <span class="n">information</span> <span class="n">in</span> <span class="n">LAB</span> <span class="n">system</span>
</span></span><span class="line"><span class="cl">           <span class="n">TLorentzVector</span>   <span class="n">fVec</span>                   <span class="n">lorentz</span> <span class="n">vector</span> <span class="p">(</span><span class="n">px</span><span class="p">,</span> <span class="n">py</span><span class="p">,</span> <span class="n">pz</span><span class="p">,</span> <span class="n">E</span><span class="p">)</span> <span class="n">of</span> <span class="k">this</span> <span class="n">particle</span>
</span></span><span class="line"><span class="cl">                   <span class="kt">double</span>   <span class="n">fTheta_cm</span>              <span class="n">theta</span> <span class="n">angle</span> <span class="p">(</span><span class="n">deg</span><span class="p">)</span> <span class="n">in</span> <span class="n">CM</span> <span class="n">system</span>
</span></span><span class="line"><span class="cl">                   <span class="kt">double</span>   <span class="n">fPhi_cm</span>                <span class="n">phi</span> <span class="n">angle</span> <span class="p">(</span><span class="n">deg</span><span class="p">)</span> <span class="n">in</span> <span class="n">CM</span> <span class="n">system</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">--</span> <span class="n">snip</span> <span class="o">--</span></span></span></code></pre></div><p><code>fCurrentZ</code> is the current Z position and at the beam generation, this value will be set as 0 after this processor.</p>
<p>For example, the beam angle distribution will be like this.</p>
<figure><img src="/artemis_crib/example/simulation/beam_generator/angle.png" width="400">
</figure>

<h2 id="tree-beam-generator">Tree Beam Generator</h2>
<p>The tracking information obtained from the experiment can also be used to generate the beam.
In the current version, the position and angle of the beam are read from a ROOT file and the energy is given randomly.</p>
<p>This is an example of a steering file.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">Processor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">periodic_tree</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TTreePeriodicEventStore</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputTransparency</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">FileName</span><span class="p">:</span><span class="w"> </span><span class="cp">*input</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">TreeName</span><span class="p">:</span><span class="w"> </span><span class="l">tree</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">MaxEventNum</span><span class="p">:</span><span class="w"> </span><span class="cp">*loopnum</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">proc_copy_processor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TBranchCopyProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">InputCollection</span><span class="p">:</span><span class="w"> </span><span class="l">f3ppac</span><span class="w"> </span><span class="c"># need to inherit from TTrack</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputCollection</span><span class="p">:</span><span class="w"> </span><span class="cp">*track_name</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">beam_generator</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TTreeBeamGenerator</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">InputCollection</span><span class="p">:</span><span class="w"> </span><span class="cp">*track_name</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputCollection</span><span class="p">:</span><span class="w"> </span><span class="cp">*beam_name</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="c"># beam particle information</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">MassNum</span><span class="p">:</span><span class="w"> </span><span class="cp">*beam_A</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">AtomicNum</span><span class="p">:</span><span class="w"> </span><span class="cp">*beam_Z</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">ChargeNum</span><span class="p">:</span><span class="w"> </span><span class="cp">*beam_Z</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">IniEnergy</span><span class="p">:</span><span class="w"> </span><span class="cp">*beam_E</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Esigma</span><span class="p">:</span><span class="w"> </span><span class="cp">*beam_Esigma</span></span></span></code></pre></div><p>It reads an object named &ldquo;f3ppac&rdquo;, which inherits from TTrack, from a TTree named &ldquo;tree&rdquo; in a file named &ldquo;*input&rdquo;,
and creates an object of the same type as before named <code>TParticleInfo</code>.</p>

            <footer class="footline">
              <i class='fa-fw fas fa-user'></i> <a href="mailto:kodak2022@outlook.jp">okawak</a>
              <i class='fa-fw fas fa-calendar'></i> Jul 16, 2024
            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>

<h1 id="nbody-reaction">Nbody Reaction</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2024-07-19 by Kodai Okawa</span></span>
<p>make a reaction considering phase space.</p>
<ul>
<li>steering file example</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">reaction_proc</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TNBodyReactionProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">InputCollection</span><span class="p">:</span><span class="w"> </span><span class="cp">*beam_name</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputCollection</span><span class="p">:</span><span class="w"> </span><span class="l">products</span><span class="w"> </span><span class="c"># size is DecayParticleNum</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputReactionCollection</span><span class="p">:</span><span class="w"> </span><span class="l">reaction</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="c"># beam information (for initialize TSrim)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">BeamNucleus</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="cp">*beam_Z,</span><span class="w"> </span><span class="cp">*beam_A]</span><span class="w"> </span><span class="c"># (Z, A)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">BeamEnergy</span><span class="p">:</span><span class="w"> </span><span class="cp">*beam_E</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="c"># target information</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">TargetIsGas</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="c"># false-&gt; solid, true-&gt; gas target</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">TargetName</span><span class="p">:</span><span class="w"> </span><span class="l">he</span><span class="w"> </span><span class="c"># from TSrim energy loss</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">TargetMassNum</span><span class="p">:</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="c"># hit ion</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">TargetAtomicNum</span><span class="p">:</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="c"># hit ion</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">TargetThickness</span><span class="p">:</span><span class="w"> </span><span class="m">1000</span><span class="w"> </span><span class="c"># mm (for gas target, allow up to this value)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">TargetPressure</span><span class="p">:</span><span class="w"> </span><span class="m">250</span><span class="w"> </span><span class="c"># Torr (used for gas target)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="c"># reaction particles information</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">DecayParticleNum</span><span class="p">:</span><span class="w"> </span><span class="m">2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">ReactionMassNum</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">29</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="c"># will be [id=0, id=1]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">ReactionAtomicNum</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">15</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">ExciteLevel</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">0.0</span><span class="p">,</span><span class="w"> </span><span class="m">0.0</span><span class="p">]</span><span class="w"> </span><span class="c"># MeV</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="c"># cross section file, if not, it use constant cross section for energy</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="c"># require: &#34;energy cross-section&#34; format, deliminator should be a space &#39; &#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">CrossSectionPath</span><span class="p">:</span><span class="w"> </span><span class="l">path/to/cs/file</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">CrossSectionType</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="c"># 0-&gt; LAB, kinematics is different, 1-&gt; LAB, kinematics is same, 2-&gt; CM</span></span></span></code></pre></div><p><strong>NOTE</strong></p>
<ul>
<li>using TSrim library, so need to set <code>TargetName</code> that registered this library</li>
<li>if cross section file is not found, it use constant dsigma/dE</li>
<li>cross section file format should be</li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl"># comment
</span></span><span class="line"><span class="cl"># energy cross_section
</span></span><span class="line"><span class="cl">0.0 0.0
</span></span><span class="line"><span class="cl">0.1 1.0 # comment
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># 0.2, 2.0 camma is not allowed...</span></span></code></pre></div><ul>
<li>output <code>products</code> is size two array, like products[0] -&gt; id=0 particle</li>
<li>output <code>reaction</code> contain reaction information, like Ecm, Thetacm</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[]</span> classinfo art::TReactionInfo
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> art::TReactionInfo
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> Data Members
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                   double   fEnergy                / Ecm of the reaction
</span></span><span class="line"><span class="cl">                   double   fTheta                 / Thetacm of the reaction
</span></span><span class="line"><span class="cl">                   double   fX                     / reaction position at LAB system, x
</span></span><span class="line"><span class="cl">                   double   fY                     / reaction position at LAB system, y
</span></span><span class="line"><span class="cl">                   double   fZ                     / reaction position at LAB system, z
</span></span><span class="line"><span class="cl">                   double   fExEnergy              / excited energy of residual nucleus
</span></span><span class="line"><span class="cl">                ESortType   kID                                        
</span></span><span class="line"><span class="cl">                ESortType   kTiming                                    
</span></span><span class="line"><span class="cl">               ESortOrder   kASC                                       
</span></span><span class="line"><span class="cl">               ESortOrder   kDESC   </span></span></code></pre></div><h2 id="example-of-the-output">Example of the output</h2>
<p>We will show an example of a simulation performed for a <code>gas target case</code> like the steering file above. (of course we can use it also for solid target case!)
Details of the reactions that took place are shown in these figures.
The reaction cross section files are appropriately specified.</p>
<p>This figure is the reaction energy at CM system.</p>
<figure><img src="/artemis_crib/example/simulation/nbodyreaction/reac_energy.png" width="400">
</figure>

<p>This distribution was created from a file of reaction cross section.
The effect of beam energy spread is included, so the edge of the peak is not sharp.</p>
<p>According to this energy distribution, the distribution of the positions of the reactions is as follows.</p>
<figure><img src="/artemis_crib/example/simulation/nbodyreaction/reac_position.png" width="400">
</figure>

<p>The angular distribution at CM system of reactions is assumed to be uniform.
This figure shows the direction of one particle that is produced from this reaction.</p>
<figure><img src="/artemis_crib/example/simulation/nbodyreaction/reac_angle.png" width="400">
</figure>

<p>Also the relationship between the kinematics of the reactions will be like this.</p>
<p><figure><img src="/artemis_crib/example/simulation/nbodyreaction/reac_kinematics1.png" width="400">
</figure>

<figure><img src="/artemis_crib/example/simulation/nbodyreaction/reac_kinematics2.png" width="400">
</figure>
</p>

            <footer class="footline">
              <i class='fa-fw fas fa-user'></i> <a href="mailto:kodak2022@outlook.jp">okawak</a>
              <i class='fa-fw fas fa-calendar'></i> Jul 19, 2024
            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>

<h1 id="geometry">Geometry</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2024-07-19 by Kodai Okawa</span></span>
<p>Configure detector geometry to judge if the reaction particle hit the detector or not.</p>

<div class="tab-panel" data-tab-group="fcfc069e6efefb2e5eba9694ad8adad3">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="prmgeoexampleyaml"
      class="tab-nav-button tab-panel-style cstyle initial active" tabindex="-1"
      onclick="switchTab('fcfc069e6efefb2e5eba9694ad8adad3','prmgeoexampleyaml')"
    >
      <span class="tab-nav-text">prm/geo/example.yaml</span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="prmgeoexampleyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight wrap-code"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">material</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Vaccum</span><span class="w"> </span><span class="c"># id=0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">atomic_mass</span><span class="p">:</span><span class="w"> </span><span class="m">0.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">atomic_num</span><span class="p">:</span><span class="w"> </span><span class="m">0.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">density</span><span class="p">:</span><span class="w"> </span><span class="m">0.0</span><span class="w"> </span><span class="c"># g/cm3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Si</span><span class="w"> </span><span class="c"># id=1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">atomic_mass</span><span class="p">:</span><span class="w"> </span><span class="m">28.084</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">atomic_num</span><span class="p">:</span><span class="w"> </span><span class="m">14.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">density</span><span class="p">:</span><span class="w"> </span><span class="m">2.321</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># Note: beam axis -&gt; z, upper direction -&gt; y</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">conposition</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">detector</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">tel1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">strip</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="m">16</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">center_rotation</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">0</span><span class="l">., 0., 322.0]</span><span class="w"> </span><span class="c"># mm</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">offset</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">0</span><span class="l">., 0., 0.]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">distance</span><span class="p">:</span><span class="w"> </span><span class="m">244.0</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">angle</span><span class="p">:</span><span class="w"> </span>-<span class="m">4.0</span><span class="w"> </span><span class="c"># deg</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">thickness</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">0.02</span><span class="p">,</span><span class="w"> </span><span class="m">0.301</span><span class="p">,</span><span class="w"> </span><span class="m">1.494</span><span class="p">,</span><span class="w"> </span><span class="m">1.486</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">pedestal</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">0</span><span class="l">., 0., 0., 0.]</span><span class="w"> </span><span class="c"># MeV, below this energy, assume 0 MeV</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">material</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="l">Si]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">tel2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">strip</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="m">16</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">center_rotation</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">0</span><span class="l">., 0., 322.0]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">offset</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">0</span><span class="l">., 0., 0.]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">distance</span><span class="p">:</span><span class="w"> </span><span class="m">154.5</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">angle</span><span class="p">:</span><span class="w"> </span><span class="m">27.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">thickness</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">0.02</span><span class="p">,</span><span class="w"> </span><span class="m">0.300</span><span class="p">,</span><span class="w"> </span><span class="m">1.494</span><span class="p">,</span><span class="w"> </span><span class="m">1.485</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">pedestal</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">0</span><span class="l">., 0., 0., 0.]</span><span class="w"> </span><span class="c"># MeV, below this energy, assume 0 MeV</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">material</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="l">Si]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">volume</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">top</span><span class="p">:</span><span class="w"> </span><span class="c"># detector world</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">TOP</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">box</span><span class="w"> </span><span class="c"># now only box is available</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">material</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">size</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">400.0</span><span class="p">,</span><span class="w"> </span><span class="m">200.0</span><span class="p">,</span><span class="w"> </span><span class="m">1288.0</span><span class="p">]</span><span class="w"> </span><span class="c"># mm</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">detector</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">tel1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">box</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">material</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">size</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">50.0</span><span class="p">,</span><span class="w"> </span><span class="m">50.0</span><span class="p">,</span><span class="w"> </span><span class="m">1.0</span><span class="p">]</span><span class="w"> </span><span class="c"># mm</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">tel2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">box</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">material</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">size</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">50.0</span><span class="p">,</span><span class="w"> </span><span class="m">50.0</span><span class="p">,</span><span class="w"> </span><span class="m">1.0</span><span class="p">]</span><span class="w"> </span><span class="c"># mm</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>The geometry information is used only for the judgement, so any material is actually okay.</p>
<p>The <code>material</code> node is used to define <code>TGeoMaterial</code> and <code>TGeoMedium</code> classes.
From <strong>name</strong> to <strong>density</strong> node are used to make a instance of this object.
This values are not used in the current processors.</p>
<p>The next <code>conposition</code> node define the detector configuration.
General telescopes of the CRIB experiment consist of <strong>DSSSD</strong> and <strong>SSD</strong> (single-pad),
and the node below defines the SSD of the telescope.</p>
<ul>
<li>name: Name of the telescope. For example tel1, tel2, and so on.</li>
<li>strip: X x Y strip number. It is defined as an array like [16, 32], this means X:16 strips and Y:32 strips</li>
<li>thickness: Thickness of the each layer. If there are two layer, the size of the array become two. You can add to any size. The unit is <strong>mm</strong>.</li>
<li>material: material of the each layer. The string is used in <code>SRIMlib</code> calculation. This node is defined as a array for each layer, but if it is one, the same material is applied. For example, in example.yaml, [Si] means [Si, Si, Si, Si]. (You need to prepare SRIMlib setting beforehand!)</li>
</ul>
<p>As for the node is <code>center_rotation</code>, <code>offset</code>, <code>distance</code> and <code>angle</code>, please see this figure.</p>
<figure><img src="/artemis_crib/example/simulation/geometry/../geo_example.png">
</figure>

<p>Please note that the center_rotation and offset are defined in (x, y, z) coordinate, and distance and angle are scalar value.
The unit of length is <code>mm</code>, angle is <code>deg</code>.</p>

<div class="box notices cstyle info">
  <div class="box-label"><i class="fa-fw fas fa-info-circle"></i> Info</div>
  <div class="box-content">

<p>The sign of the angle is defined as positive at this figure (right-hand system).
And generally, we set z=0 at target position. (For the gas target, we set 0 at window position.)</p>
</div>
</div>
<p>The last part <code>volume</code> node, the shape of the detector will be defined by using <code>TGeoVolume</code> class.
The TGeoVolume needs <strong>name</strong>, <strong>type</strong>, <strong>material</strong> and <strong>size</strong>.
For the type, I only prepared &ldquo;box&rdquo;. (It means the code use only vol-&gt;MakeBox method.)</p>
<p>The first <code>top</code> node must be set because it defined &ldquo;detector world&rdquo;.
Generally, the material is okay to set vaccum.
And the material is defined in the <code>material</code> node, and the id (the order) can be used.
So the format is like <code>material: 0</code>.
And the size is generally set to the size of the scattering chamber, but for the safety, it is okay to set larger number.
Also the unit is <code>mm</code> and format is (x, y, z).</p>
<p>Next, at the <code>volume/detector</code> node, we can define the detector size.</p>

<div class="box notices cstyle warning">
  <div class="box-label"><i class="fa-fw fas fa-exclamation-triangle"></i> Warning</div>
  <div class="box-content">

<p>NOTE: the <code>volume/detector/name</code> should be the same with <code>conposition/detector/name</code> node.</p>
</div>
</div>
<hr>
<p>Then, let&rsquo;s check if the parameter file can be correctly used.</p>

<div class="tab-panel" data-tab-group="5a12c9362777d1f15093bea4a435f81e">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="steeringgeo_exampleyaml"
      class="tab-nav-button tab-panel-style cstyle initial active" tabindex="-1"
      onclick="switchTab('5a12c9362777d1f15093bea4a435f81e','steeringgeo_exampleyaml')"
    >
      <span class="tab-nav-text">steering/geo_example.yaml</span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="steeringgeo_exampleyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight wrap-code"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">Anchor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">Processor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">detector_initialize</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TUserGeoInitializer</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">FileName</span><span class="p">:</span><span class="w"> </span><span class="l">prm/geo/example.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">Visible</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">OutputTransparency</span><span class="p">:</span><span class="w"> </span><span class="m">1</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>This steering file doesn&rsquo;t use event loop.
Just we want to check the parameter file works well or not.</p>
<p>Then let&rsquo;s see in the artemis!</p>
<div class="highlight wrap-code"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ acd
</span></span><span class="line"><span class="cl">$ a
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">-- snip --
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>0<span class="o">]</span> add steering/geo_example.yaml
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">-- snip --
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>1<span class="o">]</span> ls
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> artemis
</span></span><span class="line"><span class="cl">&gt;   <span class="m">0</span> TGeoVolume TOP             Top volume
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>2<span class="o">]</span></span></span></code></pre></div><p>The detector geometry object is successfully generated!
In order to check the object, please use <a href="https://github.com/okawak/artemis_crib/blob/main/src-crib/commands/TCmdDraw.cc" rel="external" target="_blank">draw</a> command for example.
(It is defined only in CRIB artemis, to draw not only histogram object. This is under development.)</p>
<p>Or you can get the object with some methods and <code>obj-&gt;Draw()</code> will work.</p>
<div class="highlight wrap-code"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>2<span class="o">]</span> draw <span class="m">0</span></span></span></code></pre></div><figure><img src="/artemis_crib/example/simulation/geometry/../geo_canvas.png">
</figure>

<p>The red box is the TOP, and the black boxes are detectors.
If the detector is placed where you expect it to be, the parameters have been successfully set!</p>

            <footer class="footline">
              <i class='fa-fw fas fa-user'></i> <a href="mailto:kodak2022@outlook.jp">okawak</a>
              <i class='fa-fw fas fa-calendar'></i> Jul 19, 2024
            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>

<h1 id="detect-particles">Detect particles</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2024-07-22 by Kodai Okawa</span></span>
<p>Using the defined reactions (TNBodyReactionProcessor) and geometry (TUserGeoInitialiser) so far,
it is possible to determine whether the particles enter the detector after the reaction and to simulate the parameters obtained.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">detector_proc</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TDetectParticleProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">InputCollection</span><span class="p">:</span><span class="w"> </span><span class="l">products</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">InputTrackCollection</span><span class="p">:</span><span class="w"> </span><span class="l">track</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputCollection</span><span class="p">:</span><span class="w"> </span><span class="l">detects</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="c"># target information (use if gas target)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">TargetIsGas</span><span class="p">:</span><span class="w"> </span><span class="cp">*target_is_gas</span><span class="w"> </span><span class="c"># true -&gt; gas target</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">TargetName</span><span class="p">:</span><span class="w"> </span><span class="cp">*target_name</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">TargetPressure</span><span class="p">:</span><span class="w"> </span><span class="cp">*target_pressure</span><span class="w"> </span><span class="c"># Torr (used for gas target)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">EnergyResolution</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="m">0.0</span><span class="p">]</span><span class="w"> </span><span class="c"># x 100 = %, det id = 0, 1, ..</span></span></span></code></pre></div><ul>
<li><code>products</code> is an array object of produced ions [id=0 ion, id=1 ion&hellip;]</li>
<li><code>detects</code> is an array object of detected ions [id=0 ion, id=1 ion&hellip;]</li>
</ul>
<h2 id="example-of-the-output">Example of the output</h2>
<p>We will show an example of a simulation performed for a <strong>gas target case</strong>, and resolution = 0.0.</p>
<p>First, this is a figure of the detected position of light particle.
We defined five telescopes in this example, and we can clearly see the position of the detectors.
If we focus on heavy particle, we cannot see the position distribution because all ions are stopped in the gas target.</p>
<figure><img src="/artemis_crib/example/simulation/detect_particle/reac_pos.png" width="400">
</figure>

<p>As an example, we will show you figures of a telescope with the largest angle.
Here is dE-E plots.</p>
<figure><img src="/artemis_crib/example/simulation/detect_particle/dee.png" width="400">
</figure>

<p>The relationship between energy and timing is like this.</p>
<figure><img src="/artemis_crib/example/simulation/detect_particle/et.png" width="400">
</figure>

<p>Also, here is the angular distribution of the LAB system.</p>
<figure><img src="/artemis_crib/example/simulation/detect_particle/angle.png" width="400">
</figure>

<h2 id="summary">Summary</h2>
<p>The processor created by <a href="https://github.com/okawak" rel="external" target="_blank">okawak</a> allows simple simulations to be performed without creating new sources,
if the following conditions are met.</p>
<ul>
<li>use latest version of artemis_crib</li>
<li>properly install and link <a href="https://www.cns.s.u-tokyo.ac.jp/gitlab/hayakawa/tsrim" rel="external" target="_blank">TSrim</a> library</li>
<li>the target is registered the TSrim library</li>
<li>relatively low energy (some parts use classical kinematics)</li>
<li>the shape of the detectors is square (may update?)</li>
</ul>
<p>There are only two files that need to be prepared for the simulation.</p>
<ul>
<li><code>prm/geo/hoge.yaml</code> -&gt; define detector configuration (example <a href="https://github.com/okawak/artemis_crib/blob/main/prm/geo/si26a.yaml" rel="external" target="_blank">prm/geo/si26a.yaml</a>)
<ul>
<li>It is useful to make symbolic link to <code>current</code></li>
</ul>
</li>
<li><code>steering/huga.yaml</code> -&gt; define simulation parameters (example <a href="https://github.com/okawak/artemis_crib/blob/main/steering/simNBodyReaction.yaml" rel="external" target="_blank">steering/simNBodyReaction.yaml</a>)</li>
</ul>

            <footer class="footline">
              <i class='fa-fw fas fa-user'></i> <a href="mailto:kodak2022@outlook.jp">okawak</a>
              <i class='fa-fw fas fa-calendar'></i> Jul 22, 2024
            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>

<h1 id="solidangle">Solidangle</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-09-29 by KodaiOkawa</span></span>
<ul>
<li>Beam_generator</li>
<li>Nbodyreaction</li>
<li>Geometry</li>
<li>Detect_particle</li>
</ul>
<p>As an application of the above four sections, I would like to explain how to calculate solid angles using Monte Carlo methods!</p>

            <footer class="footline">
              <i class='fa-fw fas fa-user'></i> <a href="mailto:okawa@cns.s.u-tokyo.ac.jp">KodaiOkawa</a>
              <i class='fa-fw fas fa-calendar'></i> Sep 29, 2023
            </footer>
          </article>

          </section>
        </div>
      </main>
    </div>
    <script src="/artemis_crib/js/clipboard.min.js?1722332067" defer></script>
    <script src="/artemis_crib/js/perfect-scrollbar.min.js?1722332067" defer></script>
    <script>
      function useMathJax( config ){
        window.MathJax = Object.assign( window.MathJax || {}, {
          tex: {
            inlineMath:  [['\\(', '\\)'], ['$',  '$']],  
            displayMath: [['\\[', '\\]'], ['$$', '$$']], 
          },
          options: {
            enableMenu: false 
          }
        }, config );
      }
      useMathJax( JSON.parse("{}") );
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="/artemis_crib/js/theme.js?1722332067" defer></script>
  </body>
</html>
