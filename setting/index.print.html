<!DOCTYPE html>
<html lang="en-us" dir="ltr" itemscope itemtype="http://schema.org/Article">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.132.1">
    <meta name="generator" content="Relearn 6.1.1">
    <meta name="description" content="This chapter describes how to prepare the configuration file for the experiment.">
    <meta name="author" content="Kodai Okawa">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Setting :: CRIB artemis">
    <meta name="twitter:description" content="This chapter describes how to prepare the configuration file for the experiment.">
    <meta property="og:url" content="https://okawak.github.io/artemis_crib/setting/index.html">
    <meta property="og:site_name" content="CRIB artemis">
    <meta property="og:title" content="Setting :: CRIB artemis">
    <meta property="og:description" content="This chapter describes how to prepare the configuration file for the experiment.">
    <meta property="og:locale" content="en_us">
    <meta property="og:type" content="website">
    <meta itemprop="name" content="Setting :: CRIB artemis">
    <meta itemprop="description" content="This chapter describes how to prepare the configuration file for the experiment.">
    <meta itemprop="dateModified" content="2023-12-23T23:02:21+09:00">
    <meta itemprop="wordCount" content="40">
    <title>Setting :: CRIB artemis</title>
    <link href="https://okawak.github.io/artemis_crib/setting/index.html" rel="canonical" type="text/html" title="Setting :: CRIB artemis">
    <link href="/artemis_crib/setting/index.xml" rel="alternate" type="application/rss+xml" title="Setting :: CRIB artemis"><link rel="icon" href="/artemis_crib/images/crib_overlay.png" type="image/png">

    <link href="/artemis_crib/css/fontawesome-all.min.css?1723774910" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/artemis_crib/css/fontawesome-all.min.css?1723774910" rel="stylesheet"></noscript>
    <link href="/artemis_crib/css/nucleus.css?1723774910" rel="stylesheet">
    <link href="/artemis_crib/css/auto-complete.css?1723774910" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/artemis_crib/css/auto-complete.css?1723774910" rel="stylesheet"></noscript>
    <link href="/artemis_crib/css/perfect-scrollbar.min.css?1723774910" rel="stylesheet">
    <link href="/artemis_crib/css/fonts.css?1723774910" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/artemis_crib/css/fonts.css?1723774910" rel="stylesheet"></noscript>
    <link href="/artemis_crib/css/theme.css?1723774910" rel="stylesheet">
    <link href="/artemis_crib/css/theme-CRIB-theme.css?1723774910" rel="stylesheet" id="R-variant-style">
    <link href="/artemis_crib/css/chroma-relearn-dark.css?1723774910" rel="stylesheet" id="R-variant-chroma-style">
    <link href="/artemis_crib/css/variant.css?1723774910" rel="stylesheet">
    <link href="/artemis_crib/css/print.css?1723774910" rel="stylesheet" media="print">
    <link href="/artemis_crib/css/format-print.css?1723774910" rel="stylesheet">
    <script src="/artemis_crib/js/variant.js?1723774910"></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.relBasePath='..';
      window.relearn.relBaseUri='..\/..';
      window.relearn.absBaseUri='https:\/\/okawak.github.io\/artemis_crib';
      window.index_js_url="/artemis_crib/index.search.js?1723774910";
      // variant stuff
      window.variants && variants.init( [ 'CRIB-theme', 'zen-dark', 'learn', 'relearn-dark' ] );
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
    </script>
 

<script
  async
  src="https://www.googletagmanager.com/gtag/js?id=G-MZF67K577Y"
></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() {
    dataLayer.push(arguments);
  }
  gtag("js", new Date());

  gtag("config", "G-MZF67K577Y");
</script>
 

  </head>
  <body class="mobile-support print" data-url="/artemis_crib/setting/index.html">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide"><button class="topbar-control" onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button>
            </div>
          </div>
          <ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype="http://schema.org/BreadcrumbList"><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><span itemprop="name">Setting</span><meta itemprop="position" content="1"></li>
          </ol>
          <div class="topbar-area topbar-area-end" data-area="end">
            <div class="topbar-button topbar-button-prev" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="/artemis_crib/installation/art_analysis/index.html" title="art_analysis (ðŸ¡)"><i class="fa-fw fas fa-chevron-left"></i></a>
            </div>
            <div class="topbar-button topbar-button-next" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="/artemis_crib/setting/new_experiment/index.html" title="New experiment (ðŸ¡’)"><i class="fa-fw fas fa-chevron-right"></i></a>
            </div>
          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable chapter narrow" tabindex="-1">
        <div class="flex-block-wrapper">
          <article class="chapter">
            <header class="headline">
            </header>
<div class="article-subheading">Chapter 2</div>

<h1 id="setting">Setting</h1>

<p>This chapter describes how to prepare the configuration file for the experiment.
If you have already some CRIB artemis environment, please see from here for initial settings.</p>

<ul class="children children-li children-sort-">
	
<li><a href="/artemis_crib/setting/new_experiment/index.html">New experiment</a></li>
<li><a href="/artemis_crib/setting/new_user/index.html">New user</a></li>
<li><a href="/artemis_crib/setting/build/index.html">Build</a></li>
<li><a href="/artemis_crib/setting/artemis_commands/index.html">artemis commands</a></li>
<li><a href="/artemis_crib/setting/map_config/index.html">Map configuration</a></li>
<li><a href="/artemis_crib/setting/steering/index.html">Steering</a></li>
<li><a href="/artemis_crib/setting/histograms/index.html">Histograms</a></li>
<li><a href="/artemis_crib/setting/vncserver/index.html">VNC server</a></li>
</ul>

            <footer class="footline">
              <i class='fa-fw fas fa-user'></i> <a href="mailto:okawa@cns.s.u-tokyo.ac.jp">KodaiOkawa</a>
              <i class='fa-fw fas fa-calendar'></i> Dec 23, 2023
            </footer>
          </article>

          <section>
            <h1 class="a11y-only">Subsections of Setting</h1>
          <article class="default">
            <header class="headline">
<div class=" taxonomy-tags term-list cstyle  tags" title="Tags" style="--VARIABLE-TAGS-BG-color: var(--INTERNAL-TAG-BG-color);">
  <ul>
    <li><a class="term-link" href="/artemis_crib/tags/crib/index.html">CRIB</a></li>
  </ul>
</div>
            </header>

<h1 id="new-experiment">New experiment</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-11-05 by Kodai Okawa</span></span>
<p>If you installed with &ldquo;curl&rdquo; command explained previous chapter, you should have <code>artnew</code> command.
This command will make new experiment directory interactively.</p>
<p>Before using this command, please check and make the <strong>directory structure</strong>!</p>
<ul>
<li>rawdata directory (like /mnt/data or /data? Create it to suit your situation.)</li>
<li>output rootfile directory (like /data/art_output?)</li>
<li>git repository
<ul>
<li>local repository: suit for online analysis</li>
<li>remote repository: suit for offline analysis</li>
</ul>
</li>
</ul>
<hr>
<h3 id="lets-start-artnew-command">Let&rsquo;s start &ldquo;artnew&rdquo; command!</h3>
<p>The word after &ldquo;:&rdquo; is your input.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; artnew</span></span></code></pre></div><ol>
<li>Input the experiment name</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">create new artemis work directory? (y/n): y
</span></span><span class="line"><span class="cl">Input experimental name: test
</span></span><span class="line"><span class="cl">Is it OK? (y/n): y
</span></span><span class="line"><span class="cl">Input value: test</span></span></code></pre></div><ol start="2">
<li>Check the base directory (default value is fine!)
<strong>If there are no input, the default value will be used</strong>.</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">artnew: If no input is provided, the default value is used.
</span></span><span class="line"><span class="cl">Input repository path or URL (default: https://github.com/okawak/artemis_crib.git):
</span></span><span class="line"><span class="cl">Is it OK? (y/n): y
</span></span><span class="line"><span class="cl">Input value: https://github.com/okawak/artemis_crib.git</span></span></code></pre></div><ol start="3">
<li>Input the rawdata directory</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">Input rawdata directory path (default: /data/test/ridf):
</span></span><span class="line"><span class="cl">Is it OK? (y/n): y
</span></span><span class="line"><span class="cl">Input value: /data/test/ridf</span></span></code></pre></div><ol start="4">
<li>Input the output directory</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">Input output data directory path (default: /data/test/user):
</span></span><span class="line"><span class="cl">Is it OK? (y/n): y
</span></span><span class="line"><span class="cl">Input value: /data/test/user</span></span></code></pre></div><ol start="5">
<li>Input the git setting (PLEASE MAKE your own repository. Local repository will be fine)</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">Based on the repository, do you make your own repository? (y/n): y
</span></span><span class="line"><span class="cl">is it local repository (y/n): y
</span></span><span class="line"><span class="cl">artnew: making LOCAL repository of test
</span></span><span class="line"><span class="cl">Input the local repository path (default: $HOME/repos/exp):
</span></span><span class="line"><span class="cl">Is it OK? (y/n): y
</span></span><span class="line"><span class="cl">Input value: /home/crib/repos/exp
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">-- snip --
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">art_analysis setting for test is finished!</span></span></code></pre></div><p>The initial setting is completed!!</p>

            <footer class="footline">
              <i class='fa-fw fas fa-user'></i> <a href="mailto:okawa@cns.s.u-tokyo.ac.jp">KodaiOkawa</a>
              <i class='fa-fw fas fa-calendar'></i> Nov 5, 2023
            </footer>
          </article>

          <article class="default">
            <header class="headline">
<div class=" taxonomy-tags term-list cstyle  tags" title="Tags" style="--VARIABLE-TAGS-BG-color: var(--INTERNAL-TAG-BG-color);">
  <ul>
    <li><a class="term-link" href="/artemis_crib/tags/crib/index.html">CRIB</a></li>
  </ul>
</div>
            </header>

<h1 id="new-user">New user</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-11-05 by Kodai Okawa</span></span>
<p>After <code>artnew</code> command, you can see new directory of config files.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-diff" data-lang="diff"><span class="line"><span class="cl"> &gt; tree -a art_analysis
</span></span><span class="line"><span class="cl"> art_analysis
</span></span><span class="line"><span class="cl"> â”œâ”€â”€ .conf
</span></span><span class="line"><span class="cl"> â”‚Â Â  â”œâ”€â”€ artlogin.sh
</span></span><span class="line"><span class="cl"><span class="gi">+â”‚Â Â  â””â”€â”€ test.sh
</span></span></span><span class="line"><span class="cl"><span class="gi"></span> â”œâ”€â”€ bin
</span></span><span class="line"><span class="cl"> â”‚Â Â  â”œâ”€â”€ art_check
</span></span><span class="line"><span class="cl"> â”‚Â Â  â”œâ”€â”€ art_setting
</span></span><span class="line"><span class="cl"> â”‚Â Â  â””â”€â”€ artnew
</span></span><span class="line"><span class="cl"><span class="gi">+â””â”€â”€ test
</span></span></span></code></pre></div><p>This is experiment name &ldquo;test&rdquo; example.
In order to load this script <code>test.sh</code>, please modify &ldquo;EXP_NAME&rdquo; environment valiable in .zshrc.</p>

<div class="tab-panel" data-tab-group="b447537b227a82978e7c7f6851c20ad8">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="bashrczshrc"
      class="tab-nav-button tab-panel-style cstyle initial active" tabindex="-1"
      onclick="switchTab('b447537b227a82978e7c7f6851c20ad8','bashrczshrc')"
    >
      <span class="tab-nav-text">.bashrc/.zshrc</span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="bashrczshrc"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">EXP_NAME</span><span class="o">=</span><span class="s2">&#34;test&#34;</span> <span class="c1"># your experiment</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>And load the config file.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; <span class="nb">source</span> ~/.zshrc</span></span></code></pre></div><p>Then you can make your own work directory by using <code>artlogin</code> command!</p>
<h3 id="lets-start-artlogin-command">Let&rsquo;s start &ldquo;artlogin&rdquo; command!</h3>
<p>For example, let&rsquo;s make default user (user name is the same with experiment name)!</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; artlogin</span></span></code></pre></div><p>If you want to make your own directory, the following will work.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; artlogin yourname</span></span></code></pre></div><ol>
<li>Check if you really want to make your work directory</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">artlogin: user &#39;test&#39; not found.
</span></span><span class="line"><span class="cl">create new user? (y/n): y
</span></span><span class="line"><span class="cl">Cloning into &#39;/Users/okawa/art_analysis/test/test&#39;...
</span></span><span class="line"><span class="cl">done.</span></span></code></pre></div><ol start="2">
<li>Git setting</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">artlogin: making local git config
</span></span><span class="line"><span class="cl">Input fullname: KodaiOkawa
</span></span><span class="line"><span class="cl">Is it Okay? (y/n): y
</span></span><span class="line"><span class="cl">Input email address: okawa@cns.s.u-tokyo.ac.jp
</span></span><span class="line"><span class="cl">Is it Okay? (y/n): y</span></span></code></pre></div><ol start="3">
<li>Symbolic link setting. If there are no problem, the current directory move to your artemis work directory</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; <span class="nb">pwd</span>
</span></span><span class="line"><span class="cl">/home/crib/art_analysis/test/test
</span></span><span class="line"><span class="cl">&gt; ls -l</span></span></code></pre></div><p>If your synbolic link seems okay, the setting is all!</p>
<hr>
<p>If <code>artnew</code> setting have problem, the error message will appear.
Typical examples are as follows.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">mkdir: /data: Read-only file system</span></span></code></pre></div><p>This is a case of the directory permissions not being set correctly.
Use the <code>chmod</code> command or similar to set them correctly and try again.</p>

            <footer class="footline">
              <i class='fa-fw fas fa-user'></i> <a href="mailto:okawa@cns.s.u-tokyo.ac.jp">KodaiOkawa</a>
              <i class='fa-fw fas fa-calendar'></i> Nov 5, 2023
            </footer>
          </article>

          <article class="default">
            <header class="headline">
<div class=" taxonomy-tags term-list cstyle  tags" title="Tags" style="--VARIABLE-TAGS-BG-color: var(--INTERNAL-TAG-BG-color);">
  <ul>
    <li><a class="term-link" href="/artemis_crib/tags/crib/index.html">CRIB</a></li>
  </ul>
</div>
            </header>

<h1 id="build">Build</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-11-14 by Kodai Okawa</span></span>
<p>Before starting analysis, you need to build.
The current version of the artemis use &ldquo;cmake&rdquo; so the following steps must be taken.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; artlogin <span class="o">(</span>username<span class="o">)</span>
</span></span><span class="line"><span class="cl">&gt; mkdir build <span class="o">&amp;&amp;</span> <span class="nb">cd</span> build
</span></span><span class="line"><span class="cl">&gt; cmake ..
</span></span><span class="line"><span class="cl">&gt; make -j4
</span></span><span class="line"><span class="cl">&gt; make install
</span></span><span class="line"><span class="cl">&gt; acd</span></span></code></pre></div><p><code>acd</code> is the alias command that is definded after artlogin command. (acd = cd your_work_directory)
Also if you changed some processor, you need to do these process.</p>
<p>Then some important configuration files are automatically created.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-diff" data-lang="diff"><span class="line"><span class="cl"> &gt; tree -L 1
</span></span><span class="line"><span class="cl"> .
</span></span><span class="line"><span class="cl"><span class="gi">+â”œâ”€â”€ artemislogon.C
</span></span></span><span class="line"><span class="cl"><span class="gi">+â”œâ”€â”€ thisartemis-crib.sh
</span></span></span><span class="line"><span class="cl"><span class="gi"></span>
</span></span><span class="line"><span class="cl"> -- snip --
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> â””â”€â”€ run_artemis.cpp
</span></span></code></pre></div><p>Before starting artemis, you need to load the <code>thisartemis-crib.sh</code>.
The <code>artlogin</code> command is also used to read this script, so run this command again after the build.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; artlogin <span class="o">(</span>usename<span class="o">)</span>
</span></span><span class="line"><span class="cl">&gt; a</span></span></code></pre></div><p>Then you can start artemis by using <code>a</code> command!</p>

            <footer class="footline">
              <i class='fa-fw fas fa-user'></i> <a href="mailto:okawa@cns.s.u-tokyo.ac.jp">KodaiOkawa</a>
              <i class='fa-fw fas fa-calendar'></i> Nov 14, 2023
            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>

<h1 id="artemis-commands">artemis commands</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-11-14 by Kodai Okawa</span></span>
<p>Before configuring the settings according to your experiment, let&rsquo;s check that artemis is working!</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; artlogin <span class="o">(</span>username<span class="o">)</span>
</span></span><span class="line"><span class="cl">&gt; a <span class="c1"># start the artemis!</span></span></span></code></pre></div><p>Then the prompt change to the <code>artemis [0]</code>.
This means you are in artemis console!</p>
<p>Analysis using artemis use event loop.
It is therefore necessary to load a file that specifies what kind of analysis is to be performed.
This file is called the <code>steering file</code>.
As an example, let&rsquo;s check the operation using a steering file that only generates random numbers!</p>
<p>The command to load the steering file is <code>add</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>0<span class="o">]</span> add steering/example/example.tmpl.yaml <span class="nv">NUM</span><span class="o">=</span><span class="m">0001</span> <span class="nv">MAX</span><span class="o">=</span><span class="m">10</span></span></span></code></pre></div><p>This means that 10000 random numbers from 0 to MAX=10 are generated (10000 event loops).
NUM=0001 is the ID, so any number is okay (related to outputed file name).</p>
<p>And the command to start the event loop is <code>resume</code>.
(Often abbreviated as &ldquo;resume&rdquo; or &ldquo;re&rdquo;.
The abbreviated form will also run without problems if there are no conflicts with other commands.)</p>
<div class="highlight wrap-code"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>1<span class="o">]</span> res
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>2<span class="o">]</span> Info in &lt;art::TTimerProcessor::PostLoop&gt;: <span class="nv">real</span> <span class="o">=</span> 0.02, <span class="nv">cpu</span> <span class="o">=</span> 0.02 sec, total <span class="m">10000</span> events, rate 500000.00 evts/sec</span></span></code></pre></div><p>When the time taken for such an analysis is displayed, it means that all event loops have been completed.
If you are doing a time-consuming analysis and want to suspend the event loop in the middle, <code>suspend</code> command is used. (Often &ldquo;sus&rdquo; or &ldquo;su&rdquo; is used.)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>2<span class="o">]</span> sus</span></span></code></pre></div><p>This event loop creates histogram objects (inherit from TH1 or TH2) and a TTree object.
Let&rsquo;s look at how to access each of these.</p>
<h2 id="histogram">Histogram</h2>
<p>Details are given in the <a href="https://okawak.github.io/artemis_crib/setting/histograms/index.html" rel="external" target="_blank">Histograms section</a>, but histograms are created in an internal directory.
To access it, you need to use the same commands as for the linux command, such as &ldquo;ls&rdquo; or &ldquo;cd&rdquo;, to get to that directory.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>2<span class="o">]</span> ls
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> artemis
</span></span><span class="line"><span class="cl">&gt;   <span class="m">0</span> art::TTreeProjGroup test2           <span class="nb">test</span> <span class="o">(</span>2<span class="o">)</span> <span class="c1"># the first &#34;&gt;&#34; means your current position</span>
</span></span><span class="line"><span class="cl">    <span class="m">1</span> art::TTreeProjGroup <span class="nb">test</span>            <span class="nb">test</span>
</span></span><span class="line"><span class="cl">    <span class="m">2</span> art::TAnalysisInfo analysisInfo
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># then let&#39;s move to the &#34;test&#34; directory!</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>3<span class="o">]</span> <span class="nb">cd</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>4<span class="o">]</span> ls
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="nb">test</span>
</span></span><span class="line"><span class="cl">&gt;   <span class="m">0</span> art::TH1FTreeProj hRndm           random value</span></span></code></pre></div><p>You can use the command <code>ht [ID]</code> to display a histogram.
The ID can be omitted if it is already represented by &gt;.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>5<span class="o">]</span> zone <span class="c1"># make artemis canvas</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>6<span class="o">]</span> ht <span class="m">0</span></span></span></code></pre></div><figure><img src="/artemis_crib/setting/artemis_commands/example_test_hist.png" width="600">
</figure>

<p>Next, let&rsquo;s also check the histogram in &ldquo;test2&rdquo; directory and display two histograms vertically at the same time!</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>7<span class="o">]</span> zone <span class="m">2</span> <span class="m">1</span> <span class="c1"># row=2, column=1</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>8<span class="o">]</span> ht <span class="m">0</span> <span class="c1"># show the current hist </span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>9<span class="o">]</span> <span class="nb">cd</span> ..
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>10<span class="o">]</span> ls
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> artemis
</span></span><span class="line"><span class="cl">&gt;   <span class="m">0</span> art::TTreeProjGroup test2           <span class="nb">test</span> <span class="o">(</span>2<span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="m">1</span> art::TTreeProjGroup <span class="nb">test</span>            <span class="nb">test</span>
</span></span><span class="line"><span class="cl">    <span class="m">2</span> art::TAnalysisInfo analysisInfo
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>11<span class="o">]</span> <span class="nb">cd</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> test2
</span></span><span class="line"><span class="cl">&gt;   <span class="m">0</span> art::TH1FTreeProj hRndm2          random number
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>12<span class="o">]</span> ht <span class="m">0</span></span></span></code></pre></div><figure><img src="/artemis_crib/setting/artemis_commands/example_test_hist2.png" width="600">
</figure>

<h2 id="ttree">TTree</h2>
<p>Now consider displaying a diagram from a TTree object.
The file is created at here.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>13<span class="o">]</span> fls
</span></span><span class="line"><span class="cl"> files
</span></span><span class="line"><span class="cl">    <span class="m">0</span> TFile output/0001/example_0001.tree.root            <span class="o">(</span>CREATE<span class="o">)</span></span></span></code></pre></div><p>We use the <code>fcd</code> command to navigate to this root file.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>14<span class="o">]</span> fcd <span class="m">0</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>15<span class="o">]</span> ls
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> output/0001/example_0001.tree.root
</span></span><span class="line"><span class="cl">&gt;   <span class="m">0</span> art::TAnalysisInfo analysisInfo
</span></span><span class="line"><span class="cl">    <span class="m">1</span> art::TArtTree tree            tree</span></span></code></pre></div><p>The command <code>branchinfo</code> (&ldquo;br&rdquo;) displays a list of the branches stored in this tree.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>16<span class="o">]</span> br
</span></span><span class="line"><span class="cl">random               art::TSimpleData</span></span></code></pre></div><p>At the same time, the ROOT command can be used.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>17<span class="o">]</span> tree-&gt;Print<span class="o">()</span>
</span></span><span class="line"><span class="cl">******************************************************************************
</span></span><span class="line"><span class="cl">*Tree    :tree      : tree                                                   *
</span></span><span class="line"><span class="cl">*Entries :    <span class="m">10000</span> : <span class="nv">Total</span> <span class="o">=</span>          <span class="m">600989</span> bytes  File  <span class="nv">Size</span> <span class="o">=</span>      <span class="m">86144</span> *
</span></span><span class="line"><span class="cl">*        :          : Tree compression <span class="nv">factor</span> <span class="o">=</span>   7.00                       *
</span></span><span class="line"><span class="cl">******************************************************************************
</span></span><span class="line"><span class="cl">*Br    <span class="m">0</span> :random    : art::TSimpleData                                       *
</span></span><span class="line"><span class="cl">*Entries :    <span class="m">10000</span> : Total  <span class="nv">Size</span><span class="o">=</span>     <span class="m">600582</span> bytes  File <span class="nv">Size</span>  <span class="o">=</span>      <span class="m">85732</span> *
</span></span><span class="line"><span class="cl">*Baskets :        <span class="m">1</span> : Basket <span class="nv">Size</span><span class="o">=</span>    <span class="m">3200000</span> bytes  <span class="nv">Compression</span><span class="o">=</span>   7.00     *
</span></span><span class="line"><span class="cl">*............................................................................*</span></span></code></pre></div>
<div class="box notices cstyle info">
  <div class="box-label"><i class="fa-fw fas fa-info-circle"></i> Info</div>
  <div class="box-content">

<p>What is stored in the branch is not the usual type like &ldquo;double&rdquo; or &ldquo;int&rdquo;, but a class defined in artemis.
Therefore, the &ldquo;artemis&rdquo; root file cannot be opened by usual ROOT.</p>
</div>
</div>
<p>Accessing data in a branch&rsquo;s data class requires the use of public variables and methods, which can be examined by providing arguments to <code>branchinfo [branch name]</code> or <code>classinfo [class name]</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>18<span class="o">]</span> br random
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> art::TSimpleData
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> Data Members
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> Methods
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                   Bool_t   CheckTObjectHashConsistency
</span></span><span class="line"><span class="cl">             TSimpleData<span class="p">&amp;</span>   <span class="nv">operator</span><span class="o">=</span>
</span></span><span class="line"><span class="cl">             TSimpleData<span class="p">&amp;</span>   <span class="nv">operator</span><span class="o">=</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> See also
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">     art::TSimpleDataBase&lt;double&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>19<span class="o">]</span> cl art::TSimpleDataBase&lt;double&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> art::TSimpleDataBase&lt;double&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> Data Members
</span></span><span class="line"><span class="cl">
</span></span><span class="line hl"><span class="cl">                   double   fValue
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> Methods
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                     void   SetValue
</span></span><span class="line"><span class="cl">                   double   GetValue
</span></span><span class="line"><span class="cl">                   Bool_t   CheckTObjectHashConsistency
</span></span><span class="line"><span class="cl">     TSimpleDataBase&lt;double&gt;<span class="p">&amp;</span>   <span class="nv">operator</span><span class="o">=</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> See also
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">     art::TDataObject       base class <span class="k">for</span> data object</span></span></code></pre></div><p>Therefore, it can be seen that it can be accessed by the value <code>fValue</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>20<span class="o">]</span> zone
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>21<span class="o">]</span> tree-&gt;Draw<span class="o">(</span><span class="s2">&#34;random.fValue&gt;&gt;(100,0.,10.)&#34;</span><span class="o">)</span></span></span></code></pre></div><h2 id="other-useful-commands">Other useful commands</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> <span class="nb">help</span> <span class="c1"># show the commands we can use</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> save <span class="c1"># save the current canvas</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> print <span class="c1"># print the current canvas (send to the printer, need to configure)</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> unzoom
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>*<span class="o">]</span> lgy, lgz, lny, lnz <span class="c1"># linear or log scale</span></span></span></code></pre></div>
            <footer class="footline">
              <i class='fa-fw fas fa-user'></i> <a href="mailto:okawa@cns.s.u-tokyo.ac.jp">KodaiOkawa</a>
              <i class='fa-fw fas fa-calendar'></i> Nov 14, 2023
            </footer>
          </article>

          <article class="default">
            <header class="headline">
<div class=" taxonomy-tags term-list cstyle  tags" title="Tags" style="--VARIABLE-TAGS-BG-color: var(--INTERNAL-TAG-BG-color);">
  <ul>
    <li><a class="term-link" href="/artemis_crib/tags/crib/index.html">CRIB</a></li>
  </ul>
</div>
            </header>

<h1 id="map-configuration">Map configuration</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-11-14 by Kodai Okawa</span></span>
<p>From this section, we start to configure the settings according to the actual experimental setup.
The setting files are followings:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">&gt; tree
</span></span><span class="line"><span class="cl">.
</span></span><span class="line"><span class="cl">â”œâ”€â”€ mapper.conf
</span></span><span class="line"><span class="cl">â”œâ”€â”€ conf
</span></span><span class="line"><span class="cl">â”‚Â Â  â”œâ”€â”€ map
</span></span><span class="line"><span class="cl">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ ppac
</span></span><span class="line"><span class="cl">â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ dlppac.map
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">-- snip --
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">â”‚Â Â  â””â”€â”€ seg
</span></span><span class="line"><span class="cl">â”‚Â Â      â”œâ”€â”€ modulelist.yaml
</span></span><span class="line"><span class="cl">â”‚Â Â      â””â”€â”€ seglist.yaml
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">-- snip --</span></span></code></pre></div><h3 id="1-what-is-the-map-file">1. What is the map file?</h3>
<p>The data obtained from an ADC/TDC is in the form of, for example,
&ldquo;The data coming into channel 10 of an ADC with an ID of 1 is 100&rdquo;.</p>

<pre class="mermaid align-center ">
---
title: Data flow example
---
graph LR;
    A{detector} --&gt;|signal| B(TDC/ADC&lt;br&gt;&lt;/br&gt;ID=1, ch=10)
    B --&gt;|value=100| C[&lt;strong&gt;Data build&lt;/strong&gt;\nridf file]
</pre>
<p>The role of the map file is to map this value of &ldquo;100&rdquo; to an ID that is easy to analyse.
An ID that is easy to analyse means, for example,
that even if signals from the same detector are acquired with different ADCs/TDCs,
the same ID is easier to handle in the analysis.</p>

<pre class="mermaid align-center ">
---
title: Data flow example
---
graph LR;
    A(TDC/ADC&lt;br&gt;&lt;/br&gt;ID=1, ch=10) --&gt;|value=100| B[&lt;strong&gt;Data build&lt;/strong&gt;\nridf file]
    B --&gt;|value=100 mapping to| C(analysis&lt;br&gt;&lt;/br&gt;ID=2, ch=20)
</pre>
<p>After mapping, we can check the data of this &ldquo;100&rdquo; from ID=2 and ch=20.
This ID and channel (2, 20) are provided for convenience, so you can freely set them.</p>
<p>So, in summary, the map file role is like this:</p>

<pre class="mermaid align-center ">
---
title: role of the map file
---
graph LR;
    A(DAQ ID&lt;br&gt;&lt;/br&gt;ID=1, ch=10) &lt;--&gt;|mapping| B(analysis ID&lt;br&gt;&lt;/br&gt;ID=2, ch=20)
</pre>
<h3 id="2-map-files">2. map files</h3>
<p>CRIB is using <a href="https://ribf.riken.jp/RIBFDAQ/index.php?FrontPage" rel="external" target="_blank">Babirl</a> for the DAQ system.
In this system, the DAQ ID represented in the example is determined by five parameters.</p>
<ul>
<li>device ID (dev)</li>
<li>focal plane (fp)</li>
<li>detector ID (det)</li>
<li>geometry ID (geo)</li>
<li>channel (ch)</li>
</ul>
<p>The dev, fp, det and geo parameters can be set from DAQ setting.
For the CRIB experiment, conventionally we set dev=12, fp=0&ndash;2 (for each MPV), det=6,7 (6=energy, 7=timing) and geo=from 0.
But you can change it freely.</p>
<p>And analysis ID represented in the example is determined by two parameters.</p>
<ul>
<li>Category ID (CatID, cid)</li>
<li>id (fID)</li>
</ul>
<p>Of cource you can also set the value freely.</p>
<p>The format of the map file is followings:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl"># [category] [id] [[device] [focus] [detector] [geo] [ch]] ....
</span></span><span class="line"><span class="cl">   1,   0,  12,   1,  6,   0,   0</span></span></code></pre></div>
<div class="box notices cstyle note">
  <div class="box-label"><i class="fa-fw fas fa-exclamation-circle"></i> Note</div>
  <div class="box-content">

<ul>
<li>The id should start from &ldquo;0&rdquo;.</li>
<li>The ADC/TDC channel start from &ldquo;0&rdquo;.</li>
<li>The leading &ldquo;#&rdquo; is treated as a comment statement.</li>
<li>you can set several &ldquo;DAQ ID&rdquo; to one &ldquo;analysis ID&rdquo; like this:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl"># map for SSD
</span></span><span class="line"><span class="cl"># [category] [id] [[device] [focus] [detector] [geo] [ch]] ....
</span></span><span class="line"><span class="cl">#
</span></span><span class="line"><span class="cl"># Map: energy, timing
</span></span><span class="line"><span class="cl">#
</span></span><span class="line"><span class="cl">#--------------------------------------------------------------------
</span></span><span class="line"><span class="cl">   1,   0,  12,   1,  6,   0,   0,  12,   2,  7,   0,   0</span></span></code></pre></div></div>
</div>
<p>Please create map files for all detectors like this!</p>
<h3 id="3-mapperconf">3. mapper.conf</h3>
<p>You can select the map file to be loaded with this file.
This is especially useful when separating map files for testing from map files for the experiment.</p>
<p>The format is followings: (<code>path/to/the/map/file number</code>)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl"># file path for configuration, relative to the working directory
</span></span><span class="line"><span class="cl"># (path to the map file) (Number of columns)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># cid = 1: rf
</span></span><span class="line"><span class="cl">conf/map/rf/rf.map 1</span></span></code></pre></div><p>In the note example above, the number is 2.</p>
<p>Please do not forget to add to the mapper.conf after you add some map files.</p>
<h3 id="4-option-segment-files">4. (option) segment files</h3>
<p>This conf files are used when you use &ldquo;chkseg.yaml&rdquo; steering file.
This steering file create raw data 2D histograms.
I will describe in the <a href="https://okawak.github.io/artemis_crib/example/online_analysis/check_rawdata/" rel="external" target="_blank">Example: online_analysis/Check raw data</a> in detail.</p>

            <footer class="footline">
              <i class='fa-fw fas fa-user'></i> <a href="mailto:okawa@cns.s.u-tokyo.ac.jp">KodaiOkawa</a>
              <i class='fa-fw fas fa-calendar'></i> Nov 14, 2023
            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>

<h1 id="steering">Steering</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-11-14 by Kodai Okawa</span></span>
<p>The <code>steering</code> file (yaml format) is a file that directs the process of how the obtained data is to be processed.
The <code>artemis</code> is an object-oriented program whose components are called <code>processors</code>, which are combined to process data.</p>
<p>The main role of the &ldquo;processor&rdquo; is to process data from an input data called <code>InputCollection</code> and create an output data called <code>OutputCollection</code>.
This &ldquo;OutputCollection&rdquo; will be stored into the root file as a &ldquo;tree&rdquo;.
Complex processing can be performed by using &ldquo;processor&rdquo; in multiple steps.</p>
<p>I will explain how to create this &ldquo;steering&rdquo; file using Si detector data as an example.</p>

<pre class="mermaid align-center ">
---
title: example of the data process structure
---
graph TD;
    subgraph event loop
    A--&gt;B(mapping processor&lt;br&gt;&lt;/br&gt;InputCollection: decoded data\nOutputCollection: Si raw data)
    B--&gt;C(calibration processor&lt;br&gt;&lt;/br&gt;InputCollection: Si raw data\nOutputCollection: Si calibrated data)
    C--&gt;X((event end))
    X--&gt;A
    end
    subgraph DAQ
    D(Raw binary data)--&gt;A(decode processor&lt;br&gt;&lt;/br&gt;InputCollection: raw data\nOutputCollection: decoded data)
    end
</pre>
<h2 id="steering-file-silicon-data-case">Steering file: Silicon data case</h2>
<p>First, I describe what is the <code>Anchor</code> and how to use command line arguments.
See example here.</p>

<div class="tab-panel" data-tab-group="fd9fd43b517a8b0f932bee41ce6c94db">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="chkssdyaml"
      class="tab-nav-button tab-panel-style cstyle initial active" tabindex="-1"
      onclick="switchTab('fd9fd43b517a8b0f932bee41ce6c94db','chkssdyaml')"
    >
      <span class="tab-nav-text">chkssd.yaml</span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="chkssdyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">Anchor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span>- <span class="cp">&amp;input</span><span class="w"> </span><span class="l">ridf/@NAME@@NUM@.ridf</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span>- <span class="cp">&amp;output</span><span class="w"> </span><span class="l">output/@NAME@/@NUM@/chkssd@NAME@@NUM@.root</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span>- <span class="cp">&amp;histout</span><span class="w"> </span><span class="l">output/@NAME@/@NUM@/chkssd@NAME@@NUM@.hist.root</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>You can use variables from elsewhere in the steering file by declaring them as such.
For example if you write:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">something</span><span class="p">:</span><span class="w"> </span><span class="cp">*input</span></span></span></code></pre></div><p>This unfolds as follows:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">something</span><span class="p">:</span><span class="w"> </span><span class="l">ridf/@NAME@@NUM@.ridf</span></span></span></code></pre></div><p>Variables enclosed in <code>@</code> can also be specified by command line arguments.
For example, If you command like the following in the artemis console,</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>1<span class="o">]</span> add steering/chkssd.yaml <span class="nv">NAME</span><span class="o">=</span>run <span class="nv">NUM</span><span class="o">=</span><span class="m">0000</span></span></span></code></pre></div><p>it is considered as</p>

<div class="tab-panel" data-tab-group="2e5846f27426091dae92403db731b8e8">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="chkssdyaml"
      class="tab-nav-button tab-panel-style cstyle initial active" tabindex="-1"
      onclick="switchTab('2e5846f27426091dae92403db731b8e8','chkssdyaml')"
    >
      <span class="tab-nav-text">chkssd.yaml</span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="chkssdyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">Anchor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span>- <span class="cp">&amp;input</span><span class="w"> </span><span class="l">ridf/run0000.ridf</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span>- <span class="cp">&amp;output</span><span class="w"> </span><span class="l">output/run/0000/chkssdrun0000.root</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span>- <span class="cp">&amp;histout</span><span class="w"> </span><span class="l">output/run/0000/chkssdrun0000.hist.root</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><h3 id="1-general-processor">1. General processor</h3>
<p>When using the &ldquo;Babirl&rdquo;, the data file will be in the form of &ldquo;ridf&rdquo;.
In this case, the beginning and end of the steering file is usually as follows.</p>

<div class="tab-panel" data-tab-group="5edc78607c802808424a8848ef35dda4">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="chkssdyaml"
      class="tab-nav-button tab-panel-style cstyle initial active" tabindex="-1"
      onclick="switchTab('5edc78607c802808424a8848ef35dda4','chkssdyaml')"
    >
      <span class="tab-nav-text">chkssd.yaml</span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="chkssdyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">Processor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">timer</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TTimerProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">ridf</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TRIDFEventStore</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputTransparency</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">InputFiles</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="cp">*input</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">SHMID</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">mapper</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TMappingProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputTransparency</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># -- snip --</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">outputtree</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TOutputTreeProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">FileName</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="cp">*output</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><ul>
<li>TTimerProcessor: measure the time taken to process data</li>
<li>TRIDFEventStore: decode the ridf file and store the value in <code>EventStore</code> (see below)</li>
<li>TMappingProcessor: read mapper.conf for mapping</li>
<li>TOutputTreeProcessor: writes data to the root file</li>
</ul>
<p><code>OutputTransparency</code> is set to 1, indicating that &ldquo;OutputCollection&rdquo; is not exported to the root file.</p>
<h3 id="2-mapping-processor">2. Mapping processor</h3>
<p>The &ldquo;mapping processor&rdquo; puts the data stored in the &ldquo;EventStore&rdquo; into a certain data class based on &ldquo;mapper.conf&rdquo;.
Assume the following map file is used.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl"># map for SSD
</span></span><span class="line"><span class="cl"># [category] [id] [[device] [focus] [detector] [geo] [ch]] ....
</span></span><span class="line"><span class="cl">#
</span></span><span class="line"><span class="cl"># Map: energy, timing
</span></span><span class="line"><span class="cl">#
</span></span><span class="line"><span class="cl">#--------------------------------------------------------------------
</span></span><span class="line"><span class="cl">   1,   0,  12,   1,  6,   0,   0,  12,   2,  7,   0,   0</span></span></code></pre></div><p>In this case, since we are assuming data from the Si detector, let&rsquo;s consider putting it in a data class that stores energy and timing data, &ldquo;TTimingChargeData&rdquo;!
The processor mapping to this data class is &ldquo;TTimingChargeMappingProcessor&rdquo;.</p>

<div class="tab-panel" data-tab-group="5aa98bdeebcf494b7fd76694e3ffd8f5">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="chkssdyaml"
      class="tab-nav-button tab-panel-style cstyle initial active" tabindex="-1"
      onclick="switchTab('5aa98bdeebcf494b7fd76694e3ffd8f5','chkssdyaml')"
    >
      <span class="tab-nav-text">chkssd.yaml</span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="chkssdyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">Processor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">proc_ssd_raw</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TTimingChargeMappingProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">CatID</span><span class="p">:</span><span class="w">         </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">ChargeType</span><span class="p">:</span><span class="w">    </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">ChargeTypeID</span><span class="p">:</span><span class="w">  </span><span class="m">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">TimingTypeID</span><span class="p">:</span><span class="w">  </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Sparse</span><span class="p">:</span><span class="w">        </span><span class="m">1</span><span class="w">
</span></span></span><span class="line hl"><span class="cl"><span class="w">      </span><span class="nt">OutputCollection</span><span class="p">:</span><span class="w"> </span><span class="l">ssd_raw</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><ol>
<li>CatID: enter here the same number as the cid (category ID) in the map file.</li>
<li>ChargeType: there are various ways to store energy (charge) and timing using this processor, but this time &ldquo;1&rdquo; is specified to use the processing method using ADC and TDC.</li>
<li>Charge/TimingTypeID: The map file has two sets of five parameters that specify the DAQ ID. Which of these parameters specifies which represents the energy (charge) and timing. (it start from &ldquo;0&rdquo;)</li>
<li>Sparse: parameter for the output data structure</li>
<li>OutputCollection: name of the data class to be output</li>
</ol>
<p>Then, you can access the ssd_raw data by using like <code>tree-&gt;Draw(&quot;ssd_raw.fCharge&quot;)</code></p>
<h3 id="3-calibration-processor">3. Calibration processor</h3>
<p>While the data in the &ldquo;ssd_raw&rdquo; are raw channel of the ADC and TDC, it is important to see the data calibrated to energy and time.
I will explain the details in <a href="/artemis_crib/setting/steering/index.html">Example: preparation/macro</a>, but here I will discuss the calibration processors assuming that the following appropriate calibration files have been created.</p>
<ul>
<li>prm/ssd/ch2MeV.dat</li>
<li>prm/ssd/ch2ns.dat</li>
</ul>
<p>Now, let&rsquo;s load these files.</p>

<div class="tab-panel" data-tab-group="c5c2db9d54de1f4d18980c2c5dcca230">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="chkssdyaml"
      class="tab-nav-button tab-panel-style cstyle initial active" tabindex="-1"
      onclick="switchTab('c5c2db9d54de1f4d18980c2c5dcca230','chkssdyaml')"
    >
      <span class="tab-nav-text">chkssd.yaml</span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="chkssdyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">Processor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">proc_ssd_ch2MeV</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TParameterArrayLoader</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line hl"><span class="cl"><span class="w">      </span><span class="nt">Name</span><span class="p">:</span><span class="w"> </span><span class="l">prm_ssd_ch2MeV</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TAffineConverter</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">FileName</span><span class="p">:</span><span class="w"> </span><span class="l">prm/ssd/ch2MeV.dat</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputTransparency</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">proc_ssd_ch2ns</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TParameterArrayLoader</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line hl"><span class="cl"><span class="w">      </span><span class="nt">Name</span><span class="p">:</span><span class="w"> </span><span class="l">prm_ssd_ch2ns</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TAffineConverter</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">FileName</span><span class="p">:</span><span class="w"> </span><span class="l">prm/ssd/ch2ns.dat</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputTransparency</span><span class="p">:</span><span class="w"> </span><span class="m">1</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>To calibrate data contained in a <code>TTimingChargeData</code> class, a <code>TTimingChargeCalibrationProcessor</code> processor is used.</p>

<div class="tab-panel" data-tab-group="d5a00ca476924c97f1964ac6df97af59">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="chkssdyaml"
      class="tab-nav-button tab-panel-style cstyle initial active" tabindex="-1"
      onclick="switchTab('d5a00ca476924c97f1964ac6df97af59','chkssdyaml')"
    >
      <span class="tab-nav-text">chkssd.yaml</span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="chkssdyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">Processor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">proc_ssd</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TTimingChargeCalibrationProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line hl"><span class="cl"><span class="w">      </span><span class="nt">InputCollection</span><span class="p">:</span><span class="w">      </span><span class="l">ssd_raw</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputCollection</span><span class="p">:</span><span class="w">     </span><span class="l">ssd_cal</span><span class="w">
</span></span></span><span class="line hl"><span class="cl"><span class="w">      </span><span class="nt">ChargeConverterArray</span><span class="p">:</span><span class="w"> </span><span class="l">prm_ssd_ch2MeV</span><span class="w">
</span></span></span><span class="line hl"><span class="cl"><span class="w">      </span><span class="nt">TimingConverterArray</span><span class="p">:</span><span class="w"> </span><span class="l">prm_ssd_ch2ns</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>Note here that &ldquo;InputCollection&rdquo;, &ldquo;ChargeConverterArray&rdquo;, and &ldquo;TimingConverterArray&rdquo; use the same names as the highlighted lines in the code block above.</p>

<div class="box notices cstyle info">
  <div class="box-label"><i class="fa-fw fas fa-info-circle"></i> Info</div>
  <div class="box-content">

<p>The arguments to be used will vary depending on the processor used, so please check and write them according to the situation.
If you want to check from artemis console, you can use &ldquo;processordescription&rdquo; command like this</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; artlogin <span class="o">(</span>username<span class="o">)</span>
</span></span><span class="line"><span class="cl">&gt; a
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>0<span class="o">]</span> processordescription art::TTimingChargeCalibrationProcessor
</span></span><span class="line"><span class="cl">Processor:
</span></span><span class="line"><span class="cl">  - name: MyTTimingChargeCalibrationProcessor
</span></span><span class="line"><span class="cl">    type: art::TTimingChargeCalibrationProcessor
</span></span><span class="line"><span class="cl">    parameter:
</span></span><span class="line"><span class="cl">      ChargeConverterArray: no_conversion  <span class="c1"># [TString] normally output of TAffineConverterArrayGenerator</span>
</span></span><span class="line"><span class="cl">      InputCollection: plastic_raw  <span class="c1"># [TString] array of objects inheriting from art::ITiming and/or art::ICharge</span>
</span></span><span class="line"><span class="cl">      InputIsDigital: <span class="m">1</span>  <span class="c1"># [Bool_t] whether input is digital or not</span>
</span></span><span class="line"><span class="cl">      OutputCollection: plastic  <span class="c1"># [TString] output class will be the same as input</span>
</span></span><span class="line"><span class="cl">      OutputTransparency: <span class="m">0</span>  <span class="c1"># [Bool_t] Output is persistent if false (default)</span>
</span></span><span class="line"><span class="cl">      TimingConverterArray: no_conversion  <span class="c1"># [TString] normally output of TAffineConverterArrayGenerator</span>
</span></span><span class="line"><span class="cl">      Verbose: <span class="m">1</span>  <span class="c1"># [Int_t] verbose level (default 1 : non quiet)</span></span></span></code></pre></div></div>
</div>
<h3 id="4-split-files">4. Split files</h3>
<p>If you want to analyse a large number of detectors, not just Si detectors,
writing everything in one steering file will result in a large amount of content that is difficult to read.</p>
<p>In that case, we can use &ldquo;include&rdquo; node!</p>
<p>In the examples we have written so far, let&rsquo;s only use a separate file for the part related to the analysis of the Si detector.</p>

<div class="tab-panel" data-tab-group="9fb70a63b189ebad5ed3d9d8d0f6f06e">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="chkssdyaml"
      class="tab-nav-button tab-panel-style cstyle initial active" tabindex="-1"
      onclick="switchTab('9fb70a63b189ebad5ed3d9d8d0f6f06e','chkssdyaml')"
    >
      <span class="tab-nav-text">chkssd.yaml</span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="chkssdyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="c"># -- snip --</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">Processor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># -- snip --</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">include</span><span class="p">:</span><span class="w"> </span><span class="l">ssd/ssd_single.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># -- snip --</span></span></span></code></pre></div></div>
    </div>
  </div>
</div>
<div class="tab-panel" data-tab-group="271a9e4516fb1f029125ece4d2c0a12b">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="ssdssd_singleyaml"
      class="tab-nav-button tab-panel-style cstyle initial active" tabindex="-1"
      onclick="switchTab('271a9e4516fb1f029125ece4d2c0a12b','ssdssd_singleyaml')"
    >
      <span class="tab-nav-text">ssd/ssd_single.yaml</span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="ssdssd_singleyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">Processor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># parameter files</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">proc_ssd_ch2MeV</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TParameterArrayLoader</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Name</span><span class="p">:</span><span class="w"> </span><span class="l">prm_ssd_ch2MeV</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TAffineConverter</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">FileName</span><span class="p">:</span><span class="w"> </span><span class="l">prm/ssd/ch2MeV.dat</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputTransparency</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">proc_ssd_ch2ns</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TParameterArrayLoader</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Name</span><span class="p">:</span><span class="w"> </span><span class="l">prm_ssd_ch2ns</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TAffineConverter</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">FileName</span><span class="p">:</span><span class="w"> </span><span class="l">prm/ssd/ch2ns.dat</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputTransparency</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># data process</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">proc_ssd_raw</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TTimingChargeMappingProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">CatID</span><span class="p">:</span><span class="w">         </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">ChargeType</span><span class="p">:</span><span class="w">    </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">ChargeTypeID</span><span class="p">:</span><span class="w">  </span><span class="m">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">TimingTypeID</span><span class="p">:</span><span class="w">  </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Sparse</span><span class="p">:</span><span class="w">        </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputCollection</span><span class="p">:</span><span class="w"> </span><span class="l">ssd_raw</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">proc_ssd</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TTimingChargeCalibrationProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">InputCollection</span><span class="p">:</span><span class="w">      </span><span class="l">ssd_raw</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputCollection</span><span class="p">:</span><span class="w">     </span><span class="l">ssd_cal</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">ChargeConverterArray</span><span class="p">:</span><span class="w"> </span><span class="l">prm_ssd_ch2MeV</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">TimingConverterArray</span><span class="p">:</span><span class="w"> </span><span class="l">prm_ssd_ch2ns</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>In this way, the contents of &ldquo;chkssd.yaml&rdquo; can be kept concise, while the same process is carried out.
Note that the file paths here are relative to the paths from the steering directory.
Parameter files, for example, are relative paths from the working directory (one level down).</p>
<p>Utilising file splitting also makes it easier to check the steering files that analyse a large number of detectors like this.</p>

<div class="tab-panel" data-tab-group="4cb16712c49d9bb60ad50607c471d2ae">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="chkallyaml"
      class="tab-nav-button tab-panel-style cstyle initial active" tabindex="-1"
      onclick="switchTab('4cb16712c49d9bb60ad50607c471d2ae','chkallyaml')"
    >
      <span class="tab-nav-text">chkall.yaml</span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="chkallyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="c"># -- snip --</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">Processor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># -- snip --</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">include</span><span class="p">:</span><span class="w"> </span><span class="l">rf/rf.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">include</span><span class="p">:</span><span class="w"> </span><span class="l">ppac/f1ppac.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">include</span><span class="p">:</span><span class="w"> </span><span class="l">ppac/dlppac.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">include</span><span class="p">:</span><span class="w"> </span><span class="l">mwdc/mwdc.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">include</span><span class="p">:</span><span class="w"> </span><span class="l">ssd/ssd_all.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># -- snip --</span></span></span></code></pre></div></div>
    </div>
  </div>
</div>
<div class="box notices cstyle info">
  <div class="box-label"><i class="fa-fw fas fa-info-circle"></i> Info</div>
  <div class="box-content">

<p>When you include other files, you can set arguments. This can be used, for example, to share variables.
Details will be introduced in the example section.</p>
</div>
</div>
<hr>
<h3 id="summary">Summary</h3>
<p>The whole steering file is as follows:</p>

<div class="tab-panel" data-tab-group="d099e1d19c44fb2b9ab5f9495bb42b5d">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="chkssdyaml"
      class="tab-nav-button tab-panel-style cstyle initial active" tabindex="-1"
      onclick="switchTab('d099e1d19c44fb2b9ab5f9495bb42b5d','chkssdyaml')"
    >
      <span class="tab-nav-text">chkssd.yaml</span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="chkssdyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">Anchor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span>- <span class="cp">&amp;input</span><span class="w"> </span><span class="l">ridf/@NAME@@NUM@.ridf</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span>- <span class="cp">&amp;output</span><span class="w"> </span><span class="l">output/@NAME@/@NUM@/chkssd@NAME@@NUM@.root</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span>- <span class="cp">&amp;histout</span><span class="w"> </span><span class="l">output/@NAME@/@NUM@/chkssd@NAME@@NUM@.hist.root</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">Processor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">timer</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TTimerProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">ridf</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TRIDFEventStore</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputTransparency</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">InputFiles</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="cp">*input</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">SHMID</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">mapper</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TMappingProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputTransparency</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">include</span><span class="p">:</span><span class="w"> </span><span class="l">ssd/ssd_single.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># output root file</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">outputtree</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TOutputTreeProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">FileName</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="cp">*output</span></span></span></code></pre></div></div>
    </div>
  </div>
</div>
<div class="tab-panel" data-tab-group="1de1a3edc6fcba96489829e0179bc505">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="ssdssd_singleyaml"
      class="tab-nav-button tab-panel-style cstyle initial active" tabindex="-1"
      onclick="switchTab('1de1a3edc6fcba96489829e0179bc505','ssdssd_singleyaml')"
    >
      <span class="tab-nav-text">ssd/ssd_single.yaml</span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="ssdssd_singleyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">Processor</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># parameter files</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">proc_ssd_ch2MeV</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TParameterArrayLoader</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Name</span><span class="p">:</span><span class="w"> </span><span class="l">prm_ssd_ch2MeV</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TAffineConverter</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">FileName</span><span class="p">:</span><span class="w"> </span><span class="l">prm/ssd/ch2MeV.dat</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputTransparency</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">proc_ssd_ch2ns</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TParameterArrayLoader</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Name</span><span class="p">:</span><span class="w"> </span><span class="l">prm_ssd_ch2ns</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TAffineConverter</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">FileName</span><span class="p">:</span><span class="w"> </span><span class="l">prm/ssd/ch2ns.dat</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputTransparency</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># data process</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">proc_ssd_raw</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TTimingChargeMappingProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">CatID</span><span class="p">:</span><span class="w">         </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">ChargeType</span><span class="p">:</span><span class="w">    </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">ChargeTypeID</span><span class="p">:</span><span class="w">  </span><span class="m">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">TimingTypeID</span><span class="p">:</span><span class="w">  </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Sparse</span><span class="p">:</span><span class="w">        </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputCollection</span><span class="p">:</span><span class="w"> </span><span class="l">ssd_raw</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">proc_ssd</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TTimingChargeCalibrationProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">InputCollection</span><span class="p">:</span><span class="w">      </span><span class="l">ssd_raw</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputCollection</span><span class="p">:</span><span class="w">     </span><span class="l">ssd_cal</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">ChargeConverterArray</span><span class="p">:</span><span class="w"> </span><span class="l">prm_ssd_ch2MeV</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">TimingConverterArray</span><span class="p">:</span><span class="w"> </span><span class="l">prm_ssd_ch2ns</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; acd
</span></span><span class="line"><span class="cl">&gt; a
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>0<span class="o">]</span> add steering/chkssd.yaml <span class="nv">NAME</span><span class="o">=</span>run <span class="nv">NUM</span><span class="o">=</span><span class="m">0000</span></span></span></code></pre></div>
            <footer class="footline">
              <i class='fa-fw fas fa-user'></i> <a href="mailto:okawa@cns.s.u-tokyo.ac.jp">KodaiOkawa</a>
              <i class='fa-fw fas fa-calendar'></i> Nov 14, 2023
            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>

<h1 id="histograms">Histograms</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-11-14 by Kodai Okawa</span></span>
<p>In the online analysis, it is important to have immediate access to data.
The artemis can produce <strong>TTree</strong> object but long commands are needed to access, for example,</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>1<span class="o">]</span> fcd <span class="m">0</span>  <span class="c1"># move to the created rootfile</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>2<span class="o">]</span> zone <span class="m">2</span> <span class="m">2</span>  <span class="c1"># make a &#34;artemis&#34; 2x2 canvas</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>3<span class="o">]</span> tree-&gt;Draw<span class="o">(</span><span class="s2">&#34;ssd_cal.fCharge:ssd_cal.fTiming&gt;(100,0.,100., 100,0.,100)&#34;</span>,<span class="s2">&#34;ssd_cal.fCharge &gt; 1.0&#34;</span>,<span class="s2">&#34;colz&#34;</span><span class="o">)</span></span></span></code></pre></div><p>This would take time if there are some histograms that you want to display immediately&hellip;</p>
<p>Therefore, if you know in advance the diagram you want to see, it is useful to predefine its histogram!
The processor used is <code>TTreeProjectionProcessor</code>.
I would like to explain how to use this one.</p>
<h2 id="1-steering-file">1. Steering file</h2>
<p>Let&rsquo;s look at how histograms are defined when looking at SSD data.
First, let&rsquo;s prepare the steering file as follows!
please see previous section for omissions.</p>

<div class="tab-panel" data-tab-group="d28fd2f08e734536abd2b852c855e7b5">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="chkssdyaml"
      class="tab-nav-button tab-panel-style cstyle initial active" tabindex="-1"
      onclick="switchTab('d28fd2f08e734536abd2b852c855e7b5','chkssdyaml')"
    >
      <span class="tab-nav-text">chkssd.yaml</span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="chkssdyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="c"># -- snip --</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">include</span><span class="p">:</span><span class="w"> </span><span class="l">ssd/ssd_single.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># Histogram</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">projection_ssd</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TTreeProjectionProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line hl"><span class="cl"><span class="w">      </span><span class="nt">FileName</span><span class="p">:</span><span class="w"> </span><span class="l">hist/ssd/ssd.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Type</span><span class="p">:</span><span class="w">     </span><span class="l">art::TTreeProjection</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputFilename</span><span class="p">:</span><span class="w"> </span><span class="cp">*histout</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># output root file</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">outputtree</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TOutputTreeProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">FileName</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="cp">*output</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>The histogram is created based on the <strong>TTree</strong> object,
so describe the processing of the histogram after the part that represents the data processing and before the part that outputs the TTree (<code>TOutputTreeProcessor</code>).</p>
<p>There are three points to note here.</p>
<ol>
<li>It is possible to create a root file containing only a histogram as well as a root file containing a TTree.
(Look at the node part of the OutputFilename.)</li>
<li>The histogram itself is defined in a separate file to this one, written on the highlighted line above.</li>
<li>The file paths are relative to the working directory.</li>
</ol>
<p>Therefore, I would now like to show the histogram definition file.</p>
<h2 id="2-histogram-file">2. Histogram file</h2>
<p>First please look at this example.</p>

<div class="tab-panel" data-tab-group="e8706ef62101ea29d2644bf210b8753f">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="histssdssdyaml"
      class="tab-nav-button tab-panel-style cstyle initial active" tabindex="-1"
      onclick="switchTab('e8706ef62101ea29d2644bf210b8753f','histssdssdyaml')"
    >
      <span class="tab-nav-text">hist/ssd/ssd.yaml</span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="histssdssdyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="nt">anchor</span><span class="p">:</span><span class="w"> 
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="w">  </span>- <span class="cp">&amp;energy</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;ssd_cal.fCharge&#34;</span><span class="p">,</span><span class="m">100</span><span class="p">,</span><span class="m">0</span><span class="l">.,100.]</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="w">  </span>- <span class="cp">&amp;timing</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;ssd_cal.fTiming&#34;</span><span class="p">,</span><span class="m">100</span><span class="p">,</span><span class="m">0</span><span class="l">.,100.]</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="w"></span><span class="nt">alias</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="w">  </span><span class="nt">energy_cut</span><span class="p">:</span><span class="w"> </span><span class="l">ssd_cal.fCharge&gt;1.0;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="w"></span><span class="nt">group</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">ssd_test</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="w">    </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l">ssd_test</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="w">    </span><span class="nt">contents</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">ssd_energy</span><span class="w">
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="w">        </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l">ssd_energy</span><span class="w">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="w">        </span><span class="nt">x</span><span class="p">:</span><span class="w"> </span><span class="cp">*energy</span><span class="w">
</span></span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">ssd_timing</span><span class="w">
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="w">        </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l">ssd_timing</span><span class="w">
</span></span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="w">        </span><span class="nt">x</span><span class="p">:</span><span class="w"> </span><span class="cp">*timing</span><span class="w">
</span></span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">ssd_energy and timing</span><span class="w">
</span></span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="w">        </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l">ssd_energy and timing</span><span class="w">
</span></span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="w">        </span><span class="nt">x</span><span class="p">:</span><span class="w"> </span><span class="cp">*timing</span><span class="w">
</span></span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="w">        </span><span class="nt">y</span><span class="p">:</span><span class="w"> </span><span class="cp">*energy</span><span class="w">
</span></span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="w">        </span><span class="nt">cut</span><span class="p">:</span><span class="w"> </span><span class="l">energy_cut</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>This definition file consists of three parts.</p>
<h3 id="21-anchor">2.1 anchor</h3>
<p>The actual core part is the &ldquo;<strong>2.3 group</strong>&rdquo;, but &ldquo;<strong>2.1 anchor</strong>&rdquo; and &ldquo;<strong>2.2 alias</strong>&rdquo; are often used to make this part easier to write.
The anchor defines the first argument of <code>tree-&gt;Draw(&quot;ssd_cal.fCharge&gt;(100,0.,100.)&quot;,&quot;ssd_cal.fCharge &gt; 1.0&quot;)</code></p>
<p>The array stored in the variable named &ldquo;energy&rdquo; in the second line looks like <code>[str, int, float, float]</code> and has the following meanings</p>
<ol>
<li>str: Name of the object (need double quote &ldquo;&rdquo;)</li>
<li>int: Number of bins of histogram</li>
<li>float: Minimum value of histogram range</li>
<li>float: Maximum value of histogram range</li>
</ol>
<p>As you might imagine, inside the first argument you can also add operations such as <code>TMath::Sqrt(ssd_cal.fCharge)</code> or <code>ssd_cal.fCharge-ssd_cal.fTiming</code>, because it is the same with &ldquo;tree-&gt;Draw&rdquo;.</p>
<p>Note, however, that the definition here is for one-dimensional histograms.
Two-dimensional histograms will be presented in Section 2.3. It is very simple to write!</p>
<h3 id="22-alias">2.2 alias</h3>
<p>This part is used when applying gates to events (often we call it as &ldquo;cut&rdquo; or &ldquo;selection&rdquo;).
For example, if you only want to see events with energies above 1.0 MeV, you would write something like <code>tree-&gt;Draw(&quot;energy&quot;,&quot;energy&gt;1.0&quot;)</code>.</p>
<p>The alias node is used to define the part of <code>energy&gt;1.0</code></p>

<div class="box notices cstyle note">
  <div class="box-label"><i class="fa-fw fas fa-exclamation-circle"></i> Note</div>
  <div class="box-content">

<p>A semicolon &ldquo;;&rdquo; at the end of the sentence may be needed&hellip;?
please check <a href="https://github.com/artemis-dev/artemis/blob/develop/sources/loop/hist/TTreeProjection.cc" rel="external" target="_blank">the source</a>.</p>
</div>
</div>
<h3 id="23-group">2.3 group</h3>
<p>The histogram is defined here and the object is stored in a directory in artemis (ROOT, TDirectory).
In the example shown above, the directory structure would look like this:</p>
<p>(It is not actually displayed in this way).</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># in artemis</span>
</span></span><span class="line"><span class="cl">.
</span></span><span class="line"><span class="cl">â””â”€â”€ ssd_test
</span></span><span class="line"><span class="cl"> Â Â  â”œâ”€â”€ ssd_energy <span class="o">(</span>1D hist<span class="o">)</span>
</span></span><span class="line"><span class="cl"> Â Â  â”œâ”€â”€ ssd_timing <span class="o">(</span>1D hist<span class="o">)</span>
</span></span><span class="line"><span class="cl">    â””â”€â”€ ssd_energy and timing <span class="o">(</span>2D hist<span class="o">)</span></span></span></code></pre></div><p>The first &ldquo;name&rdquo; and &ldquo;title&rdquo; nodes are arguments of TDirectory instance.
Also the second &ldquo;name&rdquo; and &ldquo;title&rdquo; nodes are arguments of instance of TH1 or TH2 object.
The other &ldquo;x&rdquo;, &ldquo;y&rdquo; and &ldquo;cut&rdquo; is the important node!</p>
<ol>
<li>If there are only &ldquo;x&rdquo; nodes -&gt; 1D histogram</li>
<li>If there are both &ldquo;x&rdquo; and &ldquo;y&rdquo; nodes -&gt; 2D histogram</li>
<li>In any case, it can be gated by adding a &ldquo;cut&rdquo; node.</li>
</ol>
<h2 id="3-commands-for-histograms">3. Commands for histograms</h2>
<p>There are many useful command for checking the histogram objects.
These are similar to the <a href="https://ribf.riken.go.jp/RIBFDAQ/index.php?Tools/Analysis/ANAPAW" rel="external" target="_blank">ANAPAW</a> commands.</p>
<ol>
<li>ls : check the artemis directory</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; artlogin <span class="o">(</span>username<span class="o">)</span>
</span></span><span class="line"><span class="cl">&gt; a
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>0<span class="o">]</span> add steering/chkssd.yaml <span class="nv">NAME</span><span class="o">=</span>hoge <span class="nv">NUM</span><span class="o">=</span><span class="m">0000</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>1<span class="o">]</span> res
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>2<span class="o">]</span> sus
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>3<span class="o">]</span> ls <span class="c1"># check the artemis directory</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> artemis
</span></span><span class="line"><span class="cl">&gt;   <span class="m">0</span> art::TTreeProjGroup ssd_test        ssd_test
</span></span><span class="line"><span class="cl">    <span class="m">1</span> art::TAnalysisInfo analysisInfo</span></span></code></pre></div><ol start="2">
<li>cd [ID] : move to the directory of the ID</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>4<span class="o">]</span> <span class="nb">cd</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>5<span class="o">]</span> ls
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> ssd_test
</span></span><span class="line"><span class="cl">&gt;   <span class="m">0</span> art::TH1FTreeProj ssd_energy      ssd_energy
</span></span><span class="line"><span class="cl">    <span class="m">1</span> art::TH1FTreeProj ssd_timing      ssd_timing
</span></span><span class="line"><span class="cl">    <span class="m">2</span> art::TH2FTreeProj ssd_energy and timing ssd_energy and timing</span></span></code></pre></div><ol start="3">
<li>ht [ID] [option] : draw the histogram of the ID</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">artemis <span class="o">[</span>6<span class="o">]</span> ht <span class="m">0</span>
</span></span><span class="line"><span class="cl">artemis <span class="o">[</span>7<span class="o">]</span> ht <span class="m">2</span> colz</span></span></code></pre></div><ol start="4">
<li>hn : draw the next ID histogram</li>
<li>hb : draw the prev ID histogram</li>
</ol>
<h2 id="4-template-hist-file">4. Template hist file</h2>
<p>When setting up several detectors of the same type and wanting to set up a histogram with the same content, it is tedious to create several files with only the names of the objects changed.
In such cases, it is useful to allow the histogram definition file to have arguments.</p>
<p>Please look here first.</p>

<div class="tab-panel" data-tab-group="abf8ea79f2bff75d5ee3a96902bc1578">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="chkssdyaml"
      class="tab-nav-button tab-panel-style cstyle initial active" tabindex="-1"
      onclick="switchTab('abf8ea79f2bff75d5ee3a96902bc1578','chkssdyaml')"
    >
      <span class="tab-nav-text">chkssd.yaml</span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="chkssdyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="c"># -- snip --</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">include</span><span class="p">:</span><span class="w"> </span><span class="l">ssd/ssd_single.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># Histogram</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">projection_ssd</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TTreeProjectionProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">FileName</span><span class="p">:</span><span class="w"> </span><span class="l">hist/ssd/ssd.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Type</span><span class="p">:</span><span class="w">     </span><span class="l">art::TTreeProjection</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputFilename</span><span class="p">:</span><span class="w"> </span><span class="cp">*histout</span><span class="w">
</span></span></span><span class="line hl"><span class="cl"><span class="w">      </span><span class="nt">Replace</span><span class="p">:</span><span class="w"> </span><span class="p">|</span><span class="sd">
</span></span></span><span class="line hl"><span class="cl"><span class="sd">        name: ssd_cal</span><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># -- snip --</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>We add the highlighted lines.
Then the &ldquo;name&rdquo; can be used at hist file by <code>@name@</code>!
The &ldquo;name&rdquo; can be freely set.</p>

<div class="tab-panel" data-tab-group="be6b30fa8366a3663d3ad60450da710b">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="histssdssdyaml"
      class="tab-nav-button tab-panel-style cstyle initial active" tabindex="-1"
      onclick="switchTab('be6b30fa8366a3663d3ad60450da710b','histssdssdyaml')"
    >
      <span class="tab-nav-text">hist/ssd/ssd.yaml</span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="histssdssdyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">anchor</span><span class="p">:</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="cp">&amp;energy</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;@name@.fCharge&#34;</span><span class="p">,</span><span class="m">100</span><span class="p">,</span><span class="m">0</span><span class="l">.,100.]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="cp">&amp;timing</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;@name@.fTiming&#34;</span><span class="p">,</span><span class="m">100</span><span class="p">,</span><span class="m">0</span><span class="l">.,100.]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">alias</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">energy_cut</span><span class="p">:</span><span class="w"> </span>@<span class="l">name@.fCharge&gt;1.0;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">group</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">ssd_test</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l">ssd_test</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">contents</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">ssd_energy</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l">ssd_energy</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">x</span><span class="p">:</span><span class="w"> </span><span class="cp">*energy</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">ssd_timing</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l">ssd_timing</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">x</span><span class="p">:</span><span class="w"> </span><span class="cp">*timing</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">ssd_energy and timing</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l">ssd_energy and timing</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">x</span><span class="p">:</span><span class="w"> </span><span class="cp">*timing</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">y</span><span class="p">:</span><span class="w"> </span><span class="cp">*energy</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">cut</span><span class="p">:</span><span class="w"> </span><span class="l">energy_cut</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>This is useful when there are more objects to check!</p>

<div class="tab-panel" data-tab-group="f187489fe18f9af521e5cfe6bb086922">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="chkssdyaml"
      class="tab-nav-button tab-panel-style cstyle initial active" tabindex="-1"
      onclick="switchTab('f187489fe18f9af521e5cfe6bb086922','chkssdyaml')"
    >
      <span class="tab-nav-text">chkssd.yaml</span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="chkssdyaml"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="c"># -- snip --</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">include</span><span class="p">:</span><span class="w"> </span><span class="l">ssd/ssd_single.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># Histogram</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">projection_ssd</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TTreeProjectionProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">FileName</span><span class="p">:</span><span class="w"> </span><span class="l">hist/ssd/ssd.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Type</span><span class="p">:</span><span class="w">     </span><span class="l">art::TTreeProjection</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">OutputFilename</span><span class="p">:</span><span class="w"> </span><span class="cp">*histout</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Replace</span><span class="p">:</span><span class="w"> </span><span class="p">|</span><span class="sd">
</span></span></span><span class="line"><span class="cl"><span class="sd">        name: ssd_cal</span><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">projection_ssd</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">art::TTreeProjectionProcessor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">FileName</span><span class="p">:</span><span class="w"> </span><span class="l">hist/ssd/ssd.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Type</span><span class="p">:</span><span class="w">     </span><span class="l">art::TTreeProjection</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">Replace</span><span class="p">:</span><span class="w"> </span><span class="p">|</span><span class="sd">
</span></span></span><span class="line"><span class="cl"><span class="sd">        name: ssd_raw</span><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># and so on!</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># -- snip --</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>File splitting using &ldquo;include&rdquo; nodes, as described in the section on steeling, can also be used in the same way.</p>

            <footer class="footline">
              <i class='fa-fw fas fa-user'></i> <a href="mailto:okawa@cns.s.u-tokyo.ac.jp">KodaiOkawa</a>
              <i class='fa-fw fas fa-calendar'></i> Nov 14, 2023
            </footer>
          </article>

          <article class="default">
            <header class="headline">
            </header>

<h1 id="vnc-server">VNC server</h1>

<span class="badge cstyle default"><span class="badge-content">last modified: 2023-11-15 by Kodai Okawa</span></span>
<p>When we start the analysis, there are many situations where the analysis server on which artemis is installed is not only operated directly, but also remotely using &ldquo;ssh&rdquo;.
In such cases, there are various settings that need to be made in order for the figure to be displayed on the local computer, and some of these methods are described in this section.
We recommended to use <code>VNC server</code> currently, but note that policies may change in the future.</p>
<p>This is a list of ways to display the figures.</p>
<ul>
<li>X11Forwarding</li>
<li>VNC server</li>
<li>Save figure and check by using VScode</li>
<li>Web browser (THttpServer)</li>
</ul>
<h2 id="x11forwarding">X11Forwarding</h2>
<p>This is the simplest method.
Simply transfer the remote X to the local.</p>

<div class="tab-panel" data-tab-group="4373f111ebbbd8559204ee4d549bbf93">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="your-local-pc"
      class="tab-nav-button tab-panel-style cstyle initial active" tabindex="-1"
      onclick="switchTab('4373f111ebbbd8559204ee4d549bbf93','your-local-pc')"
    >
      <span class="tab-nav-text">your local PC</span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="your-local-pc"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">ssh -X analysisPC</span></span></code></pre></div></div>
    </div>
  </div>
</div><p>This &ldquo;X&rdquo; option allow the X11Forwarding.</p>
<p>However, the problem with this method is that it takes a long time to process, and it takes longer from the time the command is typed until it is drawn.
It is also not recommended as the process can become slow if a large number of people use it at the same time.</p>
<p>However, it is simpler than other methods and should be used when necessary, e.g. for debugging.</p>
<h2 id="vnc-server">VNC server</h2>

<div class="box notices cstyle info">
  <div class="box-label"><i class="fa-fw fas fa-info-circle"></i> Info</div>
  <div class="box-content">

<p>This is old version of VNC server (TigerVNC). Latest version supports more secure method, so this method may no longer be avaliable in the future&hellip;</p>
</div>
</div>
<p>First please install VNC viewer to your PC.
Any viewer may work well, but we are using <a href="https://www.realvnc.com/en/connect/download/viewer/" rel="external" target="_blank">this software</a>.</p>
<p>First, please check the ID number of the VNC server we are running.</p>

<div class="tab-panel" data-tab-group="345886445c94168b068733e45cbf495d">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="in-analysis-pc"
      class="tab-nav-button tab-panel-style cstyle initial active" tabindex="-1"
      onclick="switchTab('345886445c94168b068733e45cbf495d','in-analysis-pc')"
    >
      <span class="tab-nav-text">in analysis PC</span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="in-analysis-pc"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; vncserver -list
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">TigerVNC server sessions:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">X DISPLAY <span class="c1">#	PROCESS ID</span>
</span></span><span class="line"><span class="cl">:1		  <span class="m">3146</span>
</span></span><span class="line"><span class="cl">:5		  <span class="m">7561</span>
</span></span><span class="line"><span class="cl">:2022	  <span class="m">29499</span>
</span></span><span class="line"><span class="cl">:2		  <span class="m">23055</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>In this example, number 1, 5, 2022 and 2 VNC server is running.
And select an available number to start the VNC server you want to use.</p>

<div class="tab-panel" data-tab-group="4ac09107cbb40a3d0c559866cde5c116">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="in-analysis-pc"
      class="tab-nav-button tab-panel-style cstyle initial active" tabindex="-1"
      onclick="switchTab('4ac09107cbb40a3d0c559866cde5c116','in-analysis-pc')"
    >
      <span class="tab-nav-text">in analysis PC</span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="in-analysis-pc"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; vncserver :10 <span class="c1"># start the VNC server!</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>If you want to kill the VNC server, the below command will work.</p>

<div class="tab-panel" data-tab-group="2919e9c01a90dd0323e7d9dc8a805d2d">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="in-analysis-pc"
      class="tab-nav-button tab-panel-style cstyle initial active" tabindex="-1"
      onclick="switchTab('2919e9c01a90dd0323e7d9dc8a805d2d','in-analysis-pc')"
    >
      <span class="tab-nav-text">in analysis PC</span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="in-analysis-pc"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; vncserver -kill :10 <span class="c1"># kill the VNC server!</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>Next, configure the canvas created by artemis to be sent to a VNC server.
The <code>a</code> command can treat this process by using <code>.vncdisplay</code> file!</p>

<div class="tab-panel" data-tab-group="ba34a8be34890852d401cebaa8fc953a">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="in-analysis-pc"
      class="tab-nav-button tab-panel-style cstyle initial active" tabindex="-1"
      onclick="switchTab('ba34a8be34890852d401cebaa8fc953a','in-analysis-pc')"
    >
      <span class="tab-nav-text">in analysis PC</span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="in-analysis-pc"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; artlogin <span class="o">(</span>username<span class="o">)</span> <span class="c1"># move to your artemis work directory</span>
</span></span><span class="line"><span class="cl">&gt; <span class="nb">echo</span> <span class="s2">&#34;10&#34;</span> &gt; .vncdisplay <span class="c1"># write the ID of VNC server to the .vncdisplay file</span></span></span></code></pre></div></div>
    </div>
  </div>
</div><p>Then, the setting in analysis PC is completed!
The next step is to set up your local PC to receive this.</p>

<div class="box notices cstyle info">
  <div class="box-label"><i class="fa-fw fas fa-info-circle"></i> Info</div>
  <div class="box-content">

<p>If you connect your PC in the same network with analysis PC, you can directory connect using the VNC viewer.
However, CRIB analysis PC are connected CNS local network.
In order to connect from outside network, we need to use &ldquo;CNS login server&rdquo;.
If you want to make the login server account, please contact the CRIB member!</p>
</div>
</div>
<p>In this section, we are assuming that you have a CNS login server account.</p>
<p>To access the analysis PC, use two-stage ssh. Prepare the following configuration file.</p>

<div class="tab-panel" data-tab-group="f9a7bb7c8217eb356705ba2a63ec01e6">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="in-local-pc-sshconfig"
      class="tab-nav-button tab-panel-style cstyle initial active" tabindex="-1"
      onclick="switchTab('f9a7bb7c8217eb356705ba2a63ec01e6','in-local-pc-sshconfig')"
    >
      <span class="tab-nav-text">in local PC, .ssh/config</span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="in-local-pc-sshconfig"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-aconf" data-lang="aconf"><span class="line"><span class="cl"><span class="nb">Host</span> login
</span></span><span class="line"><span class="cl">    <span class="c"># need to change</span>
</span></span><span class="line"><span class="cl">    <span class="nb">HostName</span> CNS_loginserver_hostname
</span></span><span class="line"><span class="cl">    <span class="nb">User</span> username
</span></span><span class="line"><span class="cl">    <span class="nb">IdentityFile</span> ~/.ssh/id_rsa
</span></span><span class="line"><span class="cl">    <span class="c"># no need to change (if you want)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">ForWardX11Timeout</span> <span class="m">24</span>h
</span></span><span class="line"><span class="cl">    <span class="nb">ControlPersist</span> <span class="m">30</span>m
</span></span><span class="line"><span class="cl">    <span class="nb">ForwardAgent</span> yes
</span></span><span class="line"><span class="cl">    <span class="nb">ControlMaster</span> auto
</span></span><span class="line"><span class="cl">    <span class="nb">ControlPath</span> ~/.ssh/mux-%r@%h:%p
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># any name is okay</span>
</span></span><span class="line"><span class="cl"><span class="nb">Host</span> analysis
</span></span><span class="line"><span class="cl">    <span class="c"># need to change</span>
</span></span><span class="line"><span class="cl">    <span class="nb">HostName</span> analysisPC_hostname
</span></span><span class="line"><span class="cl">    <span class="nb">User</span> username
</span></span><span class="line"><span class="cl">    <span class="nb">IdentityFile</span> ~/.ssh/id_rsa
</span></span><span class="line"><span class="cl">    <span class="c"># no need to change (if you want)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">ProxyCommand</span> ssh login nc %h %p
</span></span><span class="line"><span class="cl">    <span class="nb">ForwardAgent</span> yes
</span></span><span class="line"><span class="cl">    <span class="nb">ControlMaster</span> auto
</span></span><span class="line"><span class="cl">    <span class="nb">ControlPath</span> ~/.ssh/mux-%r@%h:%p
</span></span><span class="line"><span class="cl">    <span class="nb">ControlPersist</span> <span class="m">30</span>m</span></span></code></pre></div></div>
    </div>
  </div>
</div><p>Then you can access to the analysis PC simply by:</p>

<div class="tab-panel" data-tab-group="f6d3a052028eb65dc3e0697efa484b19">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="in-local-pc"
      class="tab-nav-button tab-panel-style cstyle initial active" tabindex="-1"
      onclick="switchTab('f6d3a052028eb65dc3e0697efa484b19','in-local-pc')"
    >
      <span class="tab-nav-text">in local PC</span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="in-local-pc"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; ssh analysis</span></span></code></pre></div></div>
    </div>
  </div>
</div><p>Next, in order to receive from the VNC server, we use port-forwarding!
VNC servers with ID x use port number 5900+x.
For example if we use number &ldquo;10&rdquo;, the port will be 5910.</p>
<p>Forward this to a certain port on localhost. This number can be any number that is not in use.</p>

<pre class="mermaid align-center ">
---
title: An example of port-forwarding
---
graph LR;
    A(analysis PC&lt;br&gt;&lt;/br&gt;port 5910) --&gt; |send|B(local PC&lt;br&gt;&lt;/br&gt;port 55910)
</pre>

<div class="tab-panel" data-tab-group="c6f72e4da5031021b3eae4d7a7c42337">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="in-local-pc-sshconfig"
      class="tab-nav-button tab-panel-style cstyle initial active" tabindex="-1"
      onclick="switchTab('c6f72e4da5031021b3eae4d7a7c42337','in-local-pc-sshconfig')"
    >
      <span class="tab-nav-text">in local PC, .ssh/config</span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="in-local-pc-sshconfig"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-aconf" data-lang="aconf"><span class="line"><span class="cl"><span class="nb">Host</span> analysis
</span></span><span class="line"><span class="cl">    <span class="nb">HostName</span> analysisPC_hostname
</span></span><span class="line"><span class="cl">    <span class="nb">User</span> username
</span></span><span class="line"><span class="cl">    <span class="nb">IdentityFile</span> ~/.ssh/id_rsa
</span></span><span class="line hl"><span class="cl">    <span class="nb">LocalForward</span> <span class="m">55910</span> localhost:5910
</span></span><span class="line"><span class="cl">    <span class="nb">ProxyCommand</span> ssh login nc %h %p
</span></span><span class="line"><span class="cl">    <span class="nb">ForwardAgent</span> yes
</span></span><span class="line"><span class="cl">    <span class="nb">ControlMaster</span> auto
</span></span><span class="line"><span class="cl">    <span class="nb">ControlPath</span> ~/.ssh/mux-%r@%h:%p
</span></span><span class="line"><span class="cl">    <span class="nb">ControlPersist</span> <span class="m">30</span>m</span></span></code></pre></div></div>
    </div>
  </div>
</div><p>This allows you to display a VNC display by accessing port 55910 on your own PC (localhost), instead of having to access port 5910 on the analysis PC!</p>
<figure><img src="/artemis_crib/setting/vncserver/vncviewer.png" width="600">
</figure>

<p>If your PC is in the same network, changing &ldquo;localhost&rdquo; to the &ldquo;IP address of analysis PC&rdquo; is okay (ex. 192.168.1.10:5910).</p>
<h2 id="save-figure-and-check-by-using-vscode">Save figure and check by using VScode</h2>
<p><a href="https://code.visualstudio.com/" rel="external" target="_blank">VScode</a> is very exciting editor!
The extension supports ssh and allows remote png files to be displayed on the editor.</p>
<p>However, it is a bit time-consuming as the diagram has to be saved each time to view it.
Please refer to this as one method.</p>
<figure><img src="/artemis_crib/setting/vncserver/vscode.png" width="600">
</figure>

<h2 id="web-browser-thttpserver">Web browser (THttpServer)</h2>
<p>This is option&hellip;</p>
<p>Now the histogram object cannot display by JSROOT, because the object is not actually &ldquo;TH1&rdquo; or &ldquo;TH2&rdquo; object but &ldquo;TH1FTreeProj&rdquo; or &ldquo;TH2FTreeProj&rdquo;.
(ref: <a href="https://github.com/artemis-dev/artemis/issues/40" rel="external" target="_blank">issue#40</a>)</p>
<p>We can only display the &ldquo;TCanvas&rdquo; Object.</p>
<figure><img src="/artemis_crib/setting/vncserver/httpserver.png" width="600">
</figure>


            <footer class="footline">
              <i class='fa-fw fas fa-user'></i> <a href="mailto:okawa@cns.s.u-tokyo.ac.jp">KodaiOkawa</a>
              <i class='fa-fw fas fa-calendar'></i> Nov 15, 2023
            </footer>
          </article>

          </section>
        </div>
      </main>
    </div>
    <script src="/artemis_crib/js/clipboard.min.js?1723774910" defer></script>
    <script src="/artemis_crib/js/perfect-scrollbar.min.js?1723774910" defer></script>
    <script>
      function useMathJax( config ){
        window.MathJax = Object.assign( window.MathJax || {}, {
          tex: {
            inlineMath:  [['\\(', '\\)'], ['$',  '$']],  
            displayMath: [['\\[', '\\]'], ['$$', '$$']], 
          },
          options: {
            enableMenu: false 
          }
        }, config );
      }
      useMathJax( JSON.parse("{}") );
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="/artemis_crib/js/d3/d3-color.min.js?1723774910" defer></script>
    <script src="/artemis_crib/js/d3/d3-dispatch.min.js?1723774910" defer></script>
    <script src="/artemis_crib/js/d3/d3-drag.min.js?1723774910" defer></script>
    <script src="/artemis_crib/js/d3/d3-ease.min.js?1723774910" defer></script>
    <script src="/artemis_crib/js/d3/d3-interpolate.min.js?1723774910" defer></script>
    <script src="/artemis_crib/js/d3/d3-selection.min.js?1723774910" defer></script>
    <script src="/artemis_crib/js/d3/d3-timer.min.js?1723774910" defer></script>
    <script src="/artemis_crib/js/d3/d3-transition.min.js?1723774910" defer></script>
    <script src="/artemis_crib/js/d3/d3-zoom.min.js?1723774910" defer></script>
    <script src="/artemis_crib/js/js-yaml.min.js?1723774910" defer></script>
    <script src="/artemis_crib/js/mermaid.min.js?1723774910" defer></script>
    <script>
      window.themeUseMermaid = JSON.parse("{}");
    </script>
    <script src="/artemis_crib/js/theme.js?1723774910" defer></script>
  </body>
</html>
